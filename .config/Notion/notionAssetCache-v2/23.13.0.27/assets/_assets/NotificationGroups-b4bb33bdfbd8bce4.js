"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[6329],{50908:(t,e,i)=>{i.r(e),i.d(e,{NOTIFICATION_GROUP_CARD_BORDER_RADIUS:()=>E,default:()=>V});var o=i(67294),n=i(480),a=i(86628),r=i(24405),s=i(21202),c=i(19719),l=i(77907),d=i(51757),u=i(15145),g=i(17693),f=i(91),p=i(15047),h=i(29369),b=i(82990),y=i(68939),x=i(64921),m=i(31278),v=i(76798),M=i(52867),k=i(5686),w=i(8843),C=i(54642),_=i(17659),S=i(12534),N=i(41549),A=i(73063),I=i(26388),j=i(85893);function R(t){window.__c={n:"NotificationGroupActionsMenu"};const{notifications:e}=t,i=(0,n.O7)(),s=(0,n.Fy)(),l=(0,y.useIntl)(),d=e?e[0]:void 0,u=(0,a.VK)((()=>e.every((t=>t.read))),[e]),g=(0,a.VK)((()=>N.Fz()),[]),[f,p]=(0,o.useState)(!1),h=(0,o.useCallback)((t=>{e&&d&&(0,S.ZP)({event:t,context:S.Af.NotificationClick,callback:()=>{p(!0);const t=e.map((t=>{let{id:e}=t;return e}));(async()=>{try{await C.setNotificationsStatus(i,{spaceId:d.space_id,notificationIds:t,archived:!0})}finally{p(!1)}})();const o=e.filter((t=>!t.read));_.Jl("mentions",d.space_id,(t=>Math.max(t-o.length,0))),c.Ee(i,{target:"archive",notification_ids:t})}})}),[i,e,d]),x=(0,o.useCallback)((t=>{e&&d&&(0,S.ZP)({event:t,context:S.Af.NotificationClick,callback:()=>{let t;if(p(!0),u){const o=e.map((t=>{let{id:e}=t;return e}));t=async()=>{try{await C.setNotificationsStatus(i,{spaceId:d.space_id,notificationIds:o,read:!1})}finally{p(!1)}},_.Jl("mentions",d.space_id,(t=>t+o.length)),c.Ee(i,{target:"mark_as_unread",notification_ids:o})}else{const o=e.filter((t=>!t.read)).map((t=>{let{id:e}=t;return e}));t=async()=>{try{await C.setNotificationsStatus(i,{spaceId:d.space_id,notificationIds:o,read:!0})}finally{p(!1)}},_.Jl("mentions",d.space_id,(t=>Math.max(t-o.length,0))),c.Ee(i,{target:"mark_as_read",notification_ids:o})}t()}})}),[i,e,d,u]),m=(0,r.yK)((t=>({container:{display:"flex",height:"min-content",...s.isMobile?{paddingTop:2,paddingBottom:2,paddingLeft:2,paddingRight:0}:{padding:2}},button:{height:s.isMobile?30:26,width:s.isMobile?30:26},inboxIconBase:{fill:t.icon.secondary,stroke:t.icon.secondary,strokeOpacity:1,strokeWidth:.25},iconStyle:{fill:t.mediumIconColor,padding:2},readIcon:{width:s.isMobile?21:19,height:s.isMobile?22:20},archiveIcon:{width:s.isMobile?24:23,height:s.isMobile?24:23},ellipsisIcon:{width:s.isMobile?24:23,height:s.isMobile?24:23},headerLabel:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:b.Z.fontWeight.semibold}})),[s]);return d?"archived_only"===g?null:(0,j.jsxs)("div",{style:m.container,children:[(0,j.jsx)(I.Z,{renderTooltip:()=>u?(0,j.jsx)(y.FormattedMessage,{...B.markNotificationGroupAsUnread}):(0,j.jsx)(y.FormattedMessage,{...B.markNotificationGroupAsRead}),render:t=>(0,j.jsx)(A.Z,{ariaLabel:u?l.formatMessage(B.markNotificationGroupAsUnread):l.formatMessage(B.markNotificationGroupAsRead),style:m.button,icon:u?w.h:k.J,iconStyle:{...m.iconStyle,...m.readIcon,...u?{height:17,width:17}:{height:16,width:16},...m.inboxIconBase},onClick:x,disabled:f,...t})}),(0,j.jsx)(I.Z,{renderTooltip:()=>(0,j.jsx)(y.FormattedMessage,{...B.archiveNotificationGroup}),render:t=>(0,j.jsx)(A.Z,{ariaLabel:l.formatMessage(B.archiveNotificationGroup),style:m.button,icon:M.H,iconStyle:{...m.iconStyle,...m.archiveIcon,height:18,width:18,...m.inboxIconBase},onClick:h,disabled:f,...t})})]}):null}const B=(0,y.defineMessages)({markNotificationGroupAsRead:{defaultMessage:"Mark notifications in this page as read",id:"NotificationGroupActionsMenu.markNotificationAsRead.tooltipMessage"},markNotificationGroupAsUnread:{defaultMessage:"Mark notifications in this page as unread",id:"NotificationGroupActionsMenu.markNotificationAsUnread.tooltipMessage"},archiveNotificationGroup:{defaultMessage:"Archive notifications in this page",id:"NotificationGroupActionsMenu.handleArchive.tooltipMessage"},changePageNotificationSettings:{defaultMessage:"Change page notification settings",id:"NotificationGroupActionsMenu.notificationSettings.tooltipMessage"}}),G=o.memo(R);var T=i(37444),Z=i(22649);const K=(0,y.defineMessages)({open:{defaultMessage:"Open",id:"toggleButton.open"},close:{defaultMessage:"Close",id:"toggleButton.close"}});function L(t){window.__c={n:"ToggleButton"};const e=(0,n.Fy)(),i=(0,y.useIntl)(),a=e.isMobile?30:24,s=(0,r.yK)((()=>{const i=t.color||"inherit",o="chevron"===t.icon?`rotateZ(${t.open?-180:0}deg)`:`rotateZ(${t.open?180:90}deg)`,n="chevron"===t.icon,r=n&&e.isMobile;return{button:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:a,height:a,borderRadius:"100%",...t.style},arrow:{width:r?14:n?12:"0.6875em",height:r?14:n?12:"0.6875em",transition:"transform 200ms ease-out",transform:o,fill:i,opacity:t.fill?1:.5}}}),[e.isMobile,t.color,t.fill,t.icon,t.open,t.style,a]),c=(0,o.useMemo)((()=>{switch(t.icon){case"chevron":return(0,g.A)(s.arrow);case"triangle":default:return(0,f.L)(s.arrow)}}),[t.icon,s.arrow]);return(0,j.jsxs)(x.Z,{ariaLabel:t.open?i.formatMessage(K.close):i.formatMessage(K.open),"aria-describedby":t["aria-describedby"],"aria-expanded":t.open,"aria-controls":t.open?t["aria-controls"]:void 0,style:s.button,onClick:t.onClick,onMouseDown:t.onMouseDown,disabled:t.disabled,allowShiftClick:!0,children:[t.tapArea&&(0,j.jsx)("div",{style:{position:"absolute",opacity:0,width:t.tapArea.size,height:t.tapArea.size,top:-(t.tapArea.size-a)/2,left:-(t.tapArea.size-a)/2}}),c]})}const z=function(t){window.__c={n:"NotificationGroupTitle"};const{titledRecordStore:e,getRecordModel:i,notifications:s,isNotificationGroupExpanded:l,toggleNotificationGroup:g}=t,f=(0,n.Fy)(),[y,M]=(0,o.useState)(!1),k=(0,a.VK)((()=>e.getModel()),[e]),w=(0,a.VK)((()=>null==k?void 0:k.getRenderIcon({getRecordModel:i})),[k,i]),C=(0,a.VK)((()=>e instanceof d.G&&e.isEmptyPage()),[e]),_=(0,a.VK)((()=>{if(k&&k.table!==p.bx&&k.table!==h.e0)return k.getRenderUrl({getRecordModel:e.getRecordModel,pageVisitSource:u.tY.Notification})}),[k,e]),S=(0,a.VK)((()=>s.filter((t=>{let{notification:e}=t;return!e.read})).length),[s]),N=(0,n.O7)(),A=(0,o.useCallback)((()=>{c.Ee(N,{target:"title",notification_ids:s.map((t=>{let{notification:e}=t;return e.id}))})}),[N,s]),I=s&&(y||f.isMobile),R=(0,o.useRef)(null),[B,K]=(0,o.useState)(!1);(0,o.useEffect)((()=>{if(!R)return;const{current:t}=R;if(!t)return;const e="IntersectionObserver"in window?new IntersectionObserver((t=>{let[e]=t;return K(e.intersectionRatio<1)}),{threshold:[1]}):void 0;return null==e||e.observe(t),()=>null==e?void 0:e.unobserve(t)}),[R]);const z=(0,r.yK)((t=>({container:{position:"sticky",top:-.01,zIndex:10,padding:T.MY,background:t.contentBackground,boxShadow:B?"0px 1px 1px rgba(0, 0, 0, 0.03)":"0 0 0 transparent",transition:"box-shadow 300ms"},button:{display:"flex",gap:10,justifyContent:"space-between",alignItems:"center",height:36,paddingLeft:6,paddingRight:(f.isMobile?T._E:T.zF)-T.MY+2+1,borderRadius:6},hoveredButton:{background:t.whiteButtonHoveredBackground},pressedButton:{background:t.whiteButtonPressedBackground},icon:{...Z.e9,verticalAlign:"unset",marginRight:4},nonToggleArea:{display:"flex",flexShrink:2,minWidth:0},pageTitleButton:{display:"flex",alignItems:"center",height:24,minWidth:0,borderRadius:4,paddingLeft:6,paddingRight:6},recordTitle:{fontSize:14,fontWeight:S>0?b.Z.fontWeight.medium:b.Z.fontWeight.regular,color:t.regularTextColor,display:"inline",width:"100%",...b.Z.textOverflowStyle},updateCount:{color:t.mediumTextColor,fontSize:12},toggleContainer:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0},toggleChevron:{color:t.lightIconColor}})),[f,S,B]);return k?(0,j.jsx)("div",{ref:R,style:z.container,children:(0,j.jsxs)(x.Z,{onClick:g,onMouseEnter:()=>M(!0),onMouseLeave:()=>M(!1),style:z.button,hoveredStyle:z.hoveredButton,pressedStyle:z.pressedButton,mobileFeedback:!1,children:[(0,j.jsx)("div",{style:z.nonToggleArea,children:(0,j.jsxs)(x.Z,{style:z.pageTitleButton,href:_,disabled:!Boolean(_),onClick:A,children:[(0,j.jsx)(m.Z,{disabled:!0,icon:w,isEmptyPage:C,size:Boolean(w)?12:16,style:z.icon}),(0,j.jsx)(v.Z,{store:e,style:z.recordTitle,shouldWrap:!0})]})}),(0,j.jsxs)("div",{style:z.toggleContainer,children:[I&&(0,j.jsx)(G,{notifications:s.map((t=>{let{notification:e}=t;return e}))}),(0,j.jsx)(L,{fill:!0,isSidebar:!0,icon:"chevron",open:l,onClick:g,color:z.toggleChevron.color})]})]})}):null},E=16;function F(t){window.__c={n:"NotificationGroup"};const{notifications:e,rootStore:i,source:u,tab:g}=t,[f,p]=(0,o.useState)(!0),h=(0,n.O7)(),b=(0,o.useCallback)((()=>{p(!f),c.Ee(h,{target:f?"collapse":"expand",notification_ids:e.map((t=>{let{notification:e}=t;return e.id}))})}),[h,f,e]),y=(0,a.VK)((()=>e.every((t=>{let{notification:e}=t;return e.read}))),[e]),x=(0,a.VK)((()=>{const t=e[0].notification.navigable_block_id;if(t)return d.G.createChildStore(i,{table:s.iU,id:t})}),[i,e]),m=(0,r.yK)((t=>({toggle:{color:t.lightIconColor},notificationGroup:{borderBottom:`1px solid ${t.regularDividerColor}`,paddingTop:16,backgroundColor:y?t.sidebarBackground:""},notificationGroupButton:{cursor:f?"default":"inherit"},flatIndentFooter:{height:10,backgroundColor:t.sidebarBackground},groupContainer:{backgroundColor:t.contentBackground},divider:{height:8,backgroundColor:t.sidebarBackground}})),[f,y]);if(!x){const{notification:i,activity:o}=e[0],n={source:"notifications_tab",tab:t.tab,notification:i};return(0,j.jsxs)("div",{style:m.groupContainer,children:[(0,j.jsx)(l.LazyActivityNotification,{activity:o,rootStore:t.rootStore,tabArgs:n,isLast:!0,useInboxRedesign:!0},o.id),(0,j.jsx)("div",{style:m.divider})]})}const v=e.map(((i,o)=>{let{notification:n,activity:a}=i;const r={source:"notifications_tab",tab:t.tab,notification:n};return(0,j.jsx)(l.LazyActivityNotification,{activity:a,rootStore:t.rootStore,isLast:o===e.length-1,tabArgs:r,useInboxRedesign:!0},a.id)}));return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{style:m.groupContainer,children:[(0,j.jsx)(z,{titledRecordStore:x,getRecordModel:i.getRecordModel,activity:e[0].activity,tabArgs:{source:u,tab:g,notification:e[0].notification},notifications:e,isNotificationGroupExpanded:f,toggleNotificationGroup:b}),(0,j.jsx)("div",{children:f&&v})]}),(0,j.jsx)("div",{style:m.divider})]})}function O(t){window.__c={n:"NotificationGroups"};const{notifications:e,rootStore:i,source:o,tab:n}=t,a=(0,r.yK)((t=>({container:{display:"flex",flexDirection:"column",backgroundColor:t.contentBackground}})),[]);return(0,j.jsx)("div",{style:a.container,children:Array.from(e).map((t=>{let[e,a]=t;return(0,j.jsx)(F,{notifications:a,rootStore:i,source:o,tab:n},`group-${e}`)}))})}O.displayName="NotificationGroups";const V=O},93963:(t,e,i)=>{i.d(e,{z:()=>r});i(67294);var o=i(24405),n=i(68939),a=i(85893);function r(t){let{color:e,size:i,style:r}=t;window.__c={n:"StatusDot"};const s=(0,n.useIntl)(),c=(0,o.yK)((t=>({dot:{height:i||8,width:i||8,background:e||t.blueColor,flexShrink:0,borderRadius:"100%",pointerEvents:"none",...r}})),[i,e,r]);return(0,a.jsx)("div",{role:"img","aria-label":s.formatMessage({id:"statusDot.ariaLabel",defaultMessage:"New"}),style:c.dot})}}}]);