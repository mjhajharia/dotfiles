"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5109],{96323:(e,t,i)=>{i.d(t,{F0:()=>H,Hh:()=>W,LK:()=>_,NZ:()=>G,Rr:()=>D,cK:()=>R,cx:()=>L,lA:()=>J,sH:()=>z,sY:()=>Z,xI:()=>Y,xj:()=>O,yY:()=>j});i(57658),i(67294);var o=i(480),n=i(86628),a=i(24405),s=i(41432),r=i(8848),l=i(12970),c=i(91856),d=i(56666),p=i(75e3),m=i(25651),u=i(11751),g=i(54434),h=i(97880),f=i(68939),y=i(42858),v=i(39699),b=i(83919),k=i(72495),w=i(19037),S=i(78663),C=i(99417),T=i(19124),x=i(40959),M=i(16772),P=i(27724),I=i(89941),B=i(62967),V=i(85893);const Z=(0,f.defineMessages)({notionAI:{defaultMessage:"Notion AI",id:"completions.completionActions.AIAssist"},more:{defaultMessage:"See more",id:"completions.completionActions.more"},alternativeUiString:{defaultMessage:"{text}",id:"completions.completionActions.alternativeUiString"},aiSummaryBlockDisplayName:{defaultMessage:"Summary",id:"completions.completionActions.aiSummaryBlockDisplayName"},aiActionItemsBlockDisplayName:{defaultMessage:"Action items",id:"completions.completionActions.aiActionItemsBlockDisplayName"},aiFreePromptBlockDisplayName:{defaultMessage:"Custom AI block",id:"completions.completionActions.aiFreePromptBlockDisplayName"},aiSectionBlockDisplayName:{defaultMessage:"Custom AI section",id:"completions.completionActions.aiSectionBlockDisplayName"}});function j(e){return function(t){return(0,V.jsx)(k.Z,{...t,title:(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,u.t)({width:16,height:16,marginRight:4}),(0,V.jsx)("div",{children:t.title})]}),right:e})}}function D(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;const i=[];if(i.push(...e.slice(0,t)),e.length>t){const o=(0,B.$J)({key:"more actions",render:e=>(0,V.jsx)(k.Z,{...e}),actions:e.slice(t)});i.push((0,B.MV)({key:"more",displayName:Z.more,analyticsName:"Completions - more",validators:I.vE,svg:()=>(0,V.jsx)(q,{}),subActions:()=>[o],collapseSubActionsIntoParent:!0,width:350}))}return i}function F(){return(0,V.jsx)(J,{svg:m.R,svgFill:r.FN.light.purple[500]})}function R(e){const{key:t,name:i,analyticsName:o,textToInsert:n,onUpdatePromptState:a,right:s,renderTooltip:r,showEllipsis:l,userProvidedSearchName:c,executeImmediately:d,gtmFavoriteId:p}=e,m=i.length>1e3?`${i.slice(0,1e3)}…`:i;return(0,B.cN)({key:t,analyticsName:`Completions - insert text into prompt - ${o}`,...(u=l?`${m}…`:m,{displayName:Z.alternativeUiString,displayNameInterpolatedValues:{text:u}}),validators:[],closeParentMenu:!1,svg:F,action(){a({insertText:n??i,analyticsName:o,gtmFavoriteId:p,executeImmediately:d})},right:s??L("updatePrompt"),renderTooltip:r,userProvidedSearchName:c});var u}function _(e){const{from:t,type:i,onUpdatePromptState:o}=e;function n(e){return R({key:`completions.${e.key}`,name:(0,C.t8)(e),analyticsName:e.key,textToInsert:(0,S.$W)(e),onUpdatePromptState:o,showEllipsis:!0})}const a="cursor"===i?{selectionType:i,isPageEmpty:!w.IC()}:{selectionType:i},s=(0,C.up)(a),r=(0,C.pv)(s,a),l=[];for(const[c,d]of r){const e=[];for(const a of d)"helpMeDraft"!==a.key&&"helpMeEdit"!==a.key&&"helpMeWrite"!==a.key&&("translate"===a.key?e.push(E(a,I.vE,i,t)):"changeTone"===a.key?e.push(K(a,I.vE,i,t)):a.steps?e.push(n(a)):e.push(G({prompt:a,validators:I.vE,type:i,from:t})));const o=(0,B.$J)({key:`completions.${c}`,title:(0,C.Mh)(c,"cursor"===i?"page":"selection"),render:e=>(0,V.jsx)(k.Z,{...e}),actions:D(e.filter(h.$K),7)});l.push(o)}return"cursor"===i&&l.push((0,B.$J)({key:"completions.aiBlocks",title:C.Dr.aiBlocks,render:e=>(0,V.jsx)(k.Z,{...e}),actions:x.O5.map((e=>function(e){const t=x.Hc[e.aiBlockType],{displayName:i,svg:o}=N[e.aiBlockType],n=e=>!t.shouldShow||t.shouldShow(e);return(0,B.cN)({key:`completions.aiBlocks.${t.key}`,analyticsName:`Completions - ${t.key}`,closeParentMenu:!0,svg:o,displayName:i,validators:[...I.vE,n],action:e=>{let{environment:i}=e;v.createAndCommit({userAction:"completionActions.createAiBlockAction",environment:i,perform:e=>{y.at({environment:i,selection:P.default.state.stores,createBlockItem:t,analyticsFrom:"ai_prompt",transaction:e})}})}})}({aiBlockType:e})))})),l}const N={[s.MF.aiSummaryBlock]:{displayName:Z.aiSummaryBlockDisplayName,svg:()=>(0,V.jsx)(Q,{svg:c.Y})},[s.MF.aiActionItemsBlock]:{displayName:Z.aiActionItemsBlockDisplayName,svg:()=>(0,V.jsx)(Q,{svg:l.O})},[s.MF.aiFreePromptBlock]:{displayName:Z.aiFreePromptBlockDisplayName,svg:()=>(0,V.jsx)(Q,{svg:u.t})},[s.MF.aiSectionBlock]:{displayName:Z.aiSectionBlockDisplayName,svg:()=>(0,V.jsx)(Q,{svg:u.t})}};function Y(e){return(0,B.$J)({key:"completions",title:Z.notionAI,render:j(),actions:A(e)})}function A(e){const{store:t,from:i}=e,o=[];for(const n of(0,T.G9)()){if("helpMeWrite"===n.key)continue;const e=G({prompt:n,validators:I.vE,type:"aiBlock",from:i,store:t});e&&o.push(e)}return o}function H(e){const{environment:t,inputValue:i,store:o}=e,n=(0,T.qB)({customPrompt:i,isPageEmpty:!1});b.triggerCompletionForAiBlock({environment:t,store:o,prompt:n,additionalContext:{prompt:i}})}function E(e,t,i,o){const{key:n,name:a,svg:s,svgFill:r,steps:l}=e;if("translate"!==n||!l||1!==l.length||"language"!==l[0].key||"dropdown"!==l[0].type)return;const c=l[0].dropdownOptions.map((n=>{let{key:a,name:s}=n;return(0,B.cN)({key:`completions.translate.${a}`,analyticsName:`Completions - translate - ${a}`,displayName:s,validators:t,closeParentMenu:!0,right:L("submitPrompt"),action:t=>{let{environment:n}=t;U({environment:n,prompt:e,from:o,type:i,additionalContext:{language:a}})}})})),d=(0,B.$J)({key:"translate language actions",render:e=>(0,V.jsx)(k.Z,{...e}),actions:c}),p=s?()=>(0,V.jsx)(J,{svg:s,svgFill:r}):void 0;return(0,B.MV)({key:"translate",displayName:a,analyticsName:`Completions - ${n}`,validators:t,svg:p,subActions:()=>[d]})}function K(e,t,i,o){const{key:n,name:a,svg:s,svgFill:r,steps:l}=e;if("changeTone"!==n||!l||1!==l.length||"tone"!==l[0].key||"dropdown"!==l[0].type)return;const c=l[0].dropdownOptions.map((n=>{let{key:a,name:s}=n;return(0,B.cN)({key:`completions.changeTone.${a}`,analyticsName:`Completions - changeTone - ${a}`,displayName:s,validators:t,closeParentMenu:!0,right:L("submitPrompt"),action:t=>{let{environment:n}=t;U({environment:n,prompt:e,from:o,type:i,additionalContext:{tone:a}})}})})),d=(0,B.$J)({key:"changeTone tone actions",render:e=>(0,V.jsx)(k.Z,{...e}),actions:c}),p=s?()=>(0,V.jsx)(J,{svg:s,svgFill:r}):void 0;return(0,B.MV)({key:"changeTone",displayName:a,analyticsName:`Completions - ${n}`,validators:t,svg:p,subActions:()=>[d]})}function O(e){window.__c={n:"ActionHintIcon"};const{focused:t,type:i}=e,s=(0,o.O7)(),r=(0,n.VK)((()=>s.device.isPhone),[s]),l=(0,a.yK)((e=>({iconStyle:{width:14,height:14,fill:e.mediumIconColor,opacity:!r&&t?1:0},containerStyle:{width:18,height:18,display:"flex",alignItems:"center",justifyContent:"center"}})),[t,r]);switch(i){case"submitPrompt":return(0,V.jsx)("div",{style:l.containerStyle,children:(0,p.U)(l.iconStyle)});case"updatePrompt":return(0,V.jsx)("div",{style:l.containerStyle,children:(0,g.F)(l.iconStyle)});default:(0,h.t1)(i)}}function L(e){return t=>(0,V.jsx)(O,{type:e,focused:t.focused})}function z(e){const{customPrompt:t,execute:i}=e;return(0,B.cN)({analyticsName:"Completions - execute current prompt input",key:"explicitFreeFormAction",displayName:C.Dr.genericHelpMeWrite,displayNameInterpolatedValues:{filter:t},svg:F,right:L("submitPrompt"),validators:[],closeParentMenu:!1,renderTooltip:B.zz,action(){i()}})}const $=()=>(0,C.L3)();function G(e){const{prompt:t,validators:i,type:o,from:n,store:a,sortScoreMultiplier:s}=e,{key:r,name:l}=t;if("translate"===r&&("textSelection"===o||"blockSelection"===o||"cursor"===o))return E(t,i,o,n);if("changeTone"===r&&("textSelection"===o||"blockSelection"===o||"cursor"===o))return K(t,i,o,n);const c=function(e){const{svg:t,svgFill:i}=e;return t?()=>(0,V.jsx)(J,{svg:t,svgFill:i}):void 0}(t),d=[...i];return t.requiresContent?d.push(w.IC):t.requiresNoContent&&d.push(w.ff(w.IC)),t.isNewModel&&d.push($),(0,B.cN)({key:`completions.${r}`,analyticsName:`Completions - ${r}`,displayName:l,fuzzySearchKeywords:t.fuzzySearchKeywords,validators:d,closeParentMenu:!0,svg:c,right:L("submitPrompt"),sortScoreMultiplier:s,action:e=>{let{environment:i}=e;U({environment:i,prompt:t,type:o,from:n,store:a})}})}function U(e){const{environment:t,prompt:i,type:o,from:n,store:a,additionalContext:s}=e;if("textSelection"===o)b.openCompletionPopupForSavedContext({environment:t,prompt:i,from:n,additionalContext:s});else if("blockSelection"===o)b.openCompletionPopupForBlockSelectionContext({environment:t,prompt:i,from:n,additionalContext:s});else if("cursor"===o){if(i.preferToNeverInsertTextAtCursor)return void b.selectPageAndOpenCompletionPopupForBlockSelectionContext({environment:t,prompt:i,from:n,additionalContext:s});b.openCompletionPopupForCursorContext({environment:t,prompt:i,from:n,additionalContext:s})}else"aiBlock"===o?a&&b.triggerCompletionForAiBlock({environment:t,store:a,prompt:i,additionalContext:s}):(0,h.t1)(o)}function W(e){const{inputValue:t,from:i,mode:o,environment:n}=e;switch(o){case"edit":return void function(e){const{customPrompt:t,from:i,environment:o}=e,n=(0,C.sB)(t);"closedWithContext"===M.default.state.type&&M.default.state.context&&b.openCompletionPopupForPrefilledContext({environment:o,context:M.default.state.context,prompt:n,additionalContext:{prompt:t},from:i,skipInitialForm:!0})}({environment:n,customPrompt:t,from:i});case"write":const e=(0,C.wq)(t);if(e){const{prompt:t,additionalContext:o}=e,a=(0,S.FD)();if(!a)return;return void b.openCompletionPopupForPrefilledContext({environment:n,context:a,prompt:t,additionalContext:o,from:i,skipInitialForm:!0})}return void function(e){const{environment:t,customPrompt:i,from:o}=e,n=(0,T.qB)({customPrompt:i,isPageEmpty:!w.IC()}),a=(0,S.FD)();a&&b.openCompletionPopupForPrefilledContext({environment:t,context:a,prompt:n,additionalContext:{prompt:i},from:o,skipInitialForm:!0})}({environment:n,customPrompt:t,from:i})}(0,h.t1)(o)}function q(){window.__c={n:"MoreIcon"};const e=(0,a.Fg)();return(0,d.o)({width:12,marginLeft:2,marginRight:2,fill:e.mediumIconColor})}function J(e){window.__c={n:"BoxedIcon"};const t=(0,a.yK)((t=>({box:{height:e.fixedWidth?22:void 0,width:e.fixedWidth?22:void 0,display:"flex",alignItems:"center",justifyContent:"center",...e.boxStyles},icon:{height:16,width:16,fill:e.svgFill??(0,r.gh)({theme:"light"}).regularIconColor}})),[e]);return(0,V.jsx)("div",{style:t.box,children:e.svg(t.icon)})}function Q(e){window.__c={n:"AiBlockIcon"};const t=(0,a.yK)((e=>({box:{background:e.fill.purple,width:24,height:24,borderRadius:4},icon:{fill:e.icon.purple}})),[]);return(0,V.jsx)(J,{svg:e.svg,svgFill:t.icon.fill,boxStyles:t.box})}},46225:(e,t,i)=>{i.d(t,{v:()=>ee,w:()=>X});i(57658),i(67294);var o=i(14577),n=i(41892),a=i(41432),s=i(77657),r=i(74181),l=i(72126),c=i(45953),d=i(21202),p=i(9844),m=i(97880),u=i(68939),g=i(4727),h=i(36280),f=i(67060),y=i(42858),v=i(39699),b=i(63594),k=i(47099),w=i(72495),S=i(68204),C=i(19037),T=i(42),x=i(99417),M=i(40959),P=i(33929),I=i(89014),B=i(30874),V=i(27724),Z=i(41363),j=i(21797),D=i(89941),F=i(96323),R=i(62967),_=i(11732),N=i(85893);const Y=(0,u.defineMessages)({basicBlocksSection:{id:"action.section.basicBlocks",defaultMessage:"Basic blocks"},tableViewTitle:{id:"newBlock.tableView.title",defaultMessage:"Table view"},tableViewDescription:{id:"newBlock.tableView.description",defaultMessage:"Add a table view for a new or existing database."},boardViewTitle:{id:"newBlock.boardView.title",defaultMessage:"Board view"},boardViewDescription:{id:"newBlock.boardView.description",defaultMessage:"Create a kanban board database view."},galleryViewTitle:{id:"newBlock.galleryView.title",defaultMessage:"Gallery view"},galleryViewDescription:{id:"newBlock.galleryView.description",defaultMessage:"Create a gallery database view."},listViewTitle:{id:"newBlock.listView.title",defaultMessage:"List view"},listViewDescription:{id:"newBlock.listView.description",defaultMessage:"Create a list database view."},calendarViewTitle:{id:"newBlock.calendarView.title",defaultMessage:"Calendar view"},calendarViewDescription:{id:"newBlock.calendarView.description",defaultMessage:"Create a calendar database view."},timelineViewTitle:{id:"newBlock.timelineView.title",defaultMessage:"Timeline view"},timelineViewDescription:{id:"newBlock.timelineView.description",defaultMessage:"Create a timeline database view."},databaseInlineTitle:{id:"newBlock.databaseInline.title",defaultMessage:"Database - Inline"},databaseInlineDescription:{id:"newBlock.databaseInline.description",defaultMessage:"Add a new inline database to this page."},databaseInlineKeywords:{id:"newBlock.databaseInline.fuzzySearchKeywords",defaultMessage:"Database Inline db"},databaseFullPageTitle:{id:"newBlock.databaseFullPage.title",defaultMessage:"Database - Full page"},databaseFullPageDescription:{id:"newBlock.databaseFullPage.description",defaultMessage:"Add a new database as a sub-page."},databaseFullPageKeywords:{id:"newBlock.databaseFullPage.fuzzySearchKeywords",defaultMessage:"Database Full page db"},linkedViewOfCollectionTitle:{id:"newBlock.linkedViewOfCollection.title",defaultMessage:"Linked view of database"},linkedViewOfCollectionMobileTitle:{id:"newBlock.linkedViewOfCollectionMobile.title",defaultMessage:"Linked view"},linkedViewOfCollectionKeywords:{id:"newBlock.linkedViewOfCollection.fuzzySearchKeywords",defaultMessage:"Create linked view of database db"},linkedViewOfCollectionDescription:{id:"newBlock.linkedViewOfCollection.description",defaultMessage:"Add an existing database to this page."},mentionPersonTitle:{id:"action.mentionPerson.title",defaultMessage:"Mention a person"},mentionPersonDescription:{id:"action.mentionPerson.description",defaultMessage:"Ping someone so they get a notification."},mentionPageTitle:{id:"action.mentionPage.title",defaultMessage:"Mention a page"},mentionPageDescription:{id:"action.mentionPage.description",defaultMessage:"Mention a page and place in text."},dateOrReminderTitle:{id:"action.dateOrReminder.title",defaultMessage:"Date or reminder"},dateOrReminderDescription:{id:"action.dateOrReminder.description",defaultMessage:"Insert a date or reminder in text."},insertEmojiTitle:{id:"action.insertEmoji.title",defaultMessage:"Emoji"},insertEmojiDescription:{id:"action.insertEmoji.description",defaultMessage:"Search for an emoji to place in text."},insertInlineEquationTitle:{id:"action.insertInlineEquation.title",defaultMessage:"Inline equation"},insertInlineEquationKeywords:{id:"action.insertInlineEquation.fuzzySearchKeyword",defaultMessage:"LaTeX Math Inline Equation $"},insertInlineEquationDescription:{id:"action.insertInlineEquation.description",defaultMessage:"Insert mathematical symbols in text."},databaseSection:{id:"action.section.database",defaultMessage:"Database"},mediaSection:{id:"action.section.media",defaultMessage:"Media"},aiBlocksSection:{id:"action.section.aiBlocks",defaultMessage:"AI blocks"},advancedBlocksSection:{id:"action.section.advancedBlocks",defaultMessage:"Advanced blocks"},inlineSection:{id:"action.section.inline",defaultMessage:"Inline"},embedsSection:{id:"action.section.embeds",defaultMessage:"Embeds"},syncedDatabasesSection:{id:"action.section.syncedDatabases",defaultMessage:"Synced Databases"},actionsSection:{id:"action.section.actions",defaultMessage:"Actions"}}),A=[M.Hc[a.Ti.text],M.Hc[a.Ti.page],M.Hc[a.Ti.toDo],M.Hc[a.Ti.header],M.Hc[a.Ti.subHeader],M.Hc[a.Ti.subSubHeader],M.Hc[a.Ti.table],M.Hc[a.Ti.bulletedList],M.Hc[a.Ti.numberedList],M.Hc[a.Ti.toggle],M.Hc[a.Ti.quote],M.Hc[a.Ti.divider],M.Hc[a.Ti.linkToPage],M.Hc[a.Ti.callout]],H=[M.Hc[a.Ti.image],M.Hc[a.Ti.bookmark],M.Hc[a.Ti.video],M.Hc[a.Ti.audio],M.Hc[a.Ti.code],M.Hc[a.Ti.file],M.Hc[a.Ti.drawing]],E=[(0,M.MU)({key:"table view",blockType:a.Ti.collectionView,displayName:Y.tableViewTitle,thumbnail:n.Z.images.blocks.tableViewInlinePng,description:Y.tableViewDescription,fuzzySearchKeywords:Y.tableViewTitle,tooltipPhoto:n.Z.images.tooltips.blocks.tablePng,createTemplate:()=>T.iC({isInline:!0,viewType:"table"}),postCreateCallback:e=>{const t=e.getCollectionViewStores()[0];t&&(0,I.u)(t.id,{viewType:"table"})},collectionViewType:"table"}),(0,M.MU)({key:"board view",blockType:a.Ti.collectionView,displayName:Y.boardViewTitle,thumbnail:n.Z.images.blocks.boardInlinePng,description:Y.boardViewDescription,fuzzySearchKeywords:Y.boardViewTitle,tooltipPhoto:n.Z.images.tooltips.blocks.boardPng,createTemplate:()=>T.iC({isInline:!0,viewType:"board"}),postCreateCallback:e=>{const t=e.getCollectionViewStores()[0];t&&(0,I.u)(t.id,{viewType:"board"})},collectionViewType:"board"}),(0,M.MU)({key:"gallery view",blockType:a.Ti.collectionView,displayName:Y.galleryViewTitle,thumbnail:n.Z.images.blocks.galleryInlinePng,description:Y.galleryViewDescription,fuzzySearchKeywords:Y.galleryViewTitle,tooltipPhoto:n.Z.images.tooltips.blocks.galleryPng,createTemplate:()=>T.iC({isInline:!0,viewType:"gallery"}),postCreateCallback:e=>{const t=e.getCollectionViewStores()[0];t&&(0,I.u)(t.id,{viewType:"gallery"})},collectionViewType:"gallery"}),(0,M.MU)({key:"list view",blockType:a.Ti.collectionView,displayName:Y.listViewTitle,thumbnail:n.Z.images.blocks.listInlinePng,description:Y.listViewDescription,fuzzySearchKeywords:Y.listViewTitle,tooltipPhoto:n.Z.images.tooltips.blocks.listPng,createTemplate:()=>T.iC({isInline:!0,viewType:"list"}),postCreateCallback:e=>{const t=e.getCollectionViewStores()[0];t&&(0,I.u)(t.id,{viewType:"list"})},collectionViewType:"list"}),(0,M.MU)({key:"calendar view",blockType:a.Ti.collectionView,displayName:Y.calendarViewTitle,thumbnail:n.Z.images.blocks.calendarInlinePng,description:Y.calendarViewDescription,fuzzySearchKeywords:Y.calendarViewTitle,tooltipPhoto:n.Z.images.tooltips.blocks.calendarPng,createTemplate:()=>T.iC({isInline:!0,viewType:"calendar"}),postCreateCallback:e=>{const t=e.getCollectionViewStores()[0];t&&(0,I.u)(t.id,{viewType:"calendar"})},collectionViewType:"calendar"}),(0,M.MU)({key:"timeline view",blockType:a.Ti.collectionView,displayName:Y.timelineViewTitle,thumbnail:n.Z.images.blocks.timelineInlinePng,description:Y.timelineViewDescription,fuzzySearchKeywords:Y.timelineViewTitle,tooltipPhoto:n.Z.images.tooltips.blocks.timelinePng,createTemplate:()=>T.iC({isInline:!0,viewType:"timeline"}),postCreateCallback:e=>{const t=e.getCollectionViewStores()[0];t&&(0,I.u)(t.id,{viewType:"timeline"})},collectionViewType:"timeline"}),(0,M.MU)({key:"database inline",blockType:a.Ti.collectionView,displayName:Y.databaseInlineTitle,thumbnail:n.Z.images.blocks.tableViewInlinePng,description:Y.databaseInlineDescription,fuzzySearchKeywords:Y.databaseInlineKeywords,tooltipPhoto:n.Z.images.tooltips.blocks.tableViewPng,createTemplate:e=>T.W_({environment:e,isInline:!0}),collectionViewType:"inline"}),(0,M.MU)({key:"database full page",blockType:a.Ti.collectionViewPage,displayName:Y.databaseFullPageTitle,thumbnail:n.Z.images.blocks.tableViewPng,description:Y.databaseFullPageDescription,fuzzySearchKeywords:Y.databaseFullPageKeywords,tooltipPhoto:n.Z.images.tooltips.blocks.tableViewPng,createTemplate:e=>T.W_({environment:e,isInline:!1}),collectionViewType:"full_page"}),(0,M.MU)({key:"linked database",blockType:a.Ti.collectionView,displayName:Y.linkedViewOfCollectionTitle,fuzzySearchKeywords:Y.linkedViewOfCollectionKeywords,thumbnail:n.Z.images.blocks.linkPng,description:Y.linkedViewOfCollectionDescription,tooltipPhoto:n.Z.images.tooltips.blocks.tablePng,createTemplate:()=>T.iC({isInline:!0,viewType:"table"}),shouldShow:e=>!e.environment.device.isMobile}),(0,M.MU)({key:"linked database mobile",blockType:a.Ti.collectionView,displayName:Y.linkedViewOfCollectionMobileTitle,fuzzySearchKeywords:Y.linkedViewOfCollectionKeywords,thumbnail:n.Z.images.blocks.linkPng,description:Y.linkedViewOfCollectionDescription,tooltipPhoto:n.Z.images.tooltips.blocks.tablePng,createTemplate:()=>T.iC({isInline:!0,viewType:"table"}),shouldShow:e=>e.environment.device.isMobile})],K=M.O5.map((e=>M.Hc[e])),O=[M.Hc[a.Ti.tableOfContents],M.Hc[a.Ti.equation],M.Hc[a.Ti.button],M.Hc[a.Ti.factory],M.Hc[a.Ti.breadcrumb],M.Hc[a.Ti.tab],M.Hc[a.Ti.transclusionContainer],M.Hc[a.MF.toggleFormatHeaderBlock],M.Hc[a.MF.toggleFormatSubHeaderBlock],M.Hc[a.MF.toggleFormatSubSubHeaderBlock],M.Hc[a.MF.column2Block],M.Hc[a.MF.column3Block],M.Hc[a.MF.column4Block],M.Hc[a.MF.column5Block],M.Hc[a.MF.mermaidCodeBlock]],L=[...[{key:"mentionPerson",title:Y.mentionPersonTitle,thumbnail:n.Z.images.blocks.mentionPersonPng,description:Y.mentionPersonDescription,tooltipPhoto:n.Z.images.tooltips.blocks.mentionPersonPng,action:e=>{let{environment:t}=e;f.lZ(t,{user:!0,inviteUser:!0,bot:!1,date:!1,page:!1,heading:!1,createPage:!1,reminder:!1,templateVariable:!0,group:!1})}},{key:"mentionPage",title:Y.mentionPageTitle,thumbnail:n.Z.images.blocks.mentionPagePng,description:Y.mentionPageDescription,tooltipPhoto:n.Z.images.tooltips.blocks.mentionPagePng,action:e=>{let{environment:t}=e;f.lZ(t,{user:!1,inviteUser:!1,bot:!1,date:!1,reminder:!1,page:!0,heading:!1,createPage:!1,templateVariable:!1,group:!1})}},{key:"dateOrReminder",title:Y.dateOrReminderTitle,thumbnail:n.Z.images.blocks.mentionDatePng,description:Y.dateOrReminderDescription,tooltipPhoto:n.Z.images.tooltips.blocks.mentionTimePng,action:e=>{let{environment:t}=e;f.lZ(t,{user:!1,inviteUser:!1,bot:!1,date:!0,reminder:!0,page:!1,heading:!1,createPage:!1,templateVariable:!0,group:!1})}}].map((e=>(0,R.cN)({key:`insert ${e.key}`,displayName:e.title,analyticsName:"Insert mention",render:t=>(0,N.jsx)(k.Z,{...t,title:P.default.formatMessage(e.title),thumbnail:e.thumbnail,tooltipPhoto:e.tooltipPhoto,description:P.default.formatMessage(e.description),format:k.Q.Insert}),validators:[C.YZ],closeParentMenu:!0,action:t=>{let{environment:i}=t;return e.action({environment:i})},nativeRender:t=>({thumbnail:e.thumbnail})}))),(0,R.cN)({key:"insert emoji",displayName:Y.insertEmojiTitle,analyticsName:Y.insertEmojiTitle.defaultMessage,validators:[C.YZ],closeParentMenu:!0,render:e=>(0,N.jsx)(k.Z,{...e,title:P.default.formatMessage(Y.insertEmojiTitle),description:P.default.formatMessage(Y.insertEmojiDescription),thumbnail:n.Z.images.blocks.inlineEmojiPng,tooltipPhoto:n.Z.images.tooltips.blocks.inlineEmojiPng,format:k.Q.Insert}),action:e=>{let{environment:t}=e;return g.jZ(t)},nativeRender:e=>({thumbnail:n.Z.images.blocks.inlineEmojiPng})}),(0,R.cN)({key:"insert inline equation",displayName:Y.insertInlineEquationTitle,analyticsName:Y.insertInlineEquationTitle.defaultMessage,fuzzySearchKeywords:Y.insertInlineEquationKeywords,validators:[C.YZ],closeParentMenu:!0,render:e=>(0,N.jsx)(k.Z,{...e,title:P.default.formatMessage(Y.insertInlineEquationTitle),description:P.default.formatMessage(Y.insertInlineEquationDescription),thumbnail:n.Z.images.blocks.inlineEquationPng,tooltipPhoto:n.Z.images.tooltips.blocks.inlineEquationPng,format:k.Q.Insert}),action:e=>{let{environment:t}=e;return h.qn({environment:t,analyticsFrom:"slash_menu"})},nativeRender:e=>({thumbnail:n.Z.images.blocks.inlineEquationPng})})];function z(){let e,t,i,o;const n=[];for(const a of $.state)"Figma"===a.displayName?e=a:"Hex"===a.displayName?t=a:"Google Drive"===a.displayName?i=a:"Whimsical"===a.displayName?o=a:n.push(a);return[M.Hc[a.Ti.embed],i??M.Hc[a.Ti.drive],M.Hc[a.Ti.tweet],M.Hc[a.Ti.gist],M.Hc[a.Ti.maps],e??M.Hc[a.Ti.figma],M.Hc[a.Ti.abstract],M.Hc[a.Ti.invision],M.Hc[a.Ti.mixpanel],M.Hc[a.Ti.framer],o??M.Hc[a.Ti.whimsical],M.Hc[a.Ti.miro],M.Hc[a.Ti.sketch],M.Hc[a.Ti.excalidraw],M.Hc[a.Ti.pdf],M.Hc[a.Ti.loom],M.Hc[a.Ti.typeform],M.Hc[a.Ti.codepen],M.Hc[a.Ti.replit],t??M.Hc[a.Ti.hex],M.Hc[a.Ti.deepnote],...n]}const $=new o.Z((()=>B.Z.integrations.state.filter((e=>e.id!==s.U9&&e.id!==s.Dv)).map((e=>{if((0,r.mo)(e)||(0,r.zc)(e)){const t=(0,r.mo)(e)?"link preview":"data sync";return{key:e.id,displayName:e.name,analyticsName:e.name,searchName:`${t} ${e.name}`,thumbnail:e.info.icon??n.Z.images.blocks.embedPng,description:e.info.tagline,templateRootBlockId:"root",blockType:a.Ti.externalObjectInstance,shouldShow:e=>!C.nJ(e),createTemplate:()=>{const t={is_placeholder:!0,integration_id:e.id};return c.Ao.create({[d.iU]:{root:{id:"root",type:a.Ti.externalObjectInstance,format:t}}})}}}})).filter(m.$K)),{debugName:"getExternalIntegrationCreateBlockItems"});function G(e){return new o.Z((()=>{const t=e.isMobileNative?[]:[U()];var i;return{insertActions:q(t,"add_menu"),slashActions:(i=q(t,"slash_menu"),[...i,_.g,(0,R.$J)({key:"slash actions",title:Y.actionsSection,render:e=>(0,N.jsx)(w.Z,{...e}),actions:Q((0,S.RP)((0,Z.Qi)(),(e=>!e.subActions&&!e.hideFromSlashActionMenu)))}),j.rz,j.Vm])}}),{debugName:"insertAndSlashActionsStore"})}function U(){const{maxActionsBeforeMore:e,actions:t}=function(){const e={selectionType:"cursor",isPageEmpty:!C.IC()},t=(0,x.up)(e),i=l.xH((0,x.pv)(t,e).map((e=>{let[t,i]=e;return i}))),o=b.Z.state,n=i.map((e=>(0,F.NZ)({prompt:e,validators:D.vE,type:"cursor",from:"slash_menu",sortScoreMultiplier:.75}))).filter(m.$K);return{maxActionsBeforeMore:o?3:1,actions:n}}();return(0,R.$J)({key:"completions",title:F.sY.notionAI,render:(0,F.yY)(),actions:(0,F.Rr)(t,e)})}const W=new o.Z((()=>B.Z.integrations.state.filter(p.l).map((e=>({key:`synced database ${e.id}`,displayName:`${e.name}`,analyticsName:`synced database ${e.name}`,searchName:`synced database ${e.name}`,thumbnail:e.info.icon??n.Z.images.blocks.embedPng,description:e.info.tagline,templateRootBlockId:"root",blockType:a.Ti.collectionView,shouldShow:e=>!C.nJ(e),createTemplate:()=>T.sU({isInline:!0,viewType:"table",integrationId:e.id}),postCreateCallback:e=>{const t=e.getCollectionViewStores()[0];t&&(0,I.u)(t.id,{viewType:"table"})}})))),{debugName:"getExternalIntegrationCreateCollectionViewBlockItems"});function q(e,t){return[(0,R.$J)({key:"Insert Basic Blocks",title:Y.basicBlocksSection,render:e=>(0,N.jsx)(w.Z,{...e}),actions:A.map((e=>J(e,t)))}),...e,(0,R.$J)({key:"Insert Media",title:Y.mediaSection,render:e=>(0,N.jsx)(w.Z,{...e}),actions:H.map((e=>J(e,t)))}),(0,R.$J)({key:"Insert Database New",title:Y.databaseSection,render:e=>(0,N.jsx)(w.Z,{...e}),actions:E.map((e=>J(e,t)))}),(0,R.$J)({key:"Insert AI Blocks",title:Y.aiBlocksSection,render:e=>(0,N.jsx)(w.Z,{...e}),actions:K.map((e=>J(e,t,void 0,.5)))}),(0,R.$J)({key:"Insert Advanced Blocks",title:Y.advancedBlocksSection,render:e=>(0,N.jsx)(w.Z,{...e}),actions:O.map((e=>J(e,t)))}),(0,R.$J)({key:"Insert Inline",title:Y.inlineSection,render:e=>(0,N.jsx)(w.Z,{...e}),actions:L}),(0,R.$J)({key:"Insert Embeds",title:Y.embedsSection,render:e=>(0,N.jsx)(w.Z,{...e}),actions:z().map((e=>J(e,t)))}),(0,R.$J)({key:"Insert Synced Databases",title:Y.syncedDatabasesSection,render:e=>(0,N.jsx)(w.Z,{...e}),actions:W.state.map((e=>J(e,t)))})]}function J(e,t,i,o){return{key:`insert ${e.key}`,displayName:e.displayName,analyticsName:e.analyticsName,searchName:e.searchName,render:t=>(0,N.jsx)(k.Z,{...t,...e,title:e.displayName,format:k.Q.Insert,...i}),closeParentMenu:!0,validators:[t=>!e.shouldShow||e.shouldShow(t)],action:i=>{let{environment:o}=i;v.createAndCommit({userAction:"actionRegistry.createInsertAction",environment:o,perform:i=>{y.at({environment:o,selection:V.default.state.stores,createBlockItem:e,analyticsFrom:t,transaction:i})}})},nativeRender:t=>({thumbnail:e.thumbnail}),sortScoreMultiplier:o}}function Q(e){return e.reduce(((e,t)=>[...e,...t.actions]),[])}const X=G({isMobileNative:!1}),ee=G({isMobileNative:!0})},26797:(e,t,i)=>{i.d(t,{Fv:()=>P,JN:()=>S,QG:()=>B,cQ:()=>M,f$:()=>C,fX:()=>x,td:()=>T,xD:()=>I});i(57658);var o=i(30120),n=i(80951),a=i(40506),s=i(53877),r=i(42875),l=i(72126),c=i(6287),d=i(97880),p=i(78316),m=i(95802),u=i(15723),g=i(17746),h=i(51757),f=i(8406),y=i(49865),v=i(75134),b=i(42239),k=i(19785),w=i(9953);function S(e){const{environment:t,droppedStores:i,duplicate:l,calendarBy:d,transaction:m,collectionContextStore:u}=e,g=o.ou.fromMillis(e.startOfDay);let h=!0;for(const o of i){const t=e.collectionStore?e.collectionStore:(0,p.Bm)({store:o,collectionContextStore:u});if(o.getParentTable()===c.v||!t){h=!1;break}k.zw({childStore:o,parentStore:t,transaction:m})||(h=!1)}const v=b.LQ({environment:t,droppedStores:i,duplicate:l,duplicateUseCrdt:!1,transaction:m,resolveTemplateVariables:!1});for(const o of v){const i=e.collectionStore?e.collectionStore:(0,p.Bm)({store:o,collectionContextStore:u}),l=o.getPropertyStore(d),c=n.Gl(l.getValue())||s.Lg((0,r.r)()),v=s.c$(c,(0,r.r)()),b=g.toFormat(s.Iq);let k;if("date"===v.type||"datetime"===v.type)k={...v,start_date:b};else{const e=s.NK(v,(0,r.r)());if(!e.end)return;const t={...v,start_date:b},i=s.NK(t,(0,r.r)()).start.diff(e.start,"days"),o=e.end.plus(i).toFormat(s.Iq);k={...v,start_date:b,end_date:o}}const w=s.c$(k,a.yw(c)||(0,r.r)());i&&y.mp({environment:t,store:o,collectionStore:i,collectionContextStore:u,coerce:!0,groupsPointer:[],transaction:m,alreadyMovedToCollection:h}),I({environment:t,type:"dateValue",propertyId:d,store:o,transaction:m,dateValue:w}),f.rv({environment:t,collectionContextStore:u,block_id:o.id,property:d,property_type:"date",from:"calendar"})}}function C(e){const{calendarStore:t,direction:i,target:o}=e;t.setState({...t.state,isDragging:!0,target:o,direction:i})}function T(e){const{calendarStore:t,x:i,y:c,calendarBy:d}=e,p=t.state;if(p.isDragging){const e=n.Gl(p.target.getPropertyStore(d).getValue());if(!e)return;const h=s.c$(e,(0,r.r)()),f=p.temporaryValue||e,y=s.c$(f,(0,r.r)()),v=[];p.dayStoreMap.forEach(((e,t)=>{v.push({store:e,timestamp:t})}));const b=v.find((e=>{let{store:t}=e;const o=m.C.getRectFromStore(t);return Boolean(o&&u.uh(o,i,c))}));let k;if(b){const e=o.ou.fromMillis(b.timestamp),t=e.endOf("day"),i=e.toFormat(s.Iq);if(h){const n=s.NK(h,(0,r.r)());if(p.direction===g.t.Left)if(o.Xp.fromDateTimes(e,t).contains(n.start))k=h;else{let e;e="datetimerange"===h.type||"daterange"===h.type?{...h,start_date:i,end_date:h.end_date}:"datetime"===h.type?{type:"datetimerange",start_date:i,start_time:h.start_time,end_date:h.start_date,end_time:h.start_time,time_zone:h.time_zone,reminder:h.reminder}:{type:"daterange",start_date:i,end_date:h.start_date,reminder:h.reminder};const t=s.NK(e,(0,r.r)());k=!n.end&&t.start>n.start||n.end&&t.start>n.end?y:e}else if(n.end?o.Xp.fromDateTimes(e,t).contains(n.end):o.Xp.fromDateTimes(e,t).contains(n.start))k=h;else{let e;e="date"===h.type?{...h,type:"daterange",end_date:i}:"datetime"===h.type?{...h,type:"datetimerange",end_date:i,end_time:"00:00"}:{...h,end_date:i};const t=s.NK(e,(0,r.r)());k=t.end&&t.end<t.start?y:e}}}if(k&&!l.Xy(y,k)){const e=s.c$(k,a.yw(f)||(0,r.r)());t.setState({...p,temporaryValue:e})}}}function x(e){const{environment:t,calendarStore:i,calendarBy:o,transaction:n}=e,a=i.state;a.isDragging&&a.temporaryValue&&(I({type:"dateValue",environment:t,dateValue:a.temporaryValue,propertyId:o,store:a.target,transaction:n}),i.setState({...i.state,isDragging:!1}))}function M(e){const{calendarStore:t}=e,i=t.state;i.isDragging&&t.setState({...i,isDragging:!1})}function P(e){const{environment:t,store:i,collectionStore:a,collectionContextStore:l,startDayOfWeek:c,transaction:d}=e,p=l.dateRangeStart.state,m=(0,r.r)(),u=l.normalizedQueryStore.state;if(!u||!u.calendar_by)return;const g=u.calendar_by,h=s.gQ(p,c,m),f=h.startOf("month"),v=h.endOf("month"),b=o.ou.now().startOf("day");let k;return k=o.Xp.fromDateTimes(f,v).contains(b)?s.hT(b.valueOf(),m):s.hT(s.em(p,c,m).valueOf(),m),w.sW({store:i.getPropertiesStore(),data:{[g]:n.d7(k)},transaction:d}),y.mp({environment:t,store:i,collectionStore:a,collectionContextStore:l,coerce:!0,groupsPointer:[],transaction:d}),i}function I(e){const{environment:t,store:i,propertyId:o,transaction:a}=e;let l;"timestamp"===e.type?l=s.hT(e.timestampMs.valueOf(),(0,r.r)()):"dateValue"===e.type?l=e.dateValue:(0,d.t1)(e);const c=i.getPropertyValue(o),p=n.d7(l);w.sW({store:i.getPropertiesStore(),data:{[o]:p},transaction:a}),v.H({environment:t,store:i,dateProperty:{id:o,oldValue:c,newValue:p}})}function B(e){const{environment:t,collectionStore:i,calendarBy:o,store:n,insertStores:a,collectionContextStore:s,transaction:r}=e,l=n.getPropertyStore(o).getValue();for(const c of a)y.mp({environment:t,store:c,collectionStore:i,collectionContextStore:s,coerce:!0,groupsPointer:[],transaction:r}),w.sO({store:c.getPropertyStore(o),value:l,transaction:r});return a.map((e=>h.G.createChildStore(i,e.pointer)))}},86282:(e,t,i)=>{i.d(t,{RL:()=>_,xv:()=>R,rC:()=>Y,Hp:()=>H,Lf:()=>N,$7:()=>F,GF:()=>E});i(21703);var o=i(15145),n=i(68626),a=i(59730),s=i(15157),r=i(45953),l=i(21202),c=i(23867),d=i(68939),p=(i(95477),i(33929)),m=i(98165),u=i(94660),g=i(74948),h=i(80444),f=i(77080),y=i(56638),v=i(50906),b=i(54642),k=i(54532),w=i(89858),S=i(9953),C=i(4408),T=i(75018),x=i(24677),M=i(28014),P=i(42875),I=i(29477),B=i(33954);var V=i(39699),Z=i(39865);const j="LastViewedTemplateId",D=(0,d.defineMessages)({clientCopyError:{defaultMessage:"Client copy could not be created.",id:"spaceActions.createGettingStartedPage.copyNotCreated.error"}});function F(e){const{environment:t,item:i,createNewPage:o,isPrivate:n}=e;x.ZH(t),y.Z.setState({open:!0,item:i,createNewPage:o,isPrivate:n,isLoading:!1}),s.Z.set({userId:t.currentUser.id,key:j,value:i.rootId}),v.jWY(t,{template_name:i.name,template_id:(0,u.gA)(i),from:o?"sidebar":"newPage"})}function R(e){y.Z.setState({item:y.Z.state.item,open:!1}),x.ZH(e)}async function _(e){const{item:t,environment:i,spaceStore:n}=e;y.Z.state.open&&y.Z.setState({...y.Z.state,isLoading:!0});const a=e.initializeStore?{...e,initializeStore:e.initializeStore,isPrivate:!1,type:"inExistingStore",useMinimalTemplates:!1}:{...e,type:"inSpace",useMinimalTemplates:!1,isOnboarding:!1};let s=!1;const r=Date.now();let l;try{l=await Y(a),s=!0,T.navigateToBlock({environment:i,store:l,pageVisitSource:o.tY.Create}),R(i),i.device.isMobile&&g.close()}finally{var c;const o=Date.now()-r,a=e.initializeStore?m.VP(e.initializeStore):void 0,d=e.initializeStore?!Boolean(a):e.isPrivate;v.enX(i,{template_name:t.name,destination:d?"private":"team",template_block_id:t.rootId,template_duplication_duration_ms:o,team_id:null==a?void 0:a.id,created_page_id:null===(c=l)||void 0===c?void 0:c.id}),v.XyT(i,{from:"inApp",success:s,context:e.from,template_name:t.name,template_block_id:t.rootId,target_space_id:n.id,template_duplication_duration_ms:o})}}async function N(e){const{environment:t,initializeStore:i,item:o,isPrivate:n,useMinimalTemplates:a,spaceStore:s,spaceViewStore:l}=e,c=a?o.rootId:o.previewRootId,d=await b.loadBlockSubtree(t,{block:{id:c,spaceId:o.spaceId},shallow:!1});let m;"success"===d.type&&(m=r.PF.create(d.data.subtreeRecordMap));const u="pageTemplateModalActions.loadAndDuplicatePageTemplate",{performResult:g}=V.createAndCommit({userAction:u,environment:t,perform:e=>{const o=i||M.KE({environment:t,spaceStore:s,spaceViewStore:l,isPrivate:n,loading:!0,transaction:e});C.fL({environment:t,inMemoryRecordCache:o.inMemoryRecordCache,recordMap:m,debugSource:u});const a=k.K8(t,{blockId:c,inMemoryRecordCache:o.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0});if(!a)throw new Error(p.default.getIntl().formatMessage(D.clientCopyError));return k.E9({environment:t,sourceBlockId:c,targetBlockPointer:o.pointer,sourceBlockSubtree:a,targetInMemoryRecordCache:o.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:o.useCrdt()}),o}});return g}async function Y(e){const{environment:t,item:i,useRecordCache:o,isPrivate:n,useMinimalTemplates:a,spaceStore:s,spaceViewStore:r,isOnboarding:c}=e,{serverCommitResult:d,performResult:{pageStore:p,copyBlock:m}}=V.createAndCommit({userAction:"pageTemplateModalActions.createTemplateInstance",environment:t,perform:c=>{let d;d="inExistingStore"===e.type&&e.initializeStore?e.initializeStore:"inTeam"===e.type&&e.teamStore?w.pq({environment:t,spaceStore:s,spaceViewStore:r,teamStore:e.teamStore,from:e.from,loading:!0,appendOrPrepend:e.appendOrPrepend?e.appendOrPrepend:"append",transaction:c}):M.KE({environment:t,spaceStore:s,spaceViewStore:r,isPrivate:n,loading:!0,transaction:c});const p={id:o&&!a?i.previewRootId:i.rootId,table:l.iU,spaceId:i.spaceId};return E({item:i,spaceViewStore:r,transaction:c}),function(e){const{item:t,transaction:i,spaceViewStore:o}=e;if(o){const e=o.getSidebarHiddenTemplateIds();if(e.indexOf(t.rootId)<0){const n=e.concat([t.rootId]);S.sW({store:o,data:{sidebar_hidden_templates:n},transaction:i})}}}({item:i,spaceViewStore:r,transaction:c}),{pageStore:d,copyBlock:p}}});return await d,await H({environment:t,pageStore:p,copyBlock:m,useRecordCache:o,item:i,isOnboarding:Boolean(c)}),p}const A={block:!0,collection:!0,collection_view:!0,discussion:!0,comment:!0};async function H(e){const{environment:t,pageStore:i,copyBlock:o,item:s,useRecordCache:l,isOnboarding:d}=e,m=r.Ak.create();l&&l.forEachRecord(t.currentUser.id,(e=>{let{model:t}=e;A[t.table]&&m.setModel(t.pointer,t)}));const{currentSpaceStore:u}=h.default.state;if(!u)throw new a.p8("Could not get currentSpaceStore.");const g=()=>{V.createAndCommit({userAction:"pageTemplateModalActions.initializePageTemplate.deletePageWhenError",environment:t,perform:e=>{Z.y8({environment:t,blocks:[i],transaction:e})}}),d&&v.XyT(t,{success:!1,template_name:s.name,template_id:s.id,template_block_id:s.rootId,target_space_id:u.id,from:"onboarding"}),n.log({level:"error",from:"pageTemplateModalActions.initializePageTemplate",type:"duplicateTemplateError",data:{miscDataToConvertToString:{template_name:s.name,template_id:s.id,template_block_id:s.rootId,is_onboarding:d}}})},y=f.default.getConfigKey("template_ids_to_use_duplicate_block","data");if(null!=y&&y.includes(o.id))await async function(e){const{environment:t,templateBlock:i,targetBlock:o}=e,n=I.UZ(),a=b.duplicateBlock(t,{sourceBlocks:[i],targetBlocks:[o],snapshotData:void 0,addCopyName:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:{currentUserId:t.currentUser.id,currentTimeZone:(0,P.r)()},convertExternalObjectInstancesToPlaceholders:i.spaceId!==o.spaceId,useCrdt:!1});let s;for await(const r of a)s=r;if(s)if(s.error){const e=(0,B.HV)(p.default.getIntl(),s.error);n.reject(e)}else n.resolve(s);else n.reject(void 0);return n.promise}({environment:t,templateBlock:o,targetBlock:{id:i.pointer.id,spaceId:(0,c.C)(i.pointer.spaceId)}}).catch(g);else{"failed"===(await b.initializePageTemplate(t,{recordMap:m.toJson({allowVersionDowngrade:!1}),sourceBlock:o,targetBlock:{id:i.pointer.id,table:i.pointer.table,spaceId:(0,c.C)(i.pointer.spaceId)},isOnboarding:d})).type&&g()}return i}function E(e){const{item:t,transaction:i,spaceViewStore:o}=e;if(o){const e=o.getVisitedTemplateIds();if(e.indexOf(t.rootId)<0){const n=e.concat([t.rootId]);S.sW({store:o,data:{visited_templates:n},transaction:i})}}}},87636:(e,t,i)=>{i.d(t,{Z:()=>f});var o=i(67294),n=i(13991),a=i(480),s=i(24405),r=i(22491),l=i(97880),c=i(82990),d=i(17311),p=i(23063),m=i(64921),u=i(26388),g=i(85893);function h(e){window.__c={n:"ActionMenuGroupButton"};const{button:t,isLast:i}=e,n=(0,s.yK)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:c.Z.fontWeight.medium,borderRight:`1px solid ${e.regularDividerColor}`,color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor},buttonLast:{borderRight:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return o.cloneElement(t,{...(0,r.iv)(t.props.style,n.button,i&&n.buttonLast),hoveredStyle:(0,r.iv)(n.buttonHovered,i&&n.buttonLast).style,pressedStyle:n.buttonPressed})}const f=function(e){let{children:t,isVisible:i,position:f,style:y}=e;window.__c={n:"ActionMenuGroup"};const v=(0,a.O7)(),b=(0,s.yK)((e=>({container:{color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.lightBoxShadow,display:"flex",whiteSpace:"nowrap",borderRadius:d.Z.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:v.device.isMobile?"auto":"none",opacity:v.device.isMobile?1:0,fontFamily:c.Z.getCompositeFontFamily(n.SP).sans,position:"absolute",right:d.Z.horizontal.small,bottom:d.Z.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:d.Z.vertical.small,bottom:void 0}})),[v]),k=o.Children.toArray(t).filter(l.$K),w=k.length;return(0,g.jsx)(p.Z,{isVisible:!0,animationStyle:{opacity:i?1:0},render:()=>(0,g.jsx)("div",{...(0,r.iv)(b.container,y,i&&b.containerHover,"top"===f&&b.containerTop),children:k.map(((e,t)=>{const i=t===w-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===u.Z&&o.isValidElement(e))return o.cloneElement(e,{render:(t,o)=>{const n=e.props.render(t,o);return(0,g.jsx)(h,{isLast:i,button:n},e.key)}});if(e.type===m.Z&&o.isValidElement(e))return(0,g.jsx)(h,{isLast:i,button:e},e.key)}}))})})}},64131:(e,t,i)=>{i.d(t,{Z:()=>j});var o=i(67294),n=i(480),a=i(86628),s=i(24405),r=i(8848),l=i(42853),c=i(70203),d=i(82990),p=i(68939),m=i(50906),u=i(98724),g=i(87279),h=i(98742),f=i(89086),y=i(52689),v=i(63334),b=i(24666),k=i(41216),w=i(64921),S=i(31945),C=i(56940),T=i(58261),x=i(78140),M=i(32163),P=i(40721),I=i(72495),B=i(26388),V=i(85893);const Z=o.Fragment;const j=function(e){window.__c={n:"HighlightSelectionButton"};const{disabled:t,style:i}=e,j=(0,a.qz)(e.ignoreSelectionAreaStore,v.Z),D=(0,n.O7)(),F=(0,p.useIntl)(),R=(0,s.Fg)(),_=(0,o.useCallback)((()=>{u.aS({environment:D,annotation:["h",y.Z.state.color]}),m.mt_(D,{action:"h",color:y.Z.state.color})}),[D]),N=(0,o.useCallback)((e=>{m.mt_(D,{action:"h"})}),[D]),Y=(0,o.useCallback)((()=>{b.default.emit()}),[]),A=(0,o.useCallback)((e=>{u.mX({environment:D,annotationType:"h"}),y.Z.setHighlightColor(e),_()}),[D,_]),H=(0,o.useCallback)(((e,t,i,o)=>({key:t||e,action:()=>{i(),A(e),o.close()},render:i=>(0,V.jsx)(k.Z,{...i,color:e,overrideDisplayName:t})})),[A]),E=(0,a.VK)((()=>{const e=(0,f.Ld)("h");return e?c.zIN(e):"default"}),[]),K=(0,s.yK)((e=>({colorIcon:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:18,textAlign:"center",fontSize:15,borderRadius:2,...!D.device.isMobile&&{width:18,fontWeight:d.Z.fontWeight.medium,marginBottom:2},...(0,r.A_)(E,e)}})),[D.device.isMobile,E]);return(0,V.jsx)(S.ZP,{popupType:D.device.isMobile?S.Z4.SlideUp:S.Z4.Popup,originGap:4,onClose:Y,onClick:N,renderOrigin:e=>(0,V.jsx)(B.Z,{renderTooltip:()=>(0,V.jsxs)(Z,{children:[(0,V.jsx)("div",{children:(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Text color",id:"highlightSelectionButton.textColor.tooltip"})}),(0,V.jsx)("div",{children:(0,V.jsx)(T.Z,{style:{color:R.mediumInvertedTextColor},name:"toggleHighlight"})})]}),render:o=>(0,V.jsxs)(w.Z,{style:{display:"flex",alignItems:"center",paddingLeft:7,paddingRight:6,whiteSpace:"nowrap",...i},disabled:t,disabledFeedback:t,...(0,h.Z)(e,o),children:[(0,V.jsx)("div",{style:K.colorIcon,children:D.device.isMobile?(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Color",id:"highlightSelectionButton.mobileColorIcon.label"}):"A"}),(0,l.i)({width:10,marginLeft:D.device.isMobile?4:3,fill:"dark"===R.mode?r.ZP.white:R.lightIconColor})]})}),render:e=>{let t;return t=D.device.isMobile?{menuType:g.og.Modal,title:(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Text color",id:"highlightSelectionButton.mobileTextColor.label"}),right:(0,V.jsx)(P.CancelMenuText,{}),onClickRight:()=>{e.close()}}:{menuType:g.og.Popup},(0,V.jsx)(x.Z,{...t,children:(0,V.jsx)(C.Z,{capture:D.device.isMobile,store:j,ignoreBlockSelection:!1,restoreSelection:!0,focusOffscreenInput:!1,render:t=>{const i=r.CY.map((i=>H(i,void 0,t,e))),o=[H("default",F.formatMessage({defaultMessage:"Default background",id:"highlightSelectionButton.defaultBackground.label"}),t,e),...r._K.map((i=>H(i,void 0,t,e)))],n=y.Z.state.color;return(0,V.jsx)(M.Z,{type:M.i.Vertical,sections:[{key:0,items:[{key:0,action:()=>{t(),A(n),e.close()},render:e=>(0,V.jsx)(k.Z,{...e,color:n,shortcuts:["toggleHighlight"]})}],render:e=>(0,V.jsx)(I.Z,{...e,title:(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Last used",id:"highlightSelectionButton.lastUsedSection.label"}),isTitleUppercase:!0})},{key:1,items:i,render:e=>(0,V.jsx)(I.Z,{...e,title:(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Color",id:"highlightSelectionButton.colorSection.label"}),isTitleUppercase:!0})},{key:2,items:o,render:e=>(0,V.jsx)(I.Z,{...e,title:(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Background",id:"highlightSelectionButton.backgroundSection.label"}),isTitleUppercase:!0})}],initialFocus:void 0})}})})}})}},82945:(e,t,i)=>{i.d(t,{Z:()=>f});var o=i(67294),n=i(480),a=i(24405),s=i(45137),r=i(68939),l=i(50906),c=i(18821),d=i(41662),p=i(24666),m=i(64921),u=i(58261),g=i(26388),h=i(85893);function f(e){window.__c={n:"InlineCommentButton"};const t=(0,n.O7)(),i=t.device.isMobile,f=(0,a.yK)((e=>({keyboardShorcut:{color:e.mediumInvertedTextColor}})),[]),y=()=>{let i;const o=p.default.state;"empty"!==o.mode&&(i=d.g$.getSimpleTableCellFromTextSelection(),c.WD({environment:t,blockStore:e.blockStore,multiSelection:o.multiSelection})),l.mt_(t,{action:"comment",from:i?"simple_table_cell":void 0})};return(0,h.jsx)(g.Z,{renderTooltip:()=>(0,h.jsxs)(o.Fragment,{children:[(0,h.jsx)("div",{children:(0,h.jsx)(r.FormattedMessage,{defaultMessage:"Comment on selected text",id:"inlineCommentButton.tooltip"})}),(0,h.jsx)("div",{children:(0,h.jsx)(u.Z,{style:f.keyboardShorcut,name:"comment"})})]}),render:t=>(0,h.jsxs)(m.Z,{style:{display:"flex",alignItems:"center",padding:"0 10px",whiteSpace:"nowrap",...e.style},disabled:e.disabled,disabledFeedback:e.disabled,onClick:y,...t,children:[(0,s.o)({width:i?18:16,height:i?18:16,marginTop:i?0:1,marginRight:4}),!i&&(0,h.jsx)(r.FormattedMessage,{defaultMessage:"Comment",id:"inlineCommentButton.commentLabel"})]})})}},65496:(e,t,i)=>{i.d(t,{Z:()=>x});var o=i(67294),n=i(83355),a=i(68939),s=i(96802),r=i(79698),l=i(39699),c=i(28651),d=i(94841),p=i(14542),m=i(96809),u=i(87636),g=i(23063),h=i(64921),f=i(12981),y=i(65107),v=i(68785),b=i(32854),k=i(81865),w=i(97496),S=i(56282),C=i(85893);class T extends n.Z{constructor(){super(...arguments),this.lastProxiedUrl=void 0,this.storeTypes={mouseStore:c.Z},this.handleLoadComplete=()=>{m.Z.reset()},this.renderControl=e=>{let{isVisible:t,isRepositioning:i,handleCancelClick:o,handleRepositionClick:n,handleSavePositionClick:s}=e;if(this.props.disabled||m.Z.state.loadingMode!==p.LU)return;const{device:r}=this.environment,{isMobile:l}=r;return(0,C.jsx)(g.Z,{isVisible:!0,animationStyle:{width:M(this.props.store),opacity:t?1:0},render:()=>(0,C.jsx)("div",{style:{position:"absolute",pointerEvents:t?"auto":"none",maxWidth:"100%",top:48},children:(0,C.jsxs)(u.Z,{isVisible:t,position:"bottom",style:{marginRight:this.props.paddingRight,marginLeft:this.props.paddingLeft},children:[!i&&(0,C.jsx)(h.Z,{style:{borderRight:l?"none":void 0,...w.ar},onClick:this.handleChangeCoverClick,children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),!i&&!l&&(0,C.jsx)(h.Z,{style:{...w.ar,borderRight:"none"},onClick:e=>n(e,this.lastProxiedUrl),children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),i&&!l&&(0,C.jsx)(h.Z,{style:w.ar,onClick:s,children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}),i&&!l&&(0,C.jsx)(h.Z,{style:{...w.ar,borderRight:"none"},onClick:o,children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})})]})})})},this.handleFlushTemporaryPosition=e=>{let{imagePosition:t,reset:i}=e;l.createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:this.environment,perform:e=>{s.Mp({store:this.props.store,coverPosition:t,transaction:e}),i()}})},this.handleChangeCoverClick=e=>{const{intl:t,store:i}=this.props;this.stores.mouseStore.reset();const o=e.target.getBoundingClientRect();r.j({environment:this.environment,intl:t,store:i,rect:o})},this.coverWithRecordStore=this.createComputedStore((()=>this.props.store.getCover()),!0),this.isPersonalHome=this.createComputedStore((()=>(0,d.WE)(this.props.store)))}renderComponent(){const e=this.coverWithRecordStore.getState();if(!e)return;const t=m.Z.state,i=t.loadingMode!==p.LU&&t.loadingMode!==p.SS;return(0,C.jsx)(S.Z,{mouseStore:this.stores.mouseStore,onFlushTemporaryPosition:this.handleFlushTemporaryPosition,renderControl:this.renderControl,source:"page",store:this.props.store,style:{display:"flex",flexDirection:"column",alignItems:"center",height:this.props.height,cursor:"default"},dragMessageContainerStyle:this.isPersonalHome.state?{top:56}:void 0,render:n=>(0,C.jsxs)(o.Fragment,{children:[(0,C.jsx)(k.Z,{url:e.cover,isAuthenticated:!0,permissionRecord:e.pointer,width:this.props.proxyWidth,render:(e,o)=>{this.lastProxiedUrl=o;const a={width:"100%",height:this.props.height,objectFit:"cover",opacity:i?.5:1,objectPosition:`center ${100*(1-(n.imagePosition||0))}%`,borderRadius:0},s={width:"100%",height:this.props.height};return(0,C.jsx)(y.B,{src:o,placeholderSrc:i?t.dataURL:void 0,placeholderBehavior:i?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:s,imageStyle:a,onLoadComplete:this.handleLoadComplete})}}),i&&(0,C.jsxs)("div",{style:f.Z.loadingContainerStyle,children:[(0,C.jsx)(v.Z,{style:{width:16,height:16,marginRight:4}}),(0,C.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,C.jsx)(b.Z,{percentage:t.uploadProgress})})]})]})})}}T.displayName="PageCover";const x=(0,a.injectIntl)(T);function M(e){let t;return t=!!e.isFullWidth()?"100%":900,t}},40464:(e,t,i)=>{i.d(t,{Z:()=>h});var o=i(67294),n=i(480),a=i(86628),s=i(24405),r=i(8848),l=i(50906),c=i(98724),d=i(89086),p=i(24666),m=i(64921),u=i(26388),g=i(85893);const h=function(e){window.__c={n:"SelectionAnnotationButton"};const{disabled:t,type:i,tooltipLabel:h,children:f,style:y,onClick:v}=e,b=(0,n.O7)(),k=(0,o.useCallback)((e=>{c.aS({environment:b,annotation:[i]}),v&&v(),l.mt_(b,{action:i})}),[b,i,v]),w=(0,a.VK)((()=>t||"editing"!==p.default.state.mode),[t]),S=(0,a.VK)((()=>Boolean((0,d.Ld)(i))),[i]),C=(0,s.yK)((e=>({button:{display:"flex",alignItems:"center",padding:"0 8px",color:S?r.ZP.blue:e.regularTextColor,...y}})),[S,y]);return(0,g.jsx)(u.Z,{renderTooltip:()=>h,render:e=>(0,g.jsx)(m.Z,{style:C.button,disabled:w,disabledFeedback:w,onClick:k,...e,children:f})})}},32404:(e,t,i)=>{i.d(t,{Z:()=>v});var o=i(67294),n=i(83355),a=i(24405),s=i(70203),r=i(68939),l=i(36280),c=i(89086),d=i(66949),p=i(24666),m=i(64921),u=i(58261),g=i(26388),h=i(85893);const f={display:"flex",alignItems:"center",borderRadius:0,paddingLeft:7,paddingRight:8};class y extends n.Z{constructor(){super(...arguments),this.handleButtonPopupClick=e=>{const{onClick:t}=this.props;l.qn({environment:this.environment,analyticsFrom:"rich_text_menu"}),t&&t(e)}}renderComponent(){const{style:e,children:t}=this.props,i=b(this.theme),o=function(e){if(e)return!0;if("editing"!==p.default.state.mode&&!d.Z.isOpen())return!0;const t={[s.GKr.User]:s.GKr.User,[s.GKr.Page]:s.GKr.Page,[s.GKr.Comment]:s.GKr.Comment,[s.GKr.Bot]:s.GKr.Bot,[s.GKr.Date]:s.GKr.Date,[s.GKr.ExternalObjectInstance]:s.GKr.ExternalObjectInstance,[s.GKr.TemporaryPage]:s.GKr.TemporaryPage,[s.GKr.TemplateVariable]:s.GKr.TemplateVariable,[s.GKr.FormulaPageProperty]:s.GKr.FormulaPageProperty,[s.GKr.FormulaContextValue]:s.GKr.FormulaContextValue,[s.GKr.Group]:s.GKr.Group,[s.GKr.Citation]:s.GKr.Citation};for(const i of Object.values(t))if((0,c.J6)(i))return!0;return!1}(this.props.disabled);return(0,h.jsx)(g.Z,{renderTooltip:()=>(0,h.jsx)(k,{}),render:n=>(0,h.jsx)(m.Z,{style:{...f,...i.equationButton,...e},disabled:o,disabledFeedback:o,onClick:this.handleButtonPopupClick,...n,children:t})})}}y.displayName="SelectionEquationButton";const v=(0,r.injectIntl)(y);function b(e){return{equationButton:{color:(0,c.Ld)(s.GKr.Equation)?e.blueColor:e.regularTextColor},keyboardShortcut:{color:e.mediumInvertedTextColor}}}function k(){window.__c={n:"MenuTooltipComponent"};const e=b((0,a.Fg)());return(0,h.jsxs)(o.Fragment,{children:[(0,h.jsx)("div",{children:(0,h.jsx)(r.FormattedMessage,{id:"richTextMenu.equationButton.tooltip",defaultMessage:"Create equation"})}),(0,h.jsx)("div",{children:(0,h.jsx)(u.Z,{style:e.keyboardShortcut,name:"openEquationMenu"})})]})}},73383:(e,t,i)=>{i.d(t,{Z:()=>y});var o=i(67294),n=i(83355),a=i(70203),s=i(68939),r=i(50906),l=i(45990),c=i(89086),d=i(23178),p=i(24666),m=i(64921),u=i(58261),g=i(26388),h=i(85893);class f extends n.Z{constructor(){super(...arguments),this.handleButtonPopupClick=()=>{l.dz({type:"focusOnly",focus:!0}),r.mt_(this.environment,{action:a.GKr.Link})}}renderComponent(){const e=(0,c.Ld)(a.GKr.Link),t=function(e){if(e)return!0;if("editing"!==p.default.state.mode&&!d.Z.state.open)return!0;if((0,c.J6)(a.GKr.User)||(0,c.J6)(a.GKr.Bot)||(0,c.J6)(a.GKr.Date)||(0,c.J6)(a.GKr.Page))return!0;return!1}(this.props.disabled);return(0,h.jsx)(g.Z,{renderTooltip:()=>(0,h.jsxs)(o.Fragment,{children:[(0,h.jsx)("div",{children:(0,h.jsx)(s.FormattedMessage,{defaultMessage:"Add link",id:"selectionLinkButton.addLink.tooltip"})}),(0,h.jsx)("div",{children:(0,h.jsx)(u.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"openLinkMenu"})})]}),render:i=>(0,h.jsx)(m.Z,{style:{display:"flex",alignItems:"center",borderRadius:0,paddingLeft:7,paddingRight:8,...e&&{color:this.theme.blueColor},whiteSpace:"nowrap",...this.props.style},disabled:t,disabledFeedback:t,...i,onClick:this.handleButtonPopupClick,children:this.props.children})})}}f.displayName="SelectionLinkButton";const y=(0,s.injectIntl)(f)},56282:(e,t,i)=>{i.d(t,{Z:()=>T});i(67294);var o=i(73935),n=i(83355),a=i(13991),s=i(6740),r=i(49085),l=i(12137),c=i(8848),d=i(22491),p=i(72126),m=i(82990),u=i(63143),g=i(68939),h=i(24677),f=i(28651),y=i(27724);class v extends r.default{getInitialState(){return{showFadeInAnimation:!1,isRepositioning:!1}}}const b=v;var k=i(23063),w=i(6685),S=i(85893);class C extends n.Z{constructor(){super(...arguments),this.storeTypes={focusStore:r.default.createClass(!1),mouseStore:f.Z,withImageRepositioningStore:b},this.renderDraggable=()=>(0,S.jsx)(w.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,disabled:!this.isRepositioning(),render:e=>(0,S.jsx)("div",{...(0,d.iv)(this.getDragContainerStyle()),...e,children:this.props.render({imagePosition:this.getRenderedCoverPosition(),isRepositioning:this.isRepositioning(),showFadeInAnimation:!1})})}),this.shouldBeActiveStore=this.createComputedStore((()=>0===y.default.state.stores.length)),this.handleFocus=e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,s.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=e=>{this.stores.focusStore.setState(!1)},this.handleMouseMove=e=>{this.mouseStore.setState({...this.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{this.mouseStore.setState({...this.mouseStore.state,mouseEntered:!1})},this.handleMouseMoveThrottled=(0,p.P2)(this.handleMouseMove,100),this.handleMouseLeaveDebounced=(0,p.Ds)(this.handleMouseLeave,100),this.handleWindowMouseDown=e=>{const t=o.findDOMNode(this);t&&!t.contains(e.target)&&this.isRepositioning()&&this.props.onFlushTemporaryPosition({imagePosition:this.getRenderedCoverPosition(),reset:()=>{this.mouseStore.reset(),this.stores.withImageRepositioningStore.reset()}})},this.handleRepositionClick=(e,t)=>{h.ZH(this.environment);const i=new Image;i.onload=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,isRepositioning:!0,image:i})},t&&(i.src=t)},this.handleCancelClick=e=>{this.stores.withImageRepositioningStore.reset()},this.handleSavePositionClick=e=>{this.props.onFlushTemporaryPosition({imagePosition:this.getRenderedCoverPosition(),reset:()=>{this.stores.withImageRepositioningStore.reset()}})},this.handleDragStart=e=>{const t=this.isRepositioning(),{image:i}=this.stores.withImageRepositioningStore.state;if(i&&t){const e=o.findDOMNode(this);if(e&&e instanceof Element){const t=e.getBoundingClientRect().width/i.width*i.height,o=this.getRenderedCoverPosition();this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:t,startDragRenderedPosition:o})}}},this.handleDragMove=e=>{if(this.isRepositioning()){const{startDragRenderedPosition:t,startDragImageScreenHeight:i}=this.stores.withImageRepositioningStore.state,o=e.diffY/(i||0)+(t||0);this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,temporaryPosition:(0,p.NM)((0,l.Z)(o,0,1),4)})}},this.handleDragEnd=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})},this.handleDragCancel=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})}}didMount(){super.didMount(),window.addEventListener("mousedown",this.handleWindowMouseDown)}willUnmount(){super.willUnmount(),window.removeEventListener("mousedown",this.handleWindowMouseDown)}UNSAFE_willMountOrUpdate(){this.isRepositioning()&&!this.shouldBeActiveStore.state&&this.stores.withImageRepositioningStore.reset()}renderComponent(){const{device:e}=this.environment,{style:t}=this.props,{isMobile:i}=e,o=this.isRepositioning(),{mouseEntered:n}=this.mouseStore.state,a=this.stores.focusStore.state;return(0,S.jsxs)("div",{onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseEnter:this.handleMouseMoveThrottled,onMouseMove:this.handleMouseMoveThrottled,onMouseLeave:this.handleMouseLeaveDebounced,...(0,d.iv)({position:"relative",width:"100%"},t),children:[this.renderDraggable(),this.renderDragMessage(),this.props.renderControl({handleRepositionClick:this.handleRepositionClick,handleSavePositionClick:this.handleSavePositionClick,handleCancelClick:this.handleCancelClick,isVisible:i||n||a||o,isRepositioning:o})]})}renderDragMessage(){const{isRepositioning:e}=this.stores.withImageRepositioningStore.state;if(!this.props.small)return(0,S.jsx)(k.Z,{isVisible:!0,animationStyle:{opacity:e?1:0},render:()=>{return(0,S.jsx)("div",{...(0,d.iv)((t=this.props.dragMessageContainerStyle,{background:c.ZP.blackWithAlpha(.4),borderRadius:4,color:c.ZP.white,fontSize:12,fontFamily:m.Z.getCompositeFontFamily(a.SP).sans,width:180,left:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center",...t??{}})),"aria-hidden":!e,children:(0,S.jsx)(g.FormattedMessage,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})});var t}})}isRepositioning(){return this.stores.withImageRepositioningStore.state.isRepositioning}getRenderedCoverPosition(){const{temporaryPosition:e}=this.stores.withImageRepositioningStore.state;return(0,p.hj)(e)?e:function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,p.hj)(e))return e}const i=.5;if(t.isCollectionView()){const e=t.getCollectionViewCollectionStore();if(e){const t=e.getFormat().collection_cover_position;return(0,u.z4)(t)?i:t}}const o=t.getFormat().page_cover_position;if((0,p.hj)(o))return o;return i}(this.props.source,this.props.store)}get mouseStore(){return this.props.mouseStore||this.stores.mouseStore}getDragContainerStyle(){return{width:"100%",cursor:this.isRepositioning()?"move":"inherit"}}}C.displayName="WithImageRepositioning";const T=C},27249:(e,t,i)=>{i.d(t,{CN:()=>c,H_:()=>r,OJ:()=>d,gh:()=>l});var o=i(11002),n=i(84465),a=i(94952),s=i(73314);function r(e){let{persona:t,defaultToLife:i}=e;if(!t)return;if(t in n._5)return t;const o={customer_support:"support",designer:"design",educator:"student",entrepreneur:"hr",freelancer:"design",hr_recruiting:"hr",it:"eng",marketing_sales:"marketing",media:"marketing",operations:"hr",operations_hr:"hr",personal:"life",product_manager:"product",programmer:"eng",other:i?"life":void 0,unfilled:i?"life":void 0,undefined:i?"life":void 0,creative:"design",founderCeo:"hr",internalCommunication:"hr",productDesign:"design",projectProgramMgmt:"product",finance:void 0,itAdmin:"eng",knowledgeManagement:"hr"};return(null==o?void 0:o[t])??void 0}function l(e,t){const i=r({persona:e,defaultToLife:!1});return(i?null===n.J9||void 0===n.J9?void 0:n.J9[i]:[]).filter((e=>(0,a.G)(e,t)))}function c(e,t,i){return l(e,t).map((e=>(0,s.G)(e,i)))}function d(e,t,i){return function(e,t){const i=r({persona:e,defaultToLife:!1});return(i?null==p?void 0:p[i]:[]).filter((e=>(0,a.G)(e,t)))}(e,t).map((e=>(0,s.G)(e,i)))}const p={product:[o.Y.productWiki,o.Y.productSpec,o.Y.productLaunchBrief],marketing:[o.Y.blogEditorialCalendar,o.Y.brandAssets,o.Y.moodBoard],sales:[o.Y.salesWikiV2,o.Y.salesAssets,o.Y.salesCRM],eng:[o.Y.engineeringTechSpec,o.Y.engineeringWiki]}},94660:(e,t,i)=>{i.d(t,{IJ:()=>c,PL:()=>l,W4:()=>d,gA:()=>m,p8:()=>p});var o=i(62992),n=i(97880),a=i(64002),s=i(76235),r=i(51757);function l(e,t){return e.filter((e=>{const i=e.getCopiedFromPointer();return Boolean(i&&(0,o.J)(i)&&Boolean(t&&t(i.id)))}))}const c=5;function d(e){const t=window.location.href;return a.SK(t,{tg:e.templateGalleryItem})}function p(){const e=window.location.href;let t;return t=a.iO(e,"tg"),t=a.iO(t,"np"),t=a.iO(t,"pjm"),t}function m(e){let t,i;return e instanceof r.j$?(t=e.getAppTemplateURI(),i=e.getBlockId()):"type"in e?"preset"===e.type?(t=e.uri,i=void 0):"pageTemplate"===e.type?(t=void 0,i=e.template.rootId):(0,n.t1)(e):(t=void 0,i=e.rootId),t&&s.presetUriToHumanReadableName[t]?s.presetUriToHumanReadableName[t]:i}},30496:(e,t,i)=>{i.d(t,{Z:()=>o});const o=new(i(61766).Z)},65435:(e,t,i)=>{i.d(t,{D2:()=>k,Io:()=>f,JL:()=>v,cY:()=>u,it:()=>y,oO:()=>g,vY:()=>b});var o=i(84465),n=i(94952),a=i(73314),s=i(97880),r=i(68939),l=i(95477),c=i(33929),d=i(27249),p=i(77080),m=i(59307);const u=(0,r.defineMessages)({addToTeamspace:{id:"templateGalleryHelpers.addToTeamspace",defaultMessage:"Add to a teamspace"},addToPrivate:{id:"teamPickerButton.addToPrivate",defaultMessage:"Add to Private"}});function g(e){var t;const{data:i}=m.Z.state;if(i&&null!==(t=i.topCategories)&&void 0!==t&&t.length)return i.topCategories.find((t=>t.id===e))}const h=Object.keys(o.J9);function f(e){let{userPersona:t,subscriptionTier:i}=e;return[...h].sort(((e,o)=>function(e,t,i,o){const n=void 0!==o&&["free","personal_free","student","personal"].includes(o),a=(0,d.H_)({persona:i,defaultToLife:n});if("suggested"===e||"suggested"===t)return"suggested"===e?-1:1;if(a===e||a===t)return a===e?-1:1;if(("life"===e||"life"===t)&&n)return"life"===e?-1:1;if(("student"===e||"student"===t)&&function(e){let{persona:t,isPersonalishPlan:i}=e;return(i?["other","unfilled","personal","undefined"]:["personal"]).includes(t??"undefined")}({persona:i,isPersonalishPlan:n}))return"student"===e?-1:1;return 0}(e,o,t,i)))}function y(e){let{userPersona:t,subscriptionTier:i}=e;const s=c.default.getIntl();return Object.fromEntries(f({userPersona:t,subscriptionTier:i}).map((e=>[e,[...o.J9[e].filter((e=>(0,n.G)(e,p.default))).map((e=>(0,a.G)(e,s)))]])).filter((e=>{let[t,i]=e;return(null==i?void 0:i.length)>0})))}function v(e){const t=(0,s.Yd)(e).map((e=>[e,!0]));return Object.fromEntries(t)}function b(e){var t;const{data:i}=m.Z.state;if(!i||null===(t=i.topCategories)||void 0===t||!t.length)return;const o=i.topCategories.find((t=>{var i;return null===(i=t.subcategories)||void 0===i?void 0:i.find((t=>{var i;return null===(i=t.templates)||void 0===i?void 0:i.find((t=>"pageTemplate"===t.type&&t.template.rootId===e||"preset"===t.type&&t.uri===e))}))}));return null==o?void 0:o.id}function k(e){return`${l.default.domainBaseUrl}/@${e}`}},59307:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(49085);class n extends o.default{getInitialState(){return{}}getTopTemplateCategories(){var e;const{data:t}=this.state;return t&&null!==(e=t.topCategories)&&void 0!==e&&e.length?Array.from(t.topCategories).filter((e=>{const t=e.subcategories||[];for(const o of t){var i;if(null!==(i=o.templates)&&void 0!==i&&i.length)return!0}return!1})):[]}}const a=new n},84465:(e,t,i)=>{i.d(t,{J9:()=>l,_5:()=>s,gh:()=>r});var o=i(92996),n=i(11002),a=i(98251);const s={suggested:a.sY.suggestedCategory,design:a.sY.designer,eng:a.sY.engineering,product:a.sY.productManagement,marketing:a.sY.marketing,sales:a.sY.sales,support:a.sY.support,hr:a.sY.hr,life:a.sY.life,student:a.sY.student},r={suggested:[o.Ll,o.Yb,o.tt,o.KW,o.r],product:[o.tt],design:[o.Yb],eng:[o.tt],marketing:[o.Yb],hr:[o.Yb],sales:[o.Yb],support:[o.Yb],life:[],student:[]},l={suggested:[n.Y.defaultWiki],product:[n.Y.oneOnOneNotes,n.Y.productWiki,n.Y.productSpec,n.Y.visionAndStrategy,n.Y.presentation,n.Y.investorUpdate,n.Y.userResearch,n.Y.experimentResults,n.Y.brainstorm,n.Y.productLaunchBrief],design:[n.Y.designSprint,n.Y.designSystem,n.Y.designPortfolio,n.Y.userResearch,n.Y.brainstorm],eng:[n.Y.engineeringWiki,n.Y.engineeringTechSpec,n.Y.experimentResults,n.Y.brainstorm],marketing:[n.Y.presentation,n.Y.brandAssets,n.Y.brainstorm,n.Y.contentCalendar,n.Y.blogEditorialCalendar,n.Y.socialMediaCalendar,n.Y.campaignBrief,n.Y.moodBoard,n.Y.mediaList],hr:[n.Y.companyHome,n.Y.newHireOnboarding,n.Y.employeeBenefits,n.Y.interviewGuide,n.Y.recruitingTracker,n.Y.jobBoard,n.Y.applicantTracker,n.Y.peopleDirectory],sales:[n.Y.salesWiki,n.Y.salesCRM,n.Y.salesAssets,n.Y.competitiveAnalysis],support:[n.Y.productFAQs,n.Y.helpCenter],life:[n.Y.readingListV2,n.Y.habitTrackerV2,n.Y.simpleBudgetV2,n.Y.weeklyTodoV2,n.Y.travelPlannerV2,n.Y.journalV2,n.Y.resumeV2,n.Y.personalHomeV3,n.Y.quickNoteV2,n.Y.jobApplicationsV2,n.Y.lifeWikiV2,n.Y.moodBoardV2,n.Y.blogPostV2,n.Y.personalCRMV2],student:[n.Y.studentDashboardV2,n.Y.classNotesV2,n.Y.courseScheduleV2,n.Y.gradeCalculatorV2,n.Y.cornellNotesSystemV2,n.Y.syllabusV2,n.Y.lessonPlansV2,n.Y.classDirectoryV2,n.Y.classroomHomeV2,n.Y.clubHomepageV2]}}}]);