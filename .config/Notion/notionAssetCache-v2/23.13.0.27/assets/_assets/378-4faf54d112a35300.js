"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[378],{58188:(e,t,n)=>{n.d(t,{Lg:()=>g,N:()=>p,Rt:()=>h,aG:()=>u});var i=n(13493),o=n(29369),s=n(39699),r=n(77907),a=n(30806),l=n(80444),d=n(14900),c=n(72711);function u(e){const{environment:t,currentSpaceViewStore:n,...i}=e,o=n.getModel();if(!o)return;const r=!o.showFeatureOnPersonalHome(e.feature);s.createAndCommit({userAction:"userHomeActions.toggleHomeFeature",environment:t,perform:t=>{s.applyOperation({store:n,operation:{pointer:n.pointer,path:["settings","personal_home","enabled_features"],command:"update",args:{[e.feature]:r}},transaction:t})}}),(0,a.cY)({environment:t,show:r,...i})}function p(e){let{environment:t,option:n,from:i,userAction:o}=e;const r=l.default.state.currentSpaceViewStore;if(!r)return!1;const d=r.getOnAppStartStore().getValue();return s.createAndCommit({userAction:o,environment:t,perform:e=>{s.applyOperation({store:r,operation:{pointer:r.pointer,path:["settings","on_app_start"],command:"set",args:n},transaction:e})}}),(0,a.BX)({environment:t,oldValue:d,newValue:n,from:i}),!0}async function h(e){const{environment:t,personalHomeStore:n}=e,i=null==n?void 0:n.getCoverStore();if(!n||!i||i.getValue())return;const o=(await r.deps.pageCovers.loader()).default;s.createAndCommit({userAction:"userHomeActions.addCoverPhoto",environment:t,perform:e=>{c.tk({transaction:e,store:n,coverStore:i,pageCovers:o})}})}function g(e){const{environment:t,selectedStore:n,currentSpaceViewStore:r,collectionContextStore:l}=e,c=l.collectionViewStore(),u=l.collectionStore(),p=l.collectionViewBlockStore();if(!(u&&c&&p&&r))return;const h=r.getTeamsStores(),g=n.table===o.e0?h.indexOf(n)+1:0,m=n.table===o.e0?n.id:void 0;s.createAndCommit({environment:t,userAction:"PersonalHomeTrendingPanel.setCollectionViewSourceTeamId",perform:e=>{s.applyOperation({store:c,operation:{pointer:{id:c.id,table:i.n},path:["format","collection_view_source","teamId"],command:"set",args:m},transaction:e}),d.mc({environment:t,collectionViewBlockStore:p,collectionViewStore:c,collectionStore:u,collectionContextStore:l,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}}),(0,a.Ay)({environment:t,teamId:m,index:g})}},55587:(e,t,n)=>{n.d(t,{j:()=>r});var i=n(89101),o=n(50906),s=n(75018);async function r(e){o.T3Y(e,{variant:"open_notion"}),o.ebp(e,{target:"open_notion"}),await s.publicPageTopBarAction(e,{utmContent:"topbar_cta",nextRoute:i._j.root})}},28040:(e,t,n)=>{n.d(t,{i:()=>u});var i=n(26263),o=n(65958),s=n(21202),r=n(80444),a=n(77080),l=n(51757),d=n(35057),c=n(54642);async function u(e){const{environment:t,sudoModeStore:n,pageBlockId:u}=e,p=n.state.privatePageStore&&n.state.privatePageStore.id===u;if(t.device.isMobile||p||n.state.loading||n.state.error)return;if(!a.default.checkGate("enable_get_private_page_info_endpoint"))return;const{currentSpaceStore:h}=r.default.state,g=null==h?void 0:h.canAdmin();if(!(u&&g&&h&&(0,d.wP)()))return;n.setState({...n.state,loading:!0});const m=h.id,v=await c.getPrivatePageInfo(t,{id:u});if("failed"===v.type)return void n.setState({...n.state,loading:!1,error:v.error});const b=v.data,f=new i.Z({name:o.Gh});for(const i of b)switch(i.table){case"block":case"collection":f.setRecord({pointer:{spaceId:m,table:i.table,id:i.value.id},userId:t.currentUser.id},{role:"editor",value:i.value});break;case"team":f.setRecord({pointer:{spaceId:m,table:i.table,id:i.value.id},userId:t.currentUser.id},{role:"editor",value:i.value})}const S=new l.G(t,{table:s.iU,id:u},{inMemoryRecordCache:f});S.inMemoryRecordCache.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),n.setState({...n.state,privatePageStore:S,loading:!1,error:void 0})}},7476:(e,t,n)=>{n.d(t,{t:()=>r});var i=n(80444),o=n(56681),s=n(34047);function r(e){var t;let{discussionStore:n,commentStore:r}=e;if(!r.isDefined())return!1;const a=null===(t=i.default.state.currentUserStore)||void 0===t?void 0:t.id;const l=o.Z.state[n.id];if(r.getCreatedById()===a)return!1;const d=function(){if(!n.isDefined()||!a)return 0;const{pageVisitStore:e}=i.default.state,{lastViewTime:t,lastExitTime:o}=e.state;return o||t}();if(void 0===d)return!1;const c=(0,s.NI)(n).filter((e=>e.getCreatedById()===a)).reverse()[0],u=r.getCreatedTime();return!u||!(c&&u<c.getCreatedTime())&&(!(l&&u<l)&&u>d)}},39849:(e,t,n)=>{n.d(t,{Z:()=>d});n(67294);var i=n(83355),o=n(8848),s=n(82990),r=n(85893);let a=function(e){return e[e.Red=0]="Red",e[e.Gray=1]="Gray",e}({});class l extends i.Z{renderComponent(){const{count:e}=this.props,t=this.props.color===a.Red;if(e&&!(e<=0))return(0,r.jsx)("div",{style:{...l.style,...this.props.style,...e>99&&{width:void 0,padding:2},background:t?this.theme.redBadgeBackground:this.theme.lightIconColor},children:(0,r.jsx)(c,{count:this.props.count,numberStyle:this.props.numberStyle})})}}l.displayName="MentionsBadge",l.Color=a,l.style={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,fontSize:10,textAlign:"center",fontWeight:s.Z.fontWeight.semibold,borderRadius:4,color:o.ZP.white,position:"static",marginLeft:6,WebkitFontSmoothing:"auto"};const d=l;function c(e){let{count:t,numberStyle:n}=e;return t?1===t?(0,r.jsx)("span",{style:{marginLeft:-.5,...n},children:"1"}):t>99?(0,r.jsx)("span",{style:{letterSpacing:-.5,...n},children:"99+"}):t>9?(0,r.jsx)("span",{style:{letterSpacing:-.5,marginLeft:-.5,...n},children:t}):(0,r.jsx)("span",{style:{...n},children:t}):null}},22789:(e,t,n)=>{n.d(t,{Z:()=>k});n(67294);var i=n(83355),o=n(16184),s=n(47020),r=n(3123),a=n(58687),l=n(19889),d=n(7928),c=n(68939),u=n(50906),p=n(96802),h=n(39699),g=n(34700),m=n(33929),v=n(92547),b=n(51757),f=n(64921),S=n(26388),x=n(85893);const y={width:16,marginRight:4};class M extends i.Z{constructor(){super(...arguments),this.storeTypes={lockStore:v.Z},this.renderTooltip=()=>{const e=this.props.store.getFormat().block_locked_by,t=m.default.getIntl(),{theme:n}=this;if(e){const i=(0,d.Nz)(t,b.t1.createChildStore(this.props.store,{table:l.KJ,id:e}).getModel());return(0,x.jsx)("div",{children:(0,x.jsx)(c.FormattedMessage,{defaultMessage:"Locked by {lockedByPerson}{br}to prevent accidental editing.{br}<prompttext>Click to unlock</prompttext>",id:"pageLockIndicator.lockedTooltip",values:{lockedByPerson:(0,x.jsx)("b",{children:i}),br:(0,x.jsx)("br",{}),prompttext:e=>(0,x.jsx)("span",{style:{color:n.mediumInvertedTextColor},children:e})}})})}},this.handleLockClick=()=>{const{store:e}=this.props;h.createAndCommit({userAction:"PageLockTopbarIndicator.handleLockClick",environment:this.environment,perform:t=>{p.Wq({environment:this.environment,store:e,isLocked:!1,transaction:t})}}),this.stores.lockStore.setState({...this.stores.lockStore.state,justUnlocked:!0});const t=this.props.store.getType();if(t){var n;let i;e.isCollectionView()&&(i=e.getCollectionViewCollectionStore()),u.UJr(this.environment,{from:"topbar",block_type:t,locked:!1,collection_id:null===(n=i)||void 0===n?void 0:n.id})}},this.handleUnlockClick=()=>{const{store:e}=this.props;h.createAndCommit({userAction:"PageLockTopbarIndicator.handleUnlockClick",environment:this.environment,perform:t=>{p.Wq({environment:this.environment,store:e,isLocked:!0,transaction:t})}}),this.stores.lockStore.setState({...this.stores.lockStore.state,justUnlocked:!1});const t=this.props.store.getType();if(t){var n;let i;e.isCollectionView()&&(i=e.getCollectionViewCollectionStore()),u.UJr(this.environment,{from:"topbar",block_type:t,locked:!0,collection_id:null===(n=i)||void 0===n?void 0:n.id})}}}renderComponent(){return this.props.isMobile?this.renderMobile():this.renderDesktop()}renderDesktop(){return this.props.store.isLocked()?(0,x.jsx)(S.Z,{renderTooltip:()=>this.renderTooltip(),disableTooltip:this.props.disableTooltip,render:e=>{return(0,x.jsxs)(f.Z,{style:(t=this.props.isMobile,n=this.environment,i=this.theme,s=this.props.isInlineCollection,r=this.props.buttonStyle,{...w(t,s,r),...(0,g.X)({noDrag:n.device.isElectronMac}),color:i.lightTextColor,fill:i.lightIconColor}),onClick:this.handleLockClick,...e,children:[(0,o.Q)(y),(0,x.jsx)("div",{style:{lineHeight:1},children:(0,x.jsx)(c.FormattedMessage,{defaultMessage:"Locked",id:"pageLockIndicator.lockedButton.label"})})]});var t,n,i,s,r}}):this.stores.lockStore.state.justUnlocked?(0,x.jsxs)(f.Z,{style:(e=this.props.isMobile,t=this.environment,n=this.theme,i=this.props.isInlineCollection,s=this.props.buttonStyle,{...w(e,i,s),...(0,g.X)({noDrag:t.device.isElectronMac}),paddingLeft:5,border:`1px solid ${n.blueColor}`,color:n.blueColor,fill:n.blueColor}),onClick:this.handleUnlockClick,hoveredStyle:{background:this.theme.outlineBlueButtonHoveredBackground},pressedStyle:{background:this.theme.outlineBlueButtonPressedBackground},children:[(0,a.H)(y),(0,x.jsx)("div",{style:{lineHeight:1},children:(0,x.jsx)(c.FormattedMessage,{defaultMessage:"Re-lock",id:"pageLockIndicator.relockButton.label"})})]}):void 0;var e,t,n,i,s}renderMobile(){const{WindowSizeStore:e}=this.environment;return this.props.store.isLocked()?(0,x.jsxs)(f.Z,{onClick:this.handleLockClick,mobileFeedback:!0,style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:e.getSafePaddingLeftCSS(10),paddingRight:e.getSafePaddingRightCSS(14)},children:[(0,s.B)({width:20,marginRight:6}),(0,x.jsx)("div",{children:(0,x.jsx)(c.FormattedMessage,{defaultMessage:"Locked",id:"pageLockIndicator.mobileLockedButton.label"})})]}):this.stores.lockStore.state.justUnlocked?(0,x.jsxs)(f.Z,{onClick:this.handleUnlockClick,mobileFeedback:!0,style:{display:"flex",alignItems:"center",width:"100%",height:"100%",paddingLeft:e.getSafePaddingLeftCSS(10),paddingRight:e.getSafePaddingRightCSS(14),color:this.theme.blueColor,fill:this.theme.blueColor},children:[(0,r.j)({height:26,width:32,marginRight:6}),(0,x.jsx)("div",{children:(0,x.jsx)(c.FormattedMessage,{defaultMessage:"Re-lock",id:"pageLockIndicator.mobileRelockButton.label"})})]}):void 0}}M.displayName="PageLockTopbarIndicator";const k=M;function w(e,t,n){return{display:"flex",alignItems:"center",whiteSpace:"nowrap",fontSize:e?12:14,borderRadius:4,padding:"0 6px",marginRight:2,height:24,marginTop:e?1:0,marginLeft:e?0:-5,...t&&{marginLeft:e?8:12,marginRight:0},...n}}},13612:(e,t,n)=>{n.d(t,{Z:()=>m});n(67294);var i=n(83355),o=n(480),s=n(56666),r=n(90334),a=n(68939),l=n(50906),d=n(24677),c=n(77907),u=n(64921),p=n(31945),h=n(85893);class g extends i.Z{constructor(){super(...arguments),this.handleClick=()=>{d.ZH(this.environment),l.FjP(this.environment)},this.handleDismiss=()=>{this.props.buttonPopupStore.setState({...this.props.buttonPopupStore.state,open:!1})}}renderComponent(){const{device:e}=this.environment;return(0,h.jsx)(p.ZP,{popupType:e.isMobile?p.Z4.SlideUp:p.Z4.Popup,buttonPopupStore:this.props.buttonPopupStore,renderOrigin:e=>(0,h.jsx)(b,{buttonPopupEvents:e,useEllipsisIcon:this.props.useEllipsisIcon}),onClick:this.handleClick,render:()=>(0,h.jsx)(c.LazyPublicTopbarMoreMenu,{block:this.props.store,onDismiss:this.handleClick}),originGap:8})}}g.displayName="PublicTopbarMoreButton";const m=(0,a.injectIntl)(g);function v(e){const{device:t}=e;return t.isMobile?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",marginLeft:8,marginRight:8}:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}}function b(e){let{buttonPopupEvents:t,useEllipsisIcon:n}=e;window.__c={n:"OriginComponent"};const i=(0,a.useIntl)(),l=(0,o.O7)(),{device:d}=l;return(0,h.jsx)(u.Z,{ariaLabel:i.formatMessage({id:"publicTopbarMoreButton.ariaLabel",defaultMessage:"More actions"}),style:v(l),mobileFeedback:d.isMobile,...t,children:n?(0,r.O)({width:18,height:18}):(0,s.o)({width:18,height:18})})}},31156:(e,t,n)=>{n.d(t,{C:()=>Ae,nk:()=>Ie,ZP:()=>Be,i3:()=>Oe});var i=n(67294),o=n(73935),s=n(83355),r=n(6740),a=n(15145),l=n(60651),d=n(25651),c=n(35840),u=n(45137),p=n(89101),h=n(21202),g=n(19889),m=n(80503),v=n(51454),b=n(68939),f=n(50906),S=n(47307),x=n(47839),y=n(3297),M=n(99553),k=n(40277),w=n(75018),j=n(87531),C=n(98104),T=n(3043),Z=n(95477),I=n(28020),P=n(43250),B=n(34700),_=n(84210),F=n(12534),E=n(67669),R=n(17504),L=n(65598),U=n(18514),A=n(11540),O=n(77907),D=n(34826),V=n(94841),N=n(24646),H=n(51),K=n(80444),G=n(61436),W=n(24042),z=n(96071),q=n(85974),X=n(45325),Y=n(83212),Q=n(51757),$=n(16194),J=n(52258),ee=n(66708),te=n(63296),ne=n(89728),ie=n(46457),oe=n(9045),se=n(22789),re=n(13612),ae=n(3553),le=n(480),de=n(86628),ce=n(24405),ue=n(58178),pe=n(25729),he=n(55587),ge=n(4708),me=n(38676),ve=n(42922),be=n(16354),fe=n(63437),Se=n(75272),xe=n(85893);function ye(e){window.__c={n:"TemplateGalleryPublicPageTopbar"};const{blockStore:t,style:n,onDoubleClick:o,onClickDuplicate:s,templateBlockStore:r}=e,a=(0,le.O7)(),d=(0,de.VK)((()=>H.Z.state.publicPageData),[]),c=(0,de.VK)((()=>(0,E.S4)(r)),[r]),[u,p]=(0,i.useState)(!1),h=(0,ce.yK)((e=>({topbarContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",overflow:"hidden",height:m.TT,paddingLeft:12,paddingRight:10},topbarContents:{display:"flex",alignItems:"center"},notionLogoStyle:{width:20,height:20},templatesIcon:{width:20,height:20,marginRight:4,marginTop:2},templateGalleryButton:{display:"flex",alignItems:"center",fontSize:15,fontWeight:600},centerText:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",overflow:"hidden",textWrap:"nowrap"},templateNameText:{fontSize:13.5,fontWeight:600},templateCreatorText:{fontSize:12,color:e.lightTextColor},templateCreatorLink:{fontSize:12,color:e.lightTextColor,cursor:"pointer"},publicTopbarMoreButton:{marginRight:8}})),[]),g=(0,de.VK)((()=>{const e=(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(ne.Z,{onClick:async()=>{await he.j(a)},children:(0,l.h)(h.notionLogoStyle)}),(0,xe.jsx)(fe.Z,{})]});return(0,ge.GH)()?me.sidebarExpandedStore.state?null:(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(Se.Z,{}),e]}):e}),[a,h.notionLogoStyle]);if(!d||!d.template)return(0,xe.jsx)(xe.Fragment,{});const v=(0,xe.jsx)("a",{href:`${Z.default.domainBaseUrl}/@${d.template.creator.username}`,target:"_blank",style:h.templateCreatorLink,onClick:()=>{var e;f.ebp(a,{target:"creator",slug:null===(e=d.template)||void 0===e?void 0:e.creator.username})},children:d.template.creator.name});return(0,xe.jsxs)("div",{style:n??h.topbarContainer,onDoubleClick:o,children:[(0,xe.jsxs)("div",{style:h.topbarContents,children:[g,(0,xe.jsx)(be.Z,{href:(0,U.UY)("templateGallery"),external:!0,children:(0,xe.jsxs)(ne.Z,{style:h.templateGalleryButton,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),onClick:()=>{f.ebp(a,{target:"gallery"})},children:[u?(0,pe.U)(h.templatesIcon):(0,ue.s)(h.templatesIcon),(0,xe.jsx)(b.FormattedMessage,{defaultMessage:"Templates",id:"templateGalleryPublicPageTopbar.templatesButton.label"})]})})]}),(0,xe.jsxs)("div",{style:h.centerText,children:[(0,xe.jsx)(be.Z,{href:`${(0,U.UY)("templateGallery")}/${d.template.slug}`,style:h.templateNameText,external:!0,onClick:()=>{var e;f.ebp(a,{target:"template",slug:null===(e=d.template)||void 0===e?void 0:e.slug})},children:d.template.name}),(0,xe.jsx)("div",{style:h.templateCreatorText,children:(0,xe.jsx)(b.FormattedMessage,{defaultMessage:"Template by {templateCreatorNameWithLink}",id:"templateGalleryPublicPageTopbar.templateName.subtitle",values:{templateCreatorNameWithLink:v}})})]}),(0,xe.jsxs)("div",{style:h.topbarContents,children:[(0,xe.jsx)("div",{style:h.publicTopbarMoreButton,children:(0,xe.jsx)(re.Z,{store:t,buttonPopupStore:J.Z})}),c&&(0,xe.jsx)(ve.Z,{onClick:s,children:(0,xe.jsx)(b.FormattedMessage,{defaultMessage:"Start with this template",id:"templateGalleryPublicPageTopbar.duplicateButton.label"})})]})]})}var Me=n(36997),ke=n(94686),we=n(17169),je=n(12253);const Ce={width:18,height:18,marginRight:6},Te={width:14,height:14,marginRight:6},Ze={width:14,height:14,marginLeft:6},Ie=700;class Pe extends s.Z{constructor(){super(...arguments),this.startedInitialPublicPageEdit=!1,this.screenXAtLastMouseDown=0,this.screenYAtLastMouseDown=0,this.storeTypes={loginModalStore:z.Z,loginStore:q.Z},this.handleMouseDown=()=>{this.screenXAtLastMouseDown=window.screenX,this.screenYAtLastMouseDown=window.screenY},this.handleClickTopbar=e=>{const t=window.screenX,n=window.screenY;this.screenXAtLastMouseDown===t&&this.screenYAtLastMouseDown===n&&(e.target===e.currentTarget&&C.ZH(this.environment),(0,F.ZP)({event:e,context:F.Af.EditorClick,callback:()=>{M.E5(this.environment)}}))},this.handleDoubleClickTopbar=e=>{e.target!==e.currentTarget||W.Z.state.isShowingTabBar||(0,F.ZP)({event:e,context:F.Af.EditorDoubleClick,callback:x.toggleMaximized})},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,r.E)(t)&&$.Z.setState(!0)},this.handleBlur=()=>{$.Z.setState(!1)},this.maybeOpenOnBaseUrl=()=>{var e;const{RouterStore:t}=this.environment,n=t.state.route,i=null===(e=this.pageContext)||void 0===e?void 0:e.pageStore;if("page"===n.name&&n.requestedOnPublicDomain&&i){const e=(0,_.ZP)({store:i,preferPublicLink:!1,pageVisitSource:a.tY.EditPublicPage});return w.navigateOnBaseUrl({environment:this.environment,url:e}),!0}return!1},this.handleStartPublicEdit=()=>{this.maybeOpenOnBaseUrl()||(this.environment.currentUser.isLoggedIn()?S.showDialog({showCancel:!0,keepFocus:!1,message:(0,xe.jsx)(b.FormattedMessage,{defaultMessage:"When you start editing, your name, email and photo may become visible to anyone who can view the page.",id:"topbar.startPublicEditDialog.message"}),items:[{label:(0,xe.jsx)(b.FormattedMessage,{defaultMessage:"Continue",id:"topbar.startPublicEditDialog.continueLabel"}),color:"blue",onAccept(){Y.Z.setState({editing:!0,commenting:!0})}}]}):(k.Hr({currentUserId:this.environment.currentUser.id,blockId:this.props.store.id}),w.navigateOnBaseUrl({environment:this.environment,url:p._j.login})))},this.handleAttemptPublicComment=()=>{k.Hr({currentUserId:this.environment.currentUser.id,blockId:this.props.store.id}),this.maybeOpenOnBaseUrl()||w.navigateOnBaseUrl({environment:this.environment,url:p._j.login})},this.forkPageRef=null,this.handleForkPageRef=e=>{this.forkPageRef=e},this.handleOpenQuickFind=()=>{j.UT({environment:this.environment,analyticsFrom:"public-page-topbar",isPublicPageSearch:!0})},this.handleOpenForkPage=()=>{y.S({environment:this.environment,store:this.props.store,originRect:this.getDuplicateClientRect()})},this.handleClickOpenNotion=async()=>{f.T3Y(this.environment,{variant:"open_notion"}),await w.publicPageTopBarAction(this.environment,{utmContent:"topbar_cta",nextRoute:p._j.root})},this.handleClickTryNotion=async()=>{f.T3Y(this.environment,{variant:"try_notion"}),await w.publicPageTopBarAction(this.environment,{utmContent:"topbar_cta",nextRoute:p._j.signup})},this.handleClickBuiltWithNotionToProduct=async()=>{await Oe({environment:this.environment,route:p._j.product})},this.handleClickBuiltWithNotionToSignup=async()=>{await Oe({environment:this.environment,route:p._j.signup})},this.shouldRenderTemplateGalleryTopbar=this.createComputedStore((()=>{const{device:e}=this.environment;if(e.isMobile||!(0,U.Sr)())return!1;if(!Le(this.props.store,this.environment))return!1;const{publicPageData:t}=H.Z.state;return!(null==t||!t.template)})),this.appRenderState=this.createComputedStore((()=>I.h1(this.environment)))}didUpdate(){const{store:e}=this.props,{RouterStore:t}=this.environment,n=t.state.route,{publicPageData:i}=H.Z.state;Re(this.props.store,this.environment)&&e.canComment()&&!e.canEdit()&&"page"===n.name&&!n.requestedOnPublicDomain&&Le(this.props.store,this.environment)&&null!=i&&i.requireLogin?Y.Z.setState({commenting:!0,editing:!1}):Re(this.props.store,this.environment)&&e.canEdit()&&!Y.Z.state.editing&&!Y.Z.state.commenting&&"page"===n.name&&!n.requestedOnPublicDomain&&Le(this.props.store,this.environment)&&!this.startedInitialPublicPageEdit&&null!=i&&i.requireLogin&&(this.startedInitialPublicPageEdit=!0,this.handleStartPublicEdit())}renderComponent(){return(0,R.Z)((e=>(0,xe.jsxs)("header",{style:De(this.props.store,this.environment,this.theme),...e,children:[(0,xe.jsx)("div",{style:this.getStyle(),className:P.lIT,onFocus:this.handleFocus,onBlur:this.handleBlur,children:Re(this.props.store,this.environment)&&(Le(this.props.store,this.environment)?this.shouldRenderTemplateGalleryTopbar.state?this.renderTemplateGalleryPublicPageTopbar():this.renderPublicPageTopbar():this.renderDefaultTopbar())}),(0,xe.jsx)(O.LazyBannersRenderer,{banners:this.props.banners,isMobile:!1,isInPeekRenderer:!1})]})))}renderPublicPageTopbar(){const{store:e,isInvalidPage:t,isElectron:n}=this.props,{isShowingTabBar:i}=W.Z.state,o=(0,A.R)();return(0,xe.jsxs)("div",{style:this.getContainerStyle(i),onDoubleClick:this.handleDoubleClickTopbar,children:[(0,xe.jsx)(ie._,{loginModalStore:this.stores.loginModalStore,loginStore:this.stores.loginStore,title:(0,xe.jsx)(oe.Z,{}),isSignup:!0}),n&&!i&&(0,xe.jsx)(ke.Z,{}),!t&&(0,xe.jsx)(T.l2,{store:e,style:Ue(this.environment),maxAncestorCount:2,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!0,isMobile:!1}),(0,xe.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),"control"===o?this.renderTopbarRightSectionDefault():this.renderTopbarRightSectionExp({experimentGroup:o})]})}renderTopbarRightSectionDefault(){const{device:e,currentUser:t}=this.environment,{store:n,isInvalidPage:i}=this.props,o=Boolean(t.isLoggedIn()||this.environment.publicDomainUserId);return(0,xe.jsxs)(xe.Fragment,{children:[n.canEdit()&&!Y.Z.state.editing&&(0,xe.jsxs)(te.Z,{onClick:this.handleStartPublicEdit,style:{marginRight:8,padding:"0 8px"},children:[(0,d.R)(Te),(0,xe.jsx)(b.FormattedMessage,{id:"topbar.publicPage.edit",defaultMessage:"Edit"})]}),!this.environment.currentUser.isLoggedIn()&&n.canComment()&&!n.canEdit()&&(0,xe.jsxs)(te.Z,{onClick:this.handleAttemptPublicComment,style:{marginRight:8,padding:"0 8px"},children:[(0,u.o)(Te),(0,xe.jsx)(b.FormattedMessage,{id:"topbar.publicPage.comment",defaultMessage:"Comment"})]}),(0,xe.jsxs)(ne.Z,{onClick:this.handleOpenQuickFind,children:[(0,c.R)(Te),(0,xe.jsx)(b.FormattedMessage,{defaultMessage:"Search",id:"topbar.publicPage.searchButton.label"})]}),(0,E.S4)(this.props.store)&&(0,xe.jsx)(ne.Z,{onClick:this.handleOpenForkPage,ref:this.handleForkPageRef,children:(0,xe.jsx)(b.FormattedMessage,{defaultMessage:"Duplicate",id:"topbar.publicPage.duplicateButton.label"})}),!e.isMobile&&!i&&(0,xe.jsx)(re.Z,{store:n,buttonPopupStore:J.Z}),(0,xe.jsx)("div",{style:(s=this.theme,{flex:"none",width:1,height:16,marginLeft:8,marginRight:8,background:s.darkDividerColor})}),o?(0,xe.jsxs)(ne.Z,{onClick:this.handleClickOpenNotion,children:[(0,l.h)(Ce),(0,xe.jsx)(_e,{})]}):(0,xe.jsxs)(ne.Z,{onClick:this.handleClickTryNotion,children:[(0,l.h)(Ce),(0,xe.jsx)(Fe,{})]})]});var s}renderTopbarRightSectionExp(e){let{experimentGroup:t}=e;const{device:n}=this.environment,{store:i,isInvalidPage:o}=this.props,s="on_marketing"===t?this.handleClickBuiltWithNotionToProduct:this.handleClickBuiltWithNotionToSignup;return(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(ne.Z,{onClick:this.handleOpenQuickFind,children:(0,c.R)(Te)}),!n.isMobile&&!o&&(0,xe.jsx)(re.Z,{store:i,buttonPopupStore:J.Z,useEllipsisIcon:!0}),(0,xe.jsx)(Ae,{onClick:s})]})}renderTemplateGalleryPublicPageTopbar(){var e;const{store:t,isInvalidPage:n}=this.props,{publicPageData:i}=H.Z.state,o=null!=i&&null!==(e=i.template)&&void 0!==e&&e.blockId?new Q.G(this.environment,{table:h.iU,id:null==i?void 0:i.template.blockId}):void 0;return o?(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(ye,{blockStore:t,style:{...this.getContainerStyle(!1),borderBottom:`1px solid ${this.theme.lightDividerColor}`},onDoubleClick:this.handleDoubleClickTopbar,onClickDuplicate:()=>{y.S({environment:this.environment,store:o,originRect:this.getDuplicateClientRect()})},templateBlockStore:o}),(0,xe.jsxs)("div",{style:this.getContainerStyle(!1),onDoubleClick:this.handleDoubleClickTopbar,children:[!n&&(0,xe.jsx)(T.l2,{store:t,style:Ue(this.environment),maxAncestorCount:2,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!0,isMobile:!1}),(0,xe.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),(0,xe.jsxs)(ne.Z,{onClick:this.handleOpenQuickFind,children:[(0,c.R)(Te),(0,xe.jsx)(b.FormattedMessage,{defaultMessage:"Search",id:"topbar.publicPage.searchButton.label"})]})]})]}):this.renderPublicPageTopbar()}renderDefaultTopbar(){const{store:e,isInvalidPage:t,isElectron:n,showSidebarButton:i,collectionViewStore:o,hideActionButtons:s}=this.props,{isMobile:r}=this.environment.device,{pageVisitStore:a,presenceStore:l,currentSpaceStore:d,currentSpaceViewStore:c}=K.default.state,u=(0,E.IJ)(this.environment,this.props.store),p=(0,V.WE)(e),{isShowingTabBar:h}=W.Z.state,g=p?(0,xe.jsx)(D.E,{isInvalidPage:t}):(0,xe.jsx)(Me.iY,{store:e,collectionViewStore:o,spaceStore:d,spaceViewStore:c,pageVisitStore:a,presenceStore:l,isInvalidPage:t});return(0,xe.jsx)(ae.Z,{store:e,disableRectangularSelection:!0,disableEditNearestBlock:!0,render:()=>(0,xe.jsxs)("div",{style:this.getContainerStyle(h),onClick:this.handleClickTopbar,onMouseDown:this.handleMouseDown,onDoubleClick:this.handleDoubleClickTopbar,children:[i&&(0,xe.jsx)(Se.Z,{}),n&&!h&&(0,xe.jsx)(ke.Z,{}),!t&&(0,xe.jsx)(T.l2,{store:e,style:Ue(this.environment),maxAncestorCount:2,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!0,isMobile:!1}),e.canEditCollection()&&(0,xe.jsx)(se.Z,{store:e,isMobile:!1},e.id),e.isRestricted()&&(0,xe.jsx)(je.Z,{style:{...(0,B.X)({noDrag:this.environment.device.isElectronMac}),marginRight:10},onClick:()=>{ee.Z.setState({open:!0})}}),!t&&(0,xe.jsx)(we.Z,{}),(0,xe.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),!r&&!u&&!s&&g]})})}getDuplicateClientRect(){if(this.forkPageRef){const e=o.findDOMNode(this.forkPageRef);if(e instanceof Element)return e.getBoundingClientRect()}}getStyle(){const e=m.R6(this.environment.device.isElectronMac),t=2*m.TT;return{width:"100%",maxWidth:"100vw",height:this.shouldRenderTemplateGalleryTopbar.state?t:e,opacity:I.tu.state?0:1,transition:`\n \t\t\t\topacity ${Ie}ms,\n \t\t\t\tcolor ${Ie}ms\n\t\t\t`,position:"relative"}}getContainerStyle(e){const{device:t}=this.environment,n=t.isElectronMac&&(!this.appRenderState.state.shouldShowSidebar||!(0,N.in)(this.environment)&&!X.default.isOpen())&&!G.Z.state.isFullScreen&&!e;return{...(0,B.X)({drag:this.environment.device.isElectronMac&&!e}),display:"flex",justifyContent:"space-between",alignItems:"center",overflow:"hidden",height:this.shouldRenderTemplateGalleryTopbar.state?m.TT:m.R6(this.environment.device.isElectronMac),paddingLeft:n?73:t.isMobile?4:12,paddingRight:t.isMobile?4:10}}}Pe.displayName="Topbar";const Be=Pe;function _e(){return(0,xe.jsx)(b.FormattedMessage,{defaultMessage:"Open Notion",id:"topbar.publicPage.cta.label.open"})}function Fe(){return(0,xe.jsx)(b.FormattedMessage,{defaultMessage:"Try Notion",id:"topbar.publicPage.cta.label.try"})}function Ee(){return(0,xe.jsx)(b.FormattedMessage,{defaultMessage:"Built with",id:"topbar.publicPage.cta.label.builtWithNotion"})}function Re(e,t){const n=(0,L.Oh)(e),{id:i}=t.currentUser,o=i?Q.U6.createChildStore(e,{table:g.KJ,id:i}):void 0,s=!o||o.isReady();return n&&s}function Le(e,t){return!Z.default.isAdminMode&&(0,E.IJ)(t,e)}function Ue(e){return{...(0,B.X)({noDrag:e.device.isElectronMac}),height:"100%",flexGrow:0,marginRight:8,fontSize:14,minWidth:0}}function Ae(e){return(0,xe.jsxs)(te.Z,{style:{padding:"0 10px",marginLeft:8},onClick:e.onClick,children:[(0,xe.jsx)(Ee,{}),(0,l.h)(Ze)]})}p._j.signup,p._j.product;async function Oe(e){const{environment:t,route:n}=e;f.T3Y(t,{variant:"built_with_notion"}),await w.publicPageTopBarAction(t,{utmContent:"topbar_cta",nextRoute:n})}function De(e,t,n){const i=(0,V.WE)(e);return{maxWidth:"100vw",zIndex:v.lI,background:i?(0,V.$1)({theme:n,isPhone:t.device.isPhone}):n.contentBackground,WebkitUserSelect:"none",userSelect:"none"}}},36997:(e,t,n)=>{n.d(t,{iY:()=>K,UP:()=>G,W2:()=>W});var i=n(67294),o=n(480),s=n(86628),r=n(24405),a=n(7525),l=n(80503),d=n(51454),c=n(68939),u=n(92650),p=n(95477),h=n(28651),g=n(28020),m=n(43250),v=n(73742),b=n(74948),f=n(24646),S=n(36391),x=n(21273),y=n(61766);const M=new y.Z,k=new y.Z;var w=n(52258),j=n(66708),C=n(77503),T=n(34700),Z=n(16402),I=n(24039),P=n(26388),B=n(85893);function _(e){window.__c={n:"PageFreshnessMetadata"};const{store:t,isExpanded:n,isWindowSmall:o,isElectronMac:a}=e,l=(0,r.Fg)(),d=(0,s.VK)((()=>t.getLastEditedTime()),[t]),[u,p]=(0,i.useState)("flex"),[h,g]=(0,i.useState)(1);(0,i.useEffect)((()=>{let e;return n||o?n?(g(0),p("none")):(g(0),e=setTimeout((()=>p("none")),150)):(p("flex"),e=setTimeout((()=>g(1)),150)),()=>clearTimeout(e)}),[n,o]);const m=d?(0,Z.IS)(d,{useLowercase:!0,useCompactFormat:!0,roundDownYears:!0}):"";return m?(0,B.jsx)(B.Fragment,{children:(0,B.jsx)("span",{style:{opacity:h,transition:"opacity 150ms linear",display:u,alignItems:"center",fontSize:14,color:l.lightTextColor,height:28,whiteSpace:"nowrap",lineHeight:1.2},children:(0,B.jsx)("div",{style:{display:"flex",flexFlow:"wrap"},children:(0,B.jsx)(P.Z,{placement:P.Z.Placement.Bottom,alignment:P.Z.Alignment.Start,renderTooltip:()=>(0,B.jsx)(I.Z,{store:t,compactFormat:!0}),render:e=>{return(0,B.jsx)(B.Fragment,{children:(0,B.jsx)("div",{...e,style:{...(0,T.X)({noDrag:a})},children:(t=m,(0,B.jsx)(c.FormattedMessage,{defaultMessage:"Edited {timestamp}",id:"pagePropertiesHeader.edited.label",values:{timestamp:t}}))})});var t}})})})}):null}var F=n(31156),E=n(11751),R=n(73063);function L(e){let{blockStore:t,spaceStore:n,buttonPopupStore:s}=e;window.__c={n:"TopbarAiContextButton"};const a=(0,o.O7)(),l=(0,i.useCallback)((()=>{(0,b.handleSidebarButtonClick)(a,t,S.gY.AiContext,"topbar")}),[a,t]),d=function(){const{isElectronMac:e}=(0,o.O7)().device;return(0,r.yK)((t=>({icon:{height:18,width:18,fill:t.regularIconColor},button:{...(0,T.X)({noDrag:e}),width:33,height:28,marginRight:2}})),[e])}();return(0,B.jsx)(P.Z,{placement:P.Z.Placement.Bottom,renderTooltip:()=>"AI Context [ai_team]",render:e=>(0,B.jsx)(R.Z,{icon:E.t,iconStyle:d.icon,style:d.button,ariaLabel:"AI Context [ai_team]",onClick:l,...e})})}var U=n(79075),A=n(96677),O=n(10137),D=n(67485),V=n(19368),N=n(29538),H=n(23727);function K(e){window.__c={n:"TopbarActionButtons"};const t=(0,o.O7)(),{device:n}=t,p=(0,c.useIntl)(),{store:y,spaceStore:T,pageVisitStore:Z,presenceStore:I,collectionViewStore:P,spaceViewStore:E}=e,R=(0,s.VK)((()=>y.canEdit()),[y]),[K,z]=(0,s.AF)(void 0,h.Z),[q,X]=(0,i.useState)(!1),[Y]=(0,s.AF)(S.ZP),Q=(0,s.VK)((()=>g.qG(y.id)),[y]),$=(0,s.VK)((()=>W({canEditPage:R,device:n})&&!Q),[R,n,Q]),J=(0,s.VK)((()=>Boolean(T&&!T.canEdit())),[T]),ee=(0,s.VK)((()=>(0,f.Sx)(t)),[t]),te=(0,s.VK)((()=>(0,u.ui)(t,!1)<1150),[t]),ne=(0,s.VK)((()=>G({isSpaceGuest:J,canEditPage:R})&&!Q),[R,Q,J]);(0,i.useEffect)((()=>{X(!ee)}),[ee]);const{canShowUpdateSidebarUnexpander:ie,shouldShowUpdateSidebarUnexpander:oe}=(0,s.VK)((()=>{const e=!q&&ee&&!(0,f._c)(t);return{canShowUpdateSidebarUnexpander:e,shouldShowUpdateSidebarUnexpander:e&&(Y.mouseEntered||K.mouseEntered)}}),[q,ee,t,K,Y]),[se]=(0,s.AF)(S.ZP),re=(0,s.Kw)(g.tu),ae=(0,s.VK)((()=>!n.isMobile&&!Q&&(!y.isCollectionView()||y.isCollectionViewPageWithContent())),[n.isMobile,Q,y]),le=(0,s.VK)((()=>x.Z.isContextEnabled()),[]),de=(0,s.VK)((()=>!n.isMobile&&!Q),[n.isMobile,Q]),ce=(0,r.yK)((()=>({actionButtonsWrapStyle:{flexGrow:0,flexShrink:0,display:"flex",alignItems:"center",paddingRight:n.isMobile?4:0,paddingLeft:n.isMobile?4:12,width:ie?se.width:void 0,justifyContent:"space-between",zIndex:d.A_,height:l.R6(t.device.isElectronMac),opacity:re?0:1,transition:`\n\t\t\t\t\topacity ${F.nk}ms,\n\t\t\t\t\tcolor ${F.nk}ms\n\t\t\t\t`},rightButtonsContainer:{display:"flex"}})),[ie,n,se,t,re]);if(e.isInvalidPage)return null;const ue=n.isElectronMac&&re||!ie||!n.isElectron&&!oe||Y.isAnimating;return(0,B.jsxs)("div",{style:ce.actionButtonsWrapStyle,onMouseMove:()=>{z({...K,mouseEntered:!0})},onMouseLeave:()=>{z({...K,mouseEntered:!1})},className:m.A_D,children:[ue?(0,B.jsx)("div",{}):(0,B.jsx)("div",{className:m.JiD,children:(0,B.jsx)(N.C,{shouldHide:ue,icon:a.t,caption:p.formatMessage({defaultMessage:"Close sidebar",id:"updateSidebarUnexpandButton.closeSidebar.tooltip"}),onClick:()=>{X(!0),b.setUpdateExpand({environment:t,isExpanded:!1,from:"close_for_space"})},keyboardShortcutName:"toggleUpdateSidebar",isElectron:n.isElectron})}),(0,B.jsxs)("div",{style:ce.rightButtonsContainer,children:[!Q&&(0,B.jsx)(_,{store:y,isExpanded:ee,isWindowSmall:te,isElectronMac:n.isElectronMac}),R&&Z&&I&&(0,B.jsx)(D.Z,{rootStore:y,pageVisitStore:Z,presenceStore:I,maxUsers:Y.expanded?3:void 0}),ne&&(0,B.jsx)(V.Z,{store:y,buttonPopupStore:j.Z}),le&&y&&T&&(0,B.jsx)(L,{blockStore:y,spaceStore:T,buttonPopupStore:M}),ae&&(0,B.jsx)(U.Z,{blockStore:y,spaceStore:T,buttonPopupStore:k}),$&&(0,B.jsx)(H.Z,{blockStore:y,spaceStore:T,buttonPopupStore:C.Z}),(0,B.jsx)(A.Z,{store:y,spaceViewStore:E}),Q&&(0,B.jsx)(v.Z,{}),de&&(0,B.jsx)(O.Z,{store:y,collectionViewStore:P,buttonPopupStore:w.Z})]})]})}function G(e){const{canEditPage:t,isSpaceGuest:n}=e;return!!p.default.isAdminMode||(!n||t)}function W(e){const{canEditPage:t,device:n}=e;return!!p.default.isAdminMode||!!t&&!n.isPhone}},94686:(e,t,n)=>{n.d(t,{Z:()=>I});n(67294);var i=n(83355),o=n(480),s=n(86628),r=n(1464),a=n(81270),l=n(10020),d=n(12392),c=n(13530),u=n(73361),p=n(68939),h=n(50906),g=n(47839),m=n(75018),v=n(53971),b=n(34700),f=n(18514),S=n(24042),x=n(88923),y=n(64921),M=n(73063),k=n(58261),w=n(53437),j=n(26388),C=n(85893);const T={position:"relative",display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:32};class Z extends i.Z{constructor(){super(...arguments),this.renderDesktopButtons=()=>(0,C.jsx)(v.Z,{capture:!0,render:e=>(0,C.jsxs)("div",{style:{display:"flex",flexShrink:0},...e,children:[this.renderBackButton(),this.renderForwardButton(),(0,C.jsx)(B,{})]})}),this.handleBackClick=()=>{const{supportsNativeHomeTabPhone:e}=this.props,{mobileNative:t}=this.environment;h.MEX(this.environment,{type:"back"}),f.__(this.environment)?m.back(this.environment):e&&!f.NW(this.environment)?null==t||t.showNativeHomeTab():m.back(this.environment)},this.handleForwardClick=()=>{h.MEX(this.environment,{type:"forward"}),m.forward()}}renderComponent(){return this.environment.device.isMobile?this.renderMobile():this.renderDesktop()}renderDesktop(){return(0,C.jsx)(w.ZP,{style:{background:"transparent",borderRadius:0,boxShadow:"none"},origin:this.renderDesktopButtons(),render:this.renderDesktopButtons,placementToOrigin:w.ZP.Placement.Center,alignmentToOrigin:w.ZP.Alignment.Center,open:x.default.isCenterPeekOpen(),disableMouseCapture:!0,preventCaptureEsc:!0,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:w.ZP.PopupType.Popup})}renderBackButton(){const e=e=>(0,a.z)({...e,width:"24px",height:"24px"}),t=e=>(0,d.S)(e);return(0,C.jsx)(j.Z,{renderTooltip:()=>(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)(p.FormattedMessage,{id:"topbarBrowserHistoryButtons.goBackButton.label",defaultMessage:"Go back"}),(0,C.jsx)(k.Z,{name:"goBack",style:{opacity:.5,marginLeft:4}})]}),placement:j.Z.Placement.Bottom,alignment:j.Z.Alignment.Center,originGap:6,render:n=>(0,C.jsx)(M.Z,{icon:S.Z.state.isTabsFeatureEnabled?e:t,isDarkIconColor:!0,className:"notion-history-back-button",disabled:!f.NW(this.environment),style:{position:"relative",...(0,b.X)({noDrag:this.environment.device.isElectronMac})},onClick:this.handleBackClick,...n})})}renderForwardButton(){const e=e=>(0,l.C)({...e,width:"24px",height:"24px"}),t=e=>(0,c.s)(e);return(0,C.jsx)(j.Z,{renderTooltip:()=>(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)(p.FormattedMessage,{id:"topbarBrowserHistoryButton.goForwardButton.label",defaultMessage:"Go forward"}),(0,C.jsx)(k.Z,{name:"goForward",style:{opacity:.5,marginLeft:4}})]}),placement:j.Z.Placement.Bottom,alignment:j.Z.Alignment.Center,originGap:6,render:n=>(0,C.jsx)(M.Z,{icon:S.Z.state.isTabsFeatureEnabled?e:t,isDarkIconColor:!0,className:"notion-history-forward-button",disabled:!f.vy(this.environment),style:{position:"relative",...(0,b.X)({noDrag:this.environment.device.isElectronMac})},onClick:this.handleForwardClick,...n})})}renderMobile(){const{supportsNativeHomeTabPhone:e}=this.props;if(e||this.environment.device.isTablet)return(0,C.jsx)(v.Z,{capture:!0,render:t=>(0,C.jsxs)("div",{style:{display:"flex",flexShrink:0,height:"100%",paddingLeft:4,paddingRight:e?0:4},...t,children:[this.renderMobileBackButton(),!e&&this.renderMobileForwardButton()]})})}renderMobileBackButton(){const{RouterStore:e}=this.environment,{supportsNativeHomeTabPhone:t}=this.props,n=!t&&!e.canGoBack();return(0,C.jsx)(y.Z,{onClick:this.handleBackClick,className:"notion-history-back-button",disabled:n,disabledFeedback:!0,mobileFeedback:!0,style:T,children:t?(0,r.k)():(0,d.S)({width:16,height:16})})}renderMobileForwardButton(){const e=!f.vy(this.environment);return(0,C.jsx)(y.Z,{onClick:this.handleForwardClick,className:"notion-history-forward-button",disabled:e,mobileFeedback:!0,disabledFeedback:!0,style:T,children:(0,c.s)({width:16,height:16})})}}Z.displayName="TopbarBrowserButtons";const I=Z;function P(){g.openInNewTab({url:"",makeTabActive:!0,position:"start"})}function B(){window.__c={n:"NewTabButtonComponent"};const e=(0,o.Fy)();return(0,s.VK)((()=>S.Z.state.isTabsFeatureEnabled),[])?(0,C.jsx)(j.Z,{renderTooltip:()=>(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)(p.FormattedMessage,{id:"topbarBrowserHistoryButton.newTabButton.label",defaultMessage:"New tab"}),(0,C.jsx)(k.Z,{name:"newTab",style:{opacity:.5,marginLeft:4}})]}),placement:j.Z.Placement.Bottom,alignment:j.Z.Alignment.Center,originGap:6,render:t=>(0,C.jsx)(M.Z,{icon:e=>(0,u.K)({...e,width:"24px",height:"24px"}),isDarkIconColor:!0,className:"notion-new-tab-button",style:{position:"relative",...(0,b.X)({noDrag:e.isElectronMac})},onClick:P,...t})}):null}},79075:(e,t,n)=>{n.d(t,{Z:()=>y});n(67294);var i=n(83355),o=n(8848),s=n(47560),r=n(68939),a=n(7476),l=n(34047),d=n(43250),c=n(34700),u=n(33929),p=n(74948),h=n(24646),g=n(36391),m=n(88923),v=n(73063),b=n(26388),f=n(85893);const S=(0,r.defineMessages)({updates:{id:"topbar.commentsButton.title",defaultMessage:"Comments"}});class x extends i.Z{constructor(){super(...arguments),this.hasUnreadCommentsStore=this.createComputedStore((()=>(0,l.DF)({blockStore:this.props.blockStore,ignoreAfterTime:Date.now()}).some((e=>!e.getResolved()&&(0,l.NI)(e).some((t=>a.t({discussionStore:e,commentStore:t})))))),!1),this.handleClickSidebar=()=>{p.handleSidebarButtonClick(this.environment,this.props.blockStore,g.gY.Comments,"topbar")}}renderComponent(){const e=u.default.getIntl(),t=h.vK(this.environment)?(0,f.jsx)("div",{style:{textAlign:"center"},children:(0,f.jsx)(r.FormattedMessage,{defaultMessage:"Close all comments",id:"topbar.commentsButton.closeSidebartTooltip"})}):(0,f.jsx)("div",{style:{textAlign:"center"},children:(0,f.jsx)(r.FormattedMessage,{defaultMessage:"View all comments",id:"topbar.commentsButton.openSidebartTooltip"})});return(0,f.jsx)(b.Z,{placement:b.Z.Placement.Bottom,renderTooltip:()=>t,render:t=>(0,f.jsxs)("div",{style:{...(0,c.X)({noDrag:this.environment.device.isElectronMac}),position:"relative"},children:[(0,f.jsx)(v.Z,{...t,icon:s.o,iconStyle:{height:20,width:20,fill:this.theme.regularIconColor},onClick:this.handleClickSidebar,style:{width:33,height:28,marginRight:2},ariaLabel:e.formatMessage(S.updates),hovered:h.vK(this.environment)&&!m.default.state.open,className:d.p0b}),this.hasUnreadCommentsStore.state&&(0,f.jsx)("div",{style:{position:"absolute",top:1.8,right:5.5,height:11,width:11,border:`2px solid ${this.theme.whiteButtonBackground}`,borderRadius:12,background:o.ZP.red,pointerEvents:"none"}})]}),children:t})}}x.displayName="TopbarCommentsButton";const y=x},17169:(e,t,n)=>{n.d(t,{Z:()=>A});var i=n(67294),o=n(12183),s=n(480),r=n(86628),a=n(24405),l=n(27961),d=n(32056),c=n(68939),u=n(50906),p=n(47307),h=n(53323),g=n(34700),m=n(45023),v=n(87279),b=n(15517),f=n(88632),S=n(99757),x=n(38335),y=n(8848),M=n(80750),k=n(16402),w=n(85893);function j(e){window.__c={n:"ConnectionErrorIndicatorLabel"};const t=(0,x.f)(500);if(e.device.isMobile)return(0,M.l)({width:24,height:"100%"});if(void 0===e.error.approximateBackoffDelayEndTime)return(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Something's not right.",id:"connectionErrorIndicator.label.shortMessage"});const n=Math.floor((e.error.approximateBackoffDelayEndTime-t)/1e3);return n>0?(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Something's not right. Retrying in {numberOfSeconds}s…",values:{numberOfSeconds:n},id:"connectionErrorIndicator.label.retryingInSeconds"}):(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Something's not right. Retrying…",id:"connectionErrorIndicator.label.retrying"})}function C(e){window.__c={n:"ConnectionErrorIndicatorDetails"},(0,x.f)(1e4);const{startTime:t}=e,n=(0,k.IS)(t),o=(0,s.O7)();return(0,i.useEffect)((()=>{u.apd(o,{errorSinceMs:Date.now()-t})}),[o,t]),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.FormattedMessage,{defaultMessage:"{sinceSomeTimeAgo}, an error occurred saving your changes. We'll try again soon.",values:{sinceSomeTimeAgo:n},id:"connectionErrorIndicator.details.message"}),e.retryReason?(0,w.jsx)("div",{style:{marginTop:8,fontSize:12,color:y.ZP.whiteWithAlpha(.7),fontStyle:"italic"},children:(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Debug info: {debugInfo}",values:{debugInfo:e.retryReason},id:"connectionErrorIndicator.details.debugInfo"})}):void 0]})}var T=n(31945),Z=n(68785),I=n(78140),P=n(89728),B=n(26388);const _=e=>(0,w.jsx)(c.FormattedMessage,{defaultMessage:"You can no longer make edits: {errorMessage} {usageInfoMessage}",id:"connectionState.errorIndicator.cannotMakeEdits.detailedMessage",values:{errorMessage:e.errorMessage,usageInfoMessage:e.usageInfoMessage}}),F=e=>{window.__c={n:"ErrorIndicator"};const t=(0,a.Fg)(),n=(0,s.O7)(),o=(0,l.z)({marginLeft:6,width:14,height:14,fill:e.errorStateStyle.color}),r="transactionQueue"===e.type?e.message:void 0,d="lowStorage"===e.type?e.estimate:void 0;return(0,i.useEffect)((()=>{"transactionQueue"===e.type?u.sIE(n,{message:r}):"connection"===e.type?u.SLv(n):"lowStorage"===e.type&&u.zQ6(n,{estimate:d})}),[e.type,r,d,n]),(0,i.useEffect)((()=>{r&&p.showThrottledErrorMessage((0,w.jsx)(_,{errorMessage:r}))}),[r]),n.device.isMobile?(0,w.jsx)(T.ZP,{popupType:T.Z4.SlideUp,renderOrigin:t=>(0,w.jsx)(P.Z,{style:e.errorStateStyle,...t,children:e.indicatorText||o}),render:n=>{let{close:i}=n;return(0,w.jsx)(I.Z,{menuType:v.og.ActionSheet,children:(0,w.jsx)("div",{style:{padding:15,background:t.errorText,color:"white"},onClick:i,children:e.detailsText})})}}):(0,w.jsx)(B.Z,{renderTooltip:()=>(0,w.jsx)("div",{style:{width:320,whiteSpace:"normal"},children:e.detailsText}),render:t=>(0,w.jsxs)("div",{style:e.errorStateStyle,...t,children:[e.indicatorText,o]})})};function E(e){let{showLoadingSpinner:t}=e;window.__c={n:"MobileLoadingSpinner"};const n=(0,s.O7)(),i=(0,r.VK)((()=>{var e;return null===(e=n.mobileNative)||void 0===e?void 0:e.supportsNativeHomeOnPhone()}),[n]);return(0,w.jsx)("div",{style:{display:"flex",alignItems:"center",height:"100%",marginLeft:"auto",paddingLeft:!i||t?4:0,paddingRight:!i||t?8:0,visibility:t?"visible":"hidden"},children:(!i||t)&&(0,w.jsx)(Z.Z,{style:{height:18,width:18}})})}function R(e){return{display:"flex",alignItems:"center",marginRight:e?0:18,fontSize:e?12:14}}function L(e){let{isOnline:t,showLoadingSpinner:n}=e;window.__c={n:"DesktopIndicators"};const i=(0,c.useIntl)(),o=(0,s.Fy)(),r=(0,a.yK)((e=>({offlineBadge:{...(0,g.X)({noDrag:o.isElectronMac}),display:"flex",alignItems:"center",padding:"0px 6px",height:o.isMobile?20:24,borderRadius:4,marginRight:o.isMobile?4:18,whiteSpace:"nowrap",fontSize:o.isMobile?12:14,color:e.mediumTextColor,border:`1px solid ${e.darkDividerColor}`},loadingState:{...(0,g.X)({noDrag:o.isElectronMac}),...R(o.isMobile),color:e.lightTextColor}})),[o]);return t?n?(0,w.jsx)(B.Z,{renderTooltip:()=>(0,w.jsx)(c.FormattedMessage,{defaultMessage:"{percent} complete.",id:"connectionState.savePercentangeIndicator.tooltip",values:{percent:S.Z.percentComplete(i)}}),render:e=>(0,w.jsxs)("div",{style:r.loadingState,...e,children:[(0,w.jsx)(Z.Z,{style:{margin:4,marginRight:8}}),(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Saving…",id:"connectionState.saving.message"})]})}):null:(0,w.jsx)(B.Z,{renderTooltip:()=>(0,w.jsx)("div",{style:{width:200},children:(0,w.jsx)(c.FormattedMessage,{defaultMessage:"{numberOfEdits, plural, one {You have {numberOfEdits} edit that will be synced next time you are online.} other {You have {numberOfEdits} edits that will be synced next time you are online.}}",id:"connectionState.offlineBadge.tooltip",values:{numberOfEdits:S.Z.state.totalPending}})}),textWrap:!0,render:e=>(0,w.jsx)("div",{style:r.offlineBadge,...e,children:(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Offline",id:"connectionState.offlineBadge.label"})})})}function U(){window.__c={n:"ErrorMessages"};const e=(0,s.Fy)(),t=(0,r.VK)((()=>S.Z.state.transactionQueueError),[]),n=(0,r.VK)((()=>S.Z.state.storageUsageEstimate),[]),o=(0,c.useIntl)(),l=(0,a.yK)((t=>({errorState:{...(0,g.X)({noDrag:e.isElectronMac}),...R(e.isMobile),whiteSpace:"nowrap",color:t.errorText}})),[e]),u=(0,r.VK)((()=>(0,h.L)()),[]),p=()=>{if(n){const e=n.usage/n.quota;return(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Notion is using {percentageOfStorageBytesUsed} of its available storage on your device ({usedNumberOfBytes} of {totalNumberOfBytes}).",id:"connectionState.errorIndicator.possibleLostEdits.detailedMessagePart1",values:{usedNumberOfBytes:(0,d.uf)(n.usage,"bytes",o),totalNumberOfBytes:(0,d.uf)(n.quota,"bytes",o),percentageOfStorageBytesUsed:o.formatNumber(e,{style:"percent",maximumFractionDigits:2})}})}};if(t){const e=(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Cannot save changes",id:"connectionState.errorIndicator.cannotSaveChanges.message"}),n=(0,w.jsx)(_,{errorMessage:t.message,usageInfoMessage:p()});return(0,w.jsx)(F,{type:"transactionQueue",message:t.message,indicatorText:e,detailsText:n,errorStateStyle:l.errorState})}if(void 0!==n&&!(0,b.mn)(n)){const t=e.isBrowser?(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Low browser storage",id:"connectionState.errorIndicator.lowStorageOnWebApp.message"}):e.isMobileNative?(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Low app storage",id:"connectionState.errorIndicator.lowStorageOnMobileApp.message"}):(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Low disk space",id:"connectionState.errorIndicator.lowStorageOnDesktopApp.message"});return(0,w.jsx)(F,{type:"lowStorage",estimate:n,indicatorText:t,detailsText:(0,w.jsxs)(i.Fragment,{children:[p()," ",(0,w.jsx)(c.FormattedMessage,{id:"connectionState.errorIndicator.possibleLostEdits.detailedMessagePart2",defaultMessage:"You may lose changes made while offline. Try closing and re-opening your app, and contact support if that doesn’t fix the issue."})]}),errorStateStyle:l.errorState})}return u?(0,w.jsx)(F,{type:"connection",indicatorText:(0,w.jsx)(j,{error:u,device:e}),detailsText:(0,w.jsx)(C,{...u}),errorStateStyle:l.errorState}):null}const A=function(){window.__c={n:"TopbarConnectionIndicator"};const e=(0,r.VK)((()=>f.Z.state.online),[]),t=(0,r.VK)((()=>!S.n.state),[]),n=function(){const e=(0,i.useRef)(!1),[t,n]=(0,i.useState)(!1),s=(0,o.v)((()=>{f.Z.state.syncing&&!e.current&&(e.current=!0,n(!0))}),8e3),r=(0,o.v)((()=>{e.current&&!f.Z.state.syncing&&(e.current=!1,n(!1))}),200);return(0,i.useEffect)((()=>(f.Z.addListener(s),f.Z.addListener(r),()=>{f.Z.removeListener(s),f.Z.removeListener(r)})),[s,r]),e.current}(),a=function(e,t){const n=(0,s.O7)(),[o,r]=(0,i.useState)(!1),a=(0,i.useCallback)((i=>{(0,m.Z)(n,i,"command+s")&&(i.preventDefault(),e&&!o&&t&&(r(!0),setTimeout((()=>{r(!1)}),500)))}),[n,o,t,e]);return(0,i.useEffect)((()=>(window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)})),[a]),o}(e,t),l=(0,s.Fy)(),d=(0,r.VK)((()=>!(0,h.n)()),[]),c=(a||n)&&t&&d;return(0,w.jsxs)(w.Fragment,{children:[l.isMobile?(0,w.jsx)(E,{showLoadingSpinner:c}):(0,w.jsx)(L,{isOnline:e,showLoadingSpinner:c}),(0,w.jsx)(U,{})]})}},96677:(e,t,n)=>{n.d(t,{Z:()=>M});n(67294);var i=n(83355),o=n(24405),s=n(18387),r=n(52926),a=n(68939),l=n(50906),d=n(24677),c=n(39699),u=n(43250),p=n(34700),h=n(92783),g=n(33929),m=n(74948),v=n(73063),b=n(58261),f=n(26388),S=n(85893);const x=(0,a.defineMessages)({isBookmarkedMessage:{defaultMessage:"Favorited",id:"topbar.favoriteButton.activeTitle"},isNotBookmarkedMessage:{defaultMessage:"Favorite",id:"topbar.favoriteButton.title"},isBookmarkedTooltip:{defaultMessage:"Remove from your favorites",id:"topbar.favoriteButton.activeTooltip1"},isNotBookmarkedTooltip:{defaultMessage:"Add to your favorites",id:"topbar.favoriteButton.tooltip1"}});class y extends i.Z{constructor(){super(...arguments),this.handleBookmarkClick=()=>{const{spaceViewStore:e}=this.props;e&&(d.ZH(this.environment),l.V0c(this.environment,{from:"topbar"}),c.createAndCommit({userAction:"TopbarFavoriteButton.handleBookmarkClick",environment:this.environment,perform:t=>{m.bookmarkPage({spaceViewStore:e,store:this.props.store,transaction:t})}}))},this.handleUnbookmarkClick=()=>{const{spaceViewStore:e}=this.props;e&&(d.ZH(this.environment),l.P9p(this.environment,{from:"topbar"}),c.createAndCommit({userAction:"TopbarFavoriteButton.handleUnbookmarkClick",environment:this.environment,perform:t=>{m.unbookmarkPage({spaceViewStore:e,store:this.props.store,transaction:t})}}))}}renderComponent(){const e=g.default.getIntl(),{spaceViewStore:t}=this.props,n=!!t&&(0,h.Z)({spaceViewStore:t,pageId:this.props.store.id}),i=n?r.b:s.A,o=n?this.handleUnbookmarkClick:this.handleBookmarkClick;return(0,S.jsx)(f.Z,{placement:f.Z.Placement.Bottom,renderTooltip:()=>(0,S.jsx)(k,{isBookmarked:n}),render:t=>(0,S.jsx)(v.Z,{...t,className:u.GbT,icon:i,style:{...(0,p.X)({noDrag:this.environment.device.isElectronMac}),width:33,height:28,marginRight:2},iconStyle:{height:20,width:20,fill:n?this.theme.topbarFavorite:this.theme.regularIconColor},onClick:o,ariaLabel:e.formatMessage(n?x.isBookmarkedMessage:x.isNotBookmarkedMessage)})})}}y.displayName="TopbarFavoriteButton";const M=y;function k(e){let{isBookmarked:t}=e;window.__c={n:"TooltipMessageComponent"};const n=(0,o.Fg)();return(0,S.jsxs)("div",{style:{textAlign:"center"},children:[(0,S.jsx)("div",{children:(0,S.jsx)(a.FormattedMessage,{...t?x.isBookmarkedTooltip:x.isNotBookmarkedTooltip})}),(0,S.jsx)(b.Z,{style:{color:n.mediumInvertedTextColor},name:"toggleFavorite"})]})}},10137:(e,t,n)=>{n.d(t,{Z:()=>C});n(67294);var i=n(73935),o=n(83355),s=n(56666),r=n(30681),a=n(68939),l=n(50906),d=n(24677),c=n(43250),u=n(34700),p=n(98742),h=n(35328),g=n(77907),m=n(80444),v=n(21884),b=n(64921),f=n(31945),S=n(26388),x=n(28451),y=n(81415),M=n(71424),k=n(85893);function w(e){return(0,k.jsx)(x.P,{calloutId:"wiki_promo",children:(0,k.jsx)(y.U,{origin:()=>e.origin,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{v.E.setState({showConvertTooltip:!1,forceShow:!1})},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:M.G5}})})}class j extends o.Z{constructor(){super(...arguments),this.originEl=null,this.onClickOriginRect=void 0,this.renderOrigin=e=>{const{device:t}=this.environment;return(0,k.jsx)(S.Z,{renderTooltip:()=>this.environment.currentUser.isLoggedIn()?(0,k.jsx)(a.FormattedMessage,{defaultMessage:"Style, export, and more…",id:"topbarMoreButton.tooltip"}):(0,k.jsx)(a.FormattedMessage,{defaultMessage:"More…",id:"topbarMoreButton.loggedOut.tooltip"}),placement:S.Z.Placement.Bottom,delayThreshold:400,render:n=>(0,k.jsx)(b.Z,{ref:this.handleButtonMount,style:T(this.environment),mobileFeedback:t.isMobile,className:c.mSZ,...(0,p.Z)(e,n),children:t.isMobile?(0,r.I)({width:26}):(0,s.o)({width:18,height:18,fill:this.theme.regularIconColor})})})},this.handleButtonMount=e=>{e&&(this.originEl=i.findDOMNode(e))},this.handleClick=()=>{v.E.setState({showConvertTooltip:!1,forceShow:!1}),d.ZH(this.environment),this.originEl&&(this.onClickOriginRect=this.originEl.getBoundingClientRect()),l.kq7(this.environment)},this.handleDismiss=()=>{this.props.buttonPopupStore.setState({...this.props.buttonPopupStore.state,open:!1})},this.handleAccept=e=>{const{mainEditorCurrentBlockStore:t}=m.default.state;if(t){const n=t.getType();n&&l.dhV(this.environment,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:t.id,block_type:n,is_toggleable:(0,h._A)(n,t.getFormat())})}e.closeParentMenu&&this.handleDismiss()}}renderComponent(){const{device:e}=this.environment,t=v.E.state.showConvertTooltip;return(0,k.jsxs)(k.Fragment,{children:[t?(0,k.jsx)(w,{origin:this.originEl}):null,(0,k.jsx)(f.ZP,{popupType:e.isMobile?f.Z4.SlideUp:f.Z4.Popup,buttonPopupStore:this.props.buttonPopupStore,renderOrigin:this.renderOrigin,onClick:this.handleClick,render:()=>(0,k.jsx)(g.LazyTopbarMoreMenu,{blockStore:this.props.store,onClickOriginRect:this.onClickOriginRect,handleAccept:this.handleAccept,handleDismiss:this.handleDismiss}),originGap:8,trapFocus:!0,forceInitialInbound:!0,style:e.isMobile?{}:{width:240,maxHeight:"80vh"}})]})}}j.displayName="TopbarMoreButton";const C=j;function T(e){const{device:t}=e;return t.isMobile?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",paddingLeft:8,paddingRight:8,marginRight:2}:{...(0,u.X)({noDrag:e.device.isElectronMac}),display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}}},63437:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var i=n(24405),o=n(85893);const s=function(){window.__c={n:"TopbarPeekControlsSeparator"};const e=(0,i.yK)((e=>({separator:{height:14,width:1,marginLeft:6,marginRight:6,background:e.darkDividerColor}})),[]);return(0,o.jsx)("div",{style:e.separator})}},67485:(e,t,n)=>{n.d(t,{Z:()=>P});n(57658),n(67294);var i=n(83355),o=n(13991),s=n(480),r=n(86628),a=n(24405),l=n(7057),d=n(72126),c=n(19889),u=n(7928),p=n(68939),h=n(61045),g=n(34700),m=n(20095),v=n(51757),b=n(64921),f=n(26388),S=n(64369),x=n(29302),y=n(45653),M=n(44615),k=n(25320),w=n(2688),j=n(5315);class C extends i.Z{constructor(){super(...arguments),this.messageStoreListenerReference=void 0}UNSAFE_willMount(){this.startMessageStoreListener()}willUnmount(){this.stopMessageStoreListener()}didUpdate(){this.stopMessageStoreListener(),this.startMessageStoreListener()}async startMessageStoreListener(){const{block:e}=this.props;if(await j.transactionQueue.awaitRecordTransaction(e.pointer),!this.componentIsMounted)return;const t=(0,M.pb)(e.id);this.messageStoreListenerReference=w.Z.addListener(t,d.P2((()=>k.Ri(this.environment,{block:this.props.block,pageVisitStore:this.props.pageVisitStore,incremental:!0,limit:this.props.limit})),1e3),void 0,this.environment)}stopMessageStoreListener(){this.messageStoreListenerReference&&(w.Z.removeListener(this.messageStoreListenerReference,this.environment),this.messageStoreListenerReference=void 0)}}C.displayName="PageVisitListener";const T=C;var Z=n(85893);class I extends i.Z{constructor(){super(...arguments),this.renderAvatar=e=>{const{userId:t}=e,n=(0,m.MR)(this.environment,e),i=F(t,this.props.rootStore);if(!i.isDefined()||i.getIsSuspended())return;const o={transition:"all 0.2s ease",transform:"scale(1)"},s={transform:"scale(1.15)",background:"none"},r={transform:"scale(0.9)",background:"none"},a={width:23,height:23,borderRadius:23,marginRight:-5,position:"relative"};return(0,Z.jsx)(f.Z,{textWrap:!0,renderTooltip:()=>(0,Z.jsx)(R,{rootStore:this.props.rootStore,userData:e,isPresent:n}),render:t=>{const l=(0,Z.jsx)(y.Z,{userStore:i,style:a,isOffline:!n,size:23,avatarShouldShowShadow:!0});if(n&&e.blockId){const n=e.blockId;return(0,Z.jsx)(b.Z,{...t,onClick:()=>h.hl([n],!0),style:o,hoveredStyle:s,pressedStyle:r,children:l})}return(0,Z.jsx)("div",{...t,children:l})}},t)},this.renderStateStore=this.createComputedStore((()=>{const{pageVisitStore:e,presenceStore:t}=this.props,n=(0,m.AQ)(e,t),i=this.environment.currentUser.id;if(!i)return;const o=F(i,this.props.rootStore),s=n.find((e=>e.userId===i));if(!s||!o.isDefined())return;let r=n.filter((e=>e.userId!==i&&(0,m.MR)(this.environment,e)));r=B(r).reverse();const a=B(d.e5(n,r,[s])).reverse(),l=[...r,...a],c=_(this.props.maxUsers)-1;return{visibleUsers:l.slice(0,c),hiddenUsers:l.slice(c)}}),!0)}renderComponent(){return(0,Z.jsxs)(Z.Fragment,{children:[this.renderPresence(),(0,Z.jsx)(T,{block:this.props.rootStore,pageVisitStore:this.props.pageVisitStore,limit:1+_(this.props.maxUsers)+25})]})}renderPresence(){const e=this.environment.currentUser.id;if(!e)return;const t=this.renderStateStore.state;if(!t)return;const{visibleUsers:n,hiddenUsers:i}=t;var o;if([e,...n.map((e=>e.userId)),...i.map((e=>e.userId))].map((e=>F(e,this.props.rootStore))).every((e=>e.isReady()))&&(n.length>0||i.length>0)){const t=[...n];return t.reverse(),(0,Z.jsxs)("div",{style:(o=this.environment,{...(0,g.X)({noDrag:o.device.isElectronMac}),display:"flex",alignItems:"center",position:"relative",flexDirection:"row-reverse",marginLeft:9,marginTop:-2,transform:"translateZ(0)"}),children:[i.length>0&&this.renderHiddenUsers(i),t.map(this.renderAvatar),this.renderAvatar({userId:e,present:!0})]})}}renderHiddenUsers(e){return(0,Z.jsx)(f.Z,{allowHover:!0,originGap:7,renderTooltip:t=>{const n=[],i=[];for(const s of e)(0,m.MR)(this.environment,s)?n.push(s):i.push(s);const o=i.slice(0,25-n.length);return(0,Z.jsxs)("div",{...t,children:[n.length>0&&(0,Z.jsxs)("div",{style:{marginBottom:4},children:[(0,Z.jsx)(S.Z,{style:E(this.theme),children:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Viewing now",id:"topbar.presenceIndicator.hiddenUsers.viewingNow.tooltip"})}),n.map(((e,t)=>(0,Z.jsx)(L,{userData:e,index:t,rootStore:this.props.rootStore},t)))]}),o.length>0&&(0,Z.jsxs)("div",{style:{marginBottom:4},children:[(0,Z.jsx)(S.Z,{style:{...E(this.theme)},children:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Last viewed by",id:"topbar.presenceIndicator.hiddenUsers.lastViewedBy.tooltip"})}),o.map(((e,t)=>(0,Z.jsx)(L,{userData:e,index:t,rootStore:this.props.rootStore},t)))]}),i.length>o.length&&(0,Z.jsx)("div",{style:{marginLeft:2,marginTop:2,color:this.theme.mediumInvertedTextColor},children:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"{notViewingMoreUsersCount} more…",id:"topbarPresence.presenceIndicator.hiddenUsers.moreUsersNotViewing.tooltip",values:{notViewingMoreUsersCount:i.length-o.length}})})]})},render:t=>(0,Z.jsx)("div",{style:{color:this.theme.mediumTextColor,fontSize:14,marginLeft:10,marginRight:-5,whiteSpace:"nowrap"},...t,children:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"{hiddenUsersCount, plural, one {+{hiddenUsersCount}} other {+{hiddenUsersCount}}}",id:"topbar.presenceIndicator.hiddenUsers.otherCount.message",values:{hiddenUsersCount:e.length}})})})}}I.displayName="TopbarPresence";const P=I;function B(e){return d.MR(e,(e=>e.activityTimestampNearestMinuteMs))}function _(e){return e??5}function F(e,t){return v.U6.createChildStore(t,{table:c.KJ,id:e})}function E(e){return{color:e.mediumInvertedTextColor,fontSize:10,textTransform:"uppercase",letterSpacing:"0.015em"}}function R(e){let{userData:t,isPresent:n,rootStore:i}=e;window.__c={n:"AvatarTooltipComponent"};const d=(0,a.Fg)(),c=(0,s.O7)(),h=(0,p.useIntl)(),g=c.currentUser.id,m=(0,r.VK)((()=>F(t.userId,i)),[t,i]),v=(0,r.VK)((()=>(0,u.Nz)(h,m.getModel())),[h,m]),b=(0,r.VK)((()=>m.getEmail()),[m]);if(!m.isDefined())return null;let f;return n?g!==m.id&&(f=t.blockId?(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Viewing now. Click to see where they are.",id:"topbar.presenceIndicator.viewingNowWithLocation.tooltip"}):(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Viewing now",id:"topbar.presenceIndicator.viewingNow.tooltip"})):g!==m.id&&t.activityTimestampNearestMinuteMs&&(f=(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Last viewed {timeFromNow}",id:"topbar.presenceIndicator.lastViewedTime.tooltip",values:{timeFromNow:(0,l.tv)(Math.min(t.activityTimestampNearestMinuteMs,Date.now()),o.SP)}})),(0,Z.jsxs)("div",{children:[(0,Z.jsx)("div",{className:"notranslate",children:v}),(0,Z.jsx)("div",{style:{fontWeight:400},children:b}),f&&(0,Z.jsx)("div",{style:{color:d.mediumInvertedTextColor,minWidth:150,paddingTop:2,paddingBottom:2,lineHeight:1.3},children:f})]})}function L(e){let{userData:t,index:n,rootStore:i}=e;window.__c={n:"HiddenUsersTooltipItemComponent"};const d=(0,a.Fg)(),c=(0,s.O7)(),u=(0,m.MR)(c,t),p=(0,r.VK)((()=>F(t.userId,i)),[t,i]);if(!p.isDefined)return null;let g;!u&&t.activityTimestampNearestMinuteMs&&(g=(0,l.tv)(t.activityTimestampNearestMinuteMs,o.SP));const v=(0,Z.jsxs)("div",{style:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},children:[(0,Z.jsx)(x.Z,{userStore:p,avatarSize:18,style:{flexGrow:1}}),(0,Z.jsx)("div",{style:{marginLeft:"auto",paddingLeft:12,textAlign:"right",flexShrink:1,color:d.mediumInvertedTextColor},children:g})]});if(u&&t.blockId){const e=t.blockId;return(0,Z.jsx)(b.Z,{onClick:()=>h.hl([e],!0),style:{display:"flex",alignItems:"center"},children:v})}return(0,Z.jsx)("div",{style:{display:"flex",alignItems:"center"},children:v})}},12253:(e,t,n)=>{n.d(t,{Z:()=>u});n(67294);var i=n(480),o=n(24405),s=n(61061),r=n(68939),a=n(34700),l=n(89728),d=n(26388),c=n(85893);const u=function(e){window.__c={n:"TopbarRestrictedBadge"};const t=(0,o.Fg)(),n=(0,i.O7)(),{device:u}=n;return(0,c.jsx)(d.Z,{placement:d.Z.Placement.Bottom,renderTooltip:()=>(0,c.jsxs)("div",{style:{...(0,a.X)({noDrag:n.device.isElectronMac}),textAlign:"center"},children:[(0,c.jsx)(r.FormattedMessage,{defaultMessage:"Access restricted from parent page",id:"blockAuthorInfo.restrictedBadge.infoText"}),(0,c.jsx)("br",{}),(0,c.jsx)("span",{style:{color:t.mediumInvertedTextColor},children:(0,c.jsx)(r.FormattedMessage,{defaultMessage:"Click to view access",id:"blockAuthorInfo.restrictedBadge.clickText"})})]}),render:n=>(0,c.jsxs)(l.Z,{onClick:e.onClick,style:{marginRight:u.isMobile?4:2,color:t.lightTextColor,fill:t.lightIconColor},...n,children:[(0,s.B)({width:20,marginRight:4,fill:t.lightIconColor}),(0,c.jsx)("div",{style:{color:t.lightTextColor,fontSize:u.isMobile?16:14,lineHeight:u.isAndroid?1.5:1,whiteSpace:"nowrap"},children:(0,c.jsx)(r.FormattedMessage,{id:"blockAuthorInfo.restrictedBadge",defaultMessage:"Restricted"})})]})})}},19368:(e,t,n)=>{n.d(t,{Z:()=>V});var i=n(67294),o=n(83355),s=n(15769),r=n(43876),a=n(63143),l=n(68939),d=n(24677),c=n(28040),u=n(37181),p=n(43250),h=n(34700),g=n(98742),m=n(45101),v=n(77907),b=n(57345),f=n(4023),S=n(80444),x=n(77080),y=n(55899),M=n(78291),k=n(8675),w=n(52878),j=n(34583),C=n(88893),T=n(31945),Z=n(58261),I=n(89728),P=n(53437),B=n(26388),_=n(24405),F=n(8848),E=n(13148),R=n(23063),L=n(73063),U=n(28451),A=n(85893);function O(e){window.__c={n:"ShareButtonIntroTooltip"};const{visible:t,onDismiss:n}=e,i=(0,_.yK)((e=>({overlayContainer:{position:"relative",width:240,height:140,paddingTop:0,paddingBottom:20,paddingLeft:20,paddingRight:20},container:{fontSize:12,color:F.ZP.white,position:"absolute",top:13,background:F.ZP.blue,borderRadius:6,padding:"8px 12px 12px 12px",width:200,boxShadow:e.largeLightBoxShadow,zIndex:9999},circle:{position:"absolute",top:-12,left:"calc(50% - 2.5px)",background:F.ZP.blue,width:5,height:5,borderRadius:5,boxShadow:`0 0 0 1.5px ${e.contentBackground}`},verticalLine:{position:"absolute",top:-12,left:"calc(50% - 1px)",background:F.ZP.blue,width:2,height:12},textContainer:{width:"90%",fontWeight:500},iconButton:{position:"absolute",top:4,right:4,opacity:.8},iconStyle:{width:12,fill:F.ZP.white}})),[]);return(0,A.jsx)("div",{style:i.overlayContainer,children:(0,A.jsx)(R.Z,{isVisible:t,animationStyle:{opacity:1},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:function(){return(0,A.jsx)(U.P,{calloutId:"share_button_tooltip",children:(0,A.jsxs)("div",{style:i.container,children:[(0,A.jsx)("div",{style:i.circle}),(0,A.jsx)("div",{style:i.verticalLine}),(0,A.jsx)("div",{style:i.textContainer,children:(0,A.jsx)(l.FormattedMessage,{defaultMessage:"You can share your content with your teammates here",id:"shareButtonIntroTooltip.title"})}),(0,A.jsx)(L.Z,{icon:E.U,style:i.iconButton,iconStyle:i.iconStyle,onClick:()=>n()})]})})}})})}class D extends o.Z{constructor(){super(...arguments),this.storeTypes={universalMemberInviteStore:w.Z,sudoModeStore:k.Z,inviteTargetsStore:y.ZP},this.showShareButtonTooltip=this.createComputedStore((()=>function(e){const{currentUserSettingsStore:t,mainEditorCurrentBlockStore:n,inAppCalloutStore:i}=S.default.state;if(null!=n&&n.isTypedCollectionViewBlock())return!1;if(!t)return!1;if(t.id!==e.currentUser.id)return!1;const o=t.getKeyStore("settings").getKeyStore("seen_share_button_tooltip_at").getValue();if(Boolean(o))return!1;const s=t.getKeyStore("settings").getKeyStore("signup_time").getValue();if(!s)return!1;if(!i.canShow("share_button_tooltip"))return!1;const r=Date.now()-s;if(r<=30*a.A0){switch(x.default.getEligibleGroup({experimentId:"intro_share_tooltip_condition",defaultGroup:"control"})){case"b200":const{data:t}=M.default.state;if(t){return(0,C.Lz)(e,t)>=200}return!1;case"d3":return r>=3*a.A0;case"control":return r>=10*a.A0}}return!1}(this.environment))),this.buttonPopupStyle=this.createComputedStore((()=>{const{device:e}=this.environment;return e.isMobile?{width:460}:{width:500,overflow:"hidden"}})),this.shareButtonStyle=this.createComputedStore((()=>{const{device:e}=this.environment;return e.isMobile?{display:"flex",alignItems:"center",height:"100%",paddingLeft:8,paddingRight:8}:{...(0,h.X)({noDrag:e.isElectronMac}),marginRight:2,marginLeft:12}})),this.shareButtonRef=i.createRef(),this.renderShareButtonOrigin=e=>{const{device:t}=this.environment;return(0,A.jsx)(B.Z,{disableTooltip:t.isMobile,renderTooltip:()=>(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("div",{children:(0,A.jsx)(l.FormattedMessage,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,A.jsx)(Z.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"openShareMenu"})]}),placement:B.Z.Placement.Bottom,delayThreshold:400,render:t=>this.renderShareButton((0,g.Z)(e,t))})},this.renderShareButton=e=>{const{device:t}=this.environment,n=this.showShareButtonTooltip.state,i=t.isMobile?t.isAndroid?(0,s.Q)({width:16,height:16}):(0,r.s)({width:26}):(0,A.jsx)(l.FormattedMessage,{defaultMessage:"Share",id:"topbar.shareButton.title"}),o=(0,A.jsx)("div",{ref:this.shareButtonRef,children:(0,A.jsx)(I.Z,{className:p.MD7,...(0,g.Z)(e,{onClick:n?()=>u.Qm(this.environment):()=>{}}),mobileFeedback:t.isMobile,style:this.shareButtonStyle.state,children:i})});return n?(0,A.jsx)(P.ZP,{popupType:P.kQ.Popup,open:!0,origin:o,placementToOrigin:f.u.Bottom,alignmentToOrigin:P.ZP.Alignment.Center,preventScaleTransition:!0,preventOpacityTransition:!0,viewportPadding:4,preventCaptureEsc:!0,preventPointerEvents:!1,disableMouseCapture:!0,render:()=>this.showShareButtonTooltip.state?(0,A.jsx)(O,{visible:this.showShareButtonTooltip.state,onDismiss:()=>u.Qm(this.environment)}):null,style:{boxShadow:"none",backgroundColor:"rgba(0, 0, 0, 0)"}}):o},this.getBlockStoreForPermissionsSettings=()=>this.stores.sudoModeStore.shouldUserHaveAccessToPrivatePageBlock()&&this.stores.sudoModeStore.state.changePermissionsEnabled&&this.stores.sudoModeStore.state.privatePageStore?this.stores.sudoModeStore.state.privatePageStore:this.props.store,this.handleClick=()=>{this.resetStores(),d.ZH(this.environment),b.lG(this.environment),j.bi(this.environment)},this.handleClose=async()=>{if(this.stores.inviteTargetsStore.state.inviteTargets.length>0){return void(await b.zd({environment:this.environment,inviteTargetsStore:this.stores.inviteTargetsStore})&&(b.a6(this.environment),this.resetStores()))}const{permissionsInviteStore:e}=this.stores.universalMemberInviteStore.state;"invitee"===e.state.inputFocus&&e.setState({...e.state,inputFocus:"none"});await(0,m.Aw)({environment:this.environment,permissionsInviteStoreState:e.state,from:"share_menu"})||(b.a6(this.environment),this.resetStores())},this.resetStores=()=>{this.props.buttonPopupStore.reset(),this.stores.universalMemberInviteStore.reset(),this.stores.inviteTargetsStore.reset()},this.hasInviteTargets=()=>{const{universalMemberInviteStore:e,inviteTargetsStore:t}=this.stores,{permissionsInviteStore:n}=e.state;return n.state.inviteTargets.length>0||t.state.inviteTargets.length>0}}didMountOrUpdate(){this.props.store.canAdmin()?this.stores.sudoModeStore.reset():c.i({environment:this.environment,sudoModeStore:this.stores.sudoModeStore,pageBlockId:this.props.store.id})}renderComponent(){const{device:e}=this.environment;return(0,A.jsx)(T.ZP,{popupType:e.isMobile?T.Z4.SlideUp:T.Z4.Popup,forceInitialInbound:!0,buttonPopupStore:this.props.buttonPopupStore,renderOrigin:this.renderShareButtonOrigin,originGap:e.isMobile?void 0:8,style:this.buttonPopupStyle.state,onClick:this.handleClick,render:()=>(0,A.jsx)(v.LazyShareMenuContainer,{buttonPopupStore:this.props.buttonPopupStore,sudoModeStore:this.stores.sudoModeStore,store:this.getBlockStoreForPermissionsSettings(),inviteTargetsStore:this.stores.inviteTargetsStore,onUpgradeButtonClick:()=>{this.props.buttonPopupStore.reset()},location:e.isMobile?"topbar_mobile":"topbar_share_button",onClose:this.handleClose}),persistOnClose:!e.isMobile&&this.hasInviteTargets(),onDismiss:this.handleClose,onClose:this.handleClose})}}D.displayName="TopbarShareButton";const V=D},75272:(e,t,n)=>{n.d(t,{Z:()=>y});n(67294);var i=n(480),o=n(86628),s=n(24405),r=n(7525),a=n(63261),l=n(68939),d=n(43250),c=n(34700),u=n(12534),p=n(74948),h=n(38676),g=n(23063),m=n(73063),v=n(58261),b=n(26388),f=n(39849),S=n(92955),x=n(85893);function y(){window.__c={n:"TopbarSidebarButton"};const e=(0,i.O7)(),t=(0,i.Fy)(),n=(0,l.useIntl)(),y=(0,o.VK)((()=>h.sidebarOpenStore.state),[]),M=(0,s.yK)((e=>({root:{...(0,c.X)({noDrag:t.isElectronMac}),flexShrink:0,width:48,height:48,margin:-12,padding:12,marginRight:-6},button:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4},buttonWrapper:{position:"absolute",top:0,left:0,willChange:"opacity"},svg:{width:16,height:16,fill:e.regularIconColor},keyboardShortcut:{color:e.mediumInvertedTextColor}})),[t.isElectronMac]),k=e=>{(0,u.ZP)({event:e,context:u.Af.SidebarMouseMove,callback:()=>{const t=e.currentTarget.getBoundingClientRect();h.sidebarMousePeekXStore.setState(t.right),p.open()}})},w=n.formatMessage({defaultMessage:"Lock sidebar open",id:"sidebarExpandButton.tooltip"});return(0,x.jsx)("div",{style:M.root,onMouseEnter:k,onMouseMove:k,children:(0,x.jsxs)("div",{style:{position:"relative"},children:[(0,x.jsx)(g.Z,{isVisible:!0,animationStyle:{opacity:y?0:1},render:()=>(0,x.jsx)("div",{style:M.buttonWrapper,children:(0,x.jsxs)("div",{style:M.button,children:[(0,a._)(M.svg),(0,x.jsx)(S.Z,{type:"allSpaces",color:f.Z.Color.Red,style:{position:"absolute",top:-1,right:-4}})]})})}),(0,x.jsx)(g.Z,{isVisible:!0,animationStyle:{opacity:y?1:0},render:()=>(0,x.jsx)("div",{style:M.buttonWrapper,children:(0,x.jsx)(b.Z,{renderTooltip:()=>(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{children:w}),(0,x.jsx)(v.Z,{style:M.keyboardShortcut,name:"toggleSidebar"})]}),placement:b.Z.Placement.Right,alignment:b.Z.Alignment.Start,delayThreshold:0,originGap:6,render:t=>(0,x.jsx)(m.Z,{ariaLabel:w,icon:r.t,style:{position:"relative"},iconStyle:{width:16,height:16},isDarkIconColor:!0,onClick:()=>p.setExpand({environment:e,isExpanded:!0,from:"topbar_sidebar_button"}),className:d.exn,...t})})})})]})})}},29538:(e,t,n)=>{n.d(t,{C:()=>y,V:()=>x});n(67294);var i=n(480),o=n(86628),s=n(24405),r=n(97439),a=n(68939),l=n(28020),d=n(43250),c=n(34700),u=n(74948),p=n(38676),h=n(24042),g=n(45325),m=n(23063),v=n(73063),b=n(58261),f=n(26388),S=n(85893);function x(e){let{}=e;window.__c={n:"TopbarSidebarUnexpandButton"};const t=(0,i.O7)(),n=(0,i.Fy)(),s=(0,a.useIntl)(),d=(0,o.VK)((()=>!p.sidebarMouseEnteredStore.state),[]),c=(0,o.VK)((()=>h.Z.state.isShowingTabBar||!1),[]),m=(0,o.VK)((()=>l.tu.state),[]),v=s.formatMessage({defaultMessage:"Close sidebar",id:"sidebarUnexpandButton.closeSidebar.tooltip"});return(0,S.jsx)(y,{shouldHide:n.isElectronMac&&m||c||d,icon:r.D,caption:v,onClick:()=>{u.setExpand({environment:t,isExpanded:!1,from:"topbar_sidebar_unexpand_button"}),g.default.isOpen()&&u.close()},keyboardShortcutName:"toggleSidebar",isElectron:n.isElectron})}function y(e){window.__c={n:"TopbarUnexpandButton"};const t=(0,i.Fy)(),n=(0,s.yK)((e=>({keyboardShortcut:{color:e.mediumInvertedTextColor}})),[]),o=e.isElectron&&!e.shouldHide?1:0,r=e.shouldHide?0:1,a=e.keyboardShortcutName;return(0,S.jsx)(f.Z,{disableTooltip:e.shouldHide,renderTooltip:()=>(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{children:e.caption}),a&&(0,S.jsx)(b.Z,{style:n.keyboardShortcut,name:a})]}),originGap:6,render:n=>(0,S.jsx)(m.Z,{isVisible:!0,animationStyle:{opacity:r},enterAnimationStyle:{opacity:o},render:()=>(0,S.jsx)(v.Z,{ariaLabel:e.caption,disabled:e.shouldHide,icon:e.icon,style:{...(0,c.X)({noDrag:t.isElectronMac}),position:"relative",marginLeft:10,...t.isMobile&&{height:"100%"},...e.style},iconStyle:{width:16,height:16},mobileFeedback:t.isMobile,onClick:e.onClick,className:d.Mfh,...n})})})}},23727:(e,t,n)=>{n.d(t,{Z:()=>Z,l:()=>T});n(67294);var i=n(83355),o=n(480),s=n(24405),r=n(44292),a=n(68939),l=n(50906),d=n(19719),c=n(24677),u=n(43250),p=n(34700),h=n(98742),g=n(48451),m=n(57538),v=n(74948),b=n(24646),f=n(36391),S=n(64970),x=n(88923),y=n(31945),M=n(73063),k=n(26388),w=n(85893);const j=(0,a.defineMessages)({updates:{id:"topbar.updatesButton.title",defaultMessage:"Updates"}});class C extends i.Z{constructor(){super(...arguments),this.peekStoreTarget=this.createComputedStore((()=>x.default.state.open&&x.default.state.target)),this.handleClick=()=>{c.ZH(this.environment),l.gMH(this.environment)},this.handleClickSidebar=()=>{v.handleSidebarButtonClick(this.environment,this.props.blockStore,f.gY.Updates,"topbar")}}renderComponent(){const{spaceStore:e,buttonPopupStore:t,blockStore:n}=this.props,{device:i}=this.environment;if(this.peekStoreTarget.state!==n){const e=b.J5(this.environment)?(0,w.jsx)("div",{style:{textAlign:"center"},children:(0,w.jsx)(a.FormattedMessage,{defaultMessage:"Close all updates",id:"topbar.updatesButton.closeSidebartTooltip"})}):(0,w.jsx)("div",{style:{textAlign:"center"},children:(0,w.jsx)(a.FormattedMessage,{defaultMessage:"View all updates",id:"topbar.updatesButton.openSidebartTooltip"})});return S.m.state&&(this.handleClickSidebar(),S.m.setState(!1),d.Z8({environment:this.environment,pageId:n.pointer.id,isCurrentlyFollowing:(0,m.Z)(n.getFollowSettingsKey()).following,from:"email"})),(0,w.jsx)(k.Z,{placement:k.Z.Placement.Bottom,renderTooltip:()=>e,render:e=>(0,w.jsx)(T,{...e,onClick:this.handleClickSidebar,hovered:b.J5(this.environment)&&!x.default.state.open}),children:e})}return(0,w.jsx)(y.ZP,{onClick:this.handleClick,disabled:!e,popupType:i.isMobile?y.Z4.SlideUp:y.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,w.jsx)(I,{buttonPopupEvents:e}),originGap:8,render:()=>(0,w.jsx)(g.tY,{blockStore:this.props.blockStore,spaceStore:this.props.spaceStore}),style:{width:440,overflow:"hidden"}})}}function T(e){window.__c={n:"TopbarUpdatesIcon"};const{isElectronMac:t}=(0,o.O7)().device,n=(0,a.useIntl)(),i=(0,s.yK)((e=>({icon:{height:20,width:20,fill:e.regularIconColor},button:{...(0,p.X)({noDrag:t}),width:33,height:28,marginRight:2}})),[t]);return(0,w.jsx)(M.Z,{icon:r.d,iconStyle:i.icon,style:i.button,ariaLabel:n.formatMessage(j.updates),className:u.K3y,...e})}C.displayName="TopbarUpdatesButton";const Z=C;function I(e){let{buttonPopupEvents:t}=e;window.__c={n:"OriginComponent"};const n=(0,o.O7)(),{device:i}=n,s=(0,w.jsx)(a.FormattedMessage,{defaultMessage:"View past changes to this page",id:"topbar.updatesButton.tooltip"});return i.isMobile?null:(0,w.jsx)(k.Z,{placement:k.Z.Placement.Bottom,renderTooltip:()=>s,render:e=>(0,w.jsx)(T,{...(0,h.Z)(t,e)})})}},46457:(e,t,n)=>{n.d(t,{_:()=>u});var i=n(67294),o=n(480),s=n(86628),r=n(24405),a=n(68939),l=n(77907),d=n(7184),c=n(85893);function u(e){let{loginModalStore:t,loginStore:n,title:r,description:a,isSignup:u,disableLoginLink:g,redirectURL:m,className:v,onDismiss:b}=e;window.__c={n:"LoginModal"};const f=(0,o.O7)(),S=(0,s.VK)((()=>t.state.open),[t]),x=(0,i.useId)(),y=(0,i.useId)(),M={loginStore:n,title:r,description:a,isSignup:u,redirectURL:m,disableLoginLink:g,titleAriaId:x,descriptionAriaId:y};return(0,c.jsx)(d.c,{ariaLabelledBy:x,ariaDescribedBy:y,isOpen:S,onDismiss:()=>{h({loginModalStore:t,loginStore:n,onDismiss:b})},areaConstraint:{width:{min:480,max:480},height:{scroll:!0}},children:(0,c.jsxs)("div",{className:v,children:[!f.device.isMobile&&(0,c.jsx)(p,{loginModalStore:t,loginStore:n,onDismiss:b}),(0,c.jsx)(l.LazyLoginModalContent,{...M})]})})}function p(e){let{loginModalStore:t,loginStore:n,onDismiss:i}=e;window.__c={n:"CancelButton"};const o=(0,r.Fg)();return(0,c.jsx)("div",{style:{fontSize:14,color:o.mediumTextColor,position:"absolute",right:0,marginTop:16,marginRight:16,cursor:"pointer"},onClick:()=>{h({loginModalStore:t,loginStore:n,onDismiss:i})},children:(0,c.jsx)(a.FormattedMessage,{defaultMessage:"Cancel",id:"sidebarSwitcherMultiAccount.addAccountModal.cancelButton.label"})})}function h(e){const{loginModalStore:t,loginStore:n,onDismiss:i}=e;n.reset(),t.setState({open:!1}),i&&i()}},9045:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var i=n(68939),o=n(85893);function s(){return(0,o.jsx)(i.FormattedMessage,{id:"signupPage.title",defaultMessage:"Sign up"})}},92955:(e,t,n)=>{n.d(t,{Z:()=>l});n(67294);var i=n(86628),o=n(97880),s=n(19034),r=n(39849),a=n(85893);function l(e){window.__c={n:"UnreadMentionsBadge"};const{type:t,...n}=e,l=(0,i.VK)((()=>{switch(t){case"currentSpace":return s.Z.getUnreadCountForCurrentSpace().mentions;case"otherSpaces":return s.Z.getUnreadMentionsCountForOtherSpaces();case"allSpaces":return s.Z.getTotalUnreadMentionsCount();default:(0,o.t1)(t)}}),[t]);return(0,a.jsx)(r.Z,{count:l,...n})}},71424:(e,t,n)=>{n.d(t,{EZ:()=>o,FD:()=>s,G5:()=>i,rK:()=>r});const i=220,o=24,s=-7,r=-3},90683:(e,t,n)=>{n.d(t,{a:()=>l});n(67294);var i=n(66897),o=n(97880),s=n(70301),r=n(45653),a=n(85893);function l(e){const{actor:t}=e,n={size:e.size??14,style:{marginRight:2,...e.style}};return(0,i.YU)(t)?(0,a.jsx)(s.Z,{botValue:t.asActor,...n}):(0,i.$S)(t)?(0,a.jsx)(r.Z,{userValue:t.asActor,...n}):(0,i.Iq)(t)?(0,a.jsx)(r.Z,{userValue:void 0,...n}):void(0,o.t1)(t)}},34700:(e,t,n)=>{function i(e){return"drag"in e&&e.drag?{WebkitAppRegion:"drag"}:"noDrag"in e&&e.noDrag?{WebkitAppRegion:"no-drag"}:{}}n.d(t,{X:()=>i})},26907:(e,t,n)=>{n.d(t,{B:()=>s,H:()=>i});const i=e=>{const{target:t,inviteTargetsStore:n}=e;return n.state.inviteTargets.some((e=>"newUser"===t.type?e.type===t.type&&t.value.email===e.value.email:"invalidUser"===t.type?e.type===t.type&&t.value.text===e.value.text:e.type===t.type&&e.value.id===t.value.id))};function o(e){return"invalidUser"!==e.type}const s=e=>{const{inviteTargetsStore:t}=e,{inviteTargets:n}=t.state;return n.filter(o)}},20095:(e,t,n)=>{n.d(t,{AQ:()=>p,EB:()=>c,MR:()=>u});n(57658);var i=n(72126),o=n(72141),s=n(63143),r=n(89523),a=n(78291),l=n(88893),d=n(67669);function c(e){if(e&&e.blockId)return e.blockId}function u(e,t){const n=e.currentUser.id;if(t.userId===n)return!0;{const e=Date.now();return Boolean(t.present&&t.activityTimestampNearestMinuteMs&&e-t.activityTimestampNearestMinuteMs<=r.Z.presentMaxActivityAge)}}function p(e,t){const n=a.default.state.data,{remotePresenceData:r,rootStore:c}=t.state;if(!c||!c.canEdit()||!n)return[];let u=[];r&&i.M6(r,(e=>{e&&e.userId&&u.push(e)}));const{pageId:p,lastViewTime:h,lastExitTime:g,omittedUserIds:m,...v}=e.state;i.M6(v,(e=>{e.isDefined()&&u.push({userId:e.getUserId(),activityTimestampNearestMinuteMs:(0,s.ud)(e.getVisitedAt()),present:!1})})),u=i.mN(u,(e=>e.userId));const b=(0,d.YO)(c).map((e=>{let{permissionItem:t}=e;return t})).filter(o.jg).map((e=>e.user_id)),f=(0,l.CM)(n).map((e=>e.userId)),S=i.G0(b,f),x=new Set(m);return u=u.filter((e=>!!S.includes(e.userId)&&!(!e.present&&x.has(e.userId)))),u=i.MR(u,(e=>{let{activityTimestampNearestMinuteMs:t}=e;return t?-t:0})),u}},51811:(e,t,n)=>{n.d(t,{EX:()=>i,HB:()=>l,IS:()=>d,Tj:()=>a,yW:()=>r});let i=function(e){return e[e.Sidebar=0]="Sidebar",e[e.SidebarMobile=1]="SidebarMobile",e[e.MobileBottomBarPhone=2]="MobileBottomBarPhone",e[e.MobileBottomBarTablet=3]="MobileBottomBarTablet",e[e.TopbarMobile=4]="TopbarMobile",e[e.RenderAsPage=5]="RenderAsPage",e}({});const o=new Map,s=new Map;function r(e,t){o.set(c(e),t)}function a(e){return o.get(c(e))}function l(e,t){s.set(u(e),t)}function d(e){return s.get(u(e))??[]}function c(e){return Object.keys(e).sort().map((t=>{const n=e[t];return JSON.stringify(n)})).join("-")}function u(e){return Object.keys(e).sort().map((t=>{const n=e[t];return JSON.stringify(n)})).join("-")}},57538:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(57883),o=n(97880);function s(e){switch(e){case"all":return{following:!0,followSettings:(0,i.yI)({explicitly_set_by_user:!0})};case"important":return{following:!0,followSettings:(0,i.GC)({explicitly_set_by_user:!0})};case"comments":return{following:!0,followSettings:(0,i.r$)({explicitly_set_by_user:!0})};case"none":return{following:!1,followSettings:(0,i.vU)({explicitly_set_by_user:!0})};default:(0,o.t1)(e)}}},48451:(e,t,n)=>{n.d(t,{$H:()=>s,HX:()=>r,LV:()=>a,tY:()=>o});var i=n(77907);(0,i.lazyComponent)(i.deps.notifications,(e=>e.GetNotifiedFor));const o=(0,i.lazyComponent)(i.deps.notifications,(e=>e.TopbarUpdatesMenu)),s=(0,i.lazyComponent)(i.deps.notifications,(e=>e.UpdateSidebar)),r=(0,i.lazyComponent)(i.deps.notifications,(e=>e.NotificationInboxPanel)),a=(0,i.lazyComponent)(i.deps.notifications,(e=>e.MobileInboxPopup))},34826:(e,t,n)=>{n.d(t,{E:()=>Q});var i=n(67294),o=n(480),s=n(86628),r=n(24405),a=n(64788),l=n(5257),d=n(56666),c=n(55964),u=n(80875),p=n(30681),h=n(54851),g=n(72126),m=n(80503),v=n(51454),b=n(68939),f=n(50906),S=n(79698),x=n(39634),y=n(15560),M=n(64921),k=n(52275),w=n(31945),j=n(96525),C=n(78140),T=n(32163),Z=n(72495),I=n(31156),P=n(34700),B=n(87279),_=n(98742),F=n(95697),E=n(4023),R=n(80444),L=n(30806),U=n(36591),A=n(97880),O=n(58188),D=n(77080),V=n(85893);const N={tasks:{key:"tasks",label:(0,V.jsx)(b.FormattedMessage,{id:"HomeFeaturesMenu.tasks.label",defaultMessage:"My Tasks"})},tips:{key:"tips",label:(0,V.jsx)(b.FormattedMessage,{id:"HomeFeaturesMenu.tips.label",defaultMessage:"Learn"}),shouldShow:e=>D.default.checkGate("home_show_tips")},templates:{key:"templates",label:(0,V.jsx)(b.FormattedMessage,{id:"HomeFeaturesMenu.templates.label",defaultMessage:"Featured Templates"}),shouldShow:e=>{let{isMobile:t}=e;return!t&&D.default.checkGate("home_show_tips")}}},H=["tasks","tips","templates"];function K(e){let{parent:t}=e;window.__c={n:"HomeFeaturesMenu"};const n=(0,o.O7)(),a=(0,s.VK)((()=>H.map((e=>N[e])).filter((e=>{var t;return(null===(t=e.shouldShow)||void 0===t?void 0:t.call(e,n.device))??!0}))),[n.device]),l=(0,o.MO)(),d=(0,s.VK)((()=>R.default.state.currentSpaceViewStore),[]),c=(0,s.VK)((()=>(null==d?void 0:d.getHomeEnabledFeatures())??{}),[d]),u=(0,i.useCallback)((e=>{d&&O.aG({environment:n,currentSpaceViewStore:d,feature:e,from:"home_more_menu"})}),[d,n]),p=(0,r.yK)((e=>({selectedOptionCheck:{width:l?16:14},icon:{width:20,height:20}})),[l]);let h;h=l?{menuType:B.og.Modal,title:(0,V.jsx)(b.FormattedMessage,{id:"HomeFeaturesMenu.title",defaultMessage:"Experimental features"}),right:(0,V.jsx)(b.FormattedMessage,{defaultMessage:"Done",id:"settingItem.buttonPopup.done.label"}),onClickRight:t.close}:{menuType:B.og.Popup,width:200};const g=[{key:"settings-item-section",render:e=>(0,V.jsx)(Z.Z,{...e}),items:a.map((e=>{let{key:t,label:n}=e;return{key:t,action:()=>u(t),render:e=>(0,V.jsx)(k.Z,{...e,title:n,shouldWrapCaption:!0,right:Boolean(c[t])?(0,V.jsx)("div",{style:p.selectedOptionCheck,children:(0,U.e)()}):void 0})}}))}];return(0,V.jsx)(C.Z,{...h,children:(0,V.jsx)(T.Z,{type:T.i.Vertical,sections:g.filter(A.$K),initialFocus:void 0})})}const G=i.memo(K);var W=n(64964),z=n(38755),q=n(34980);function X(e){let{onClose:t}=e;window.__c={n:"OpenOnStartMenu"};const n=(0,o.O7)(),a=(0,s.VK)((()=>(0,q.o)()),[]),l=(0,o.MO)(),d=(0,s.VK)((()=>(0,z.g4)(n,R.default.state.currentSpaceViewStore)),[n]),c=(0,i.useCallback)((e=>{const i=d;O.N({userAction:"userHomeActions.setPersonalHomeAsLandingPage",environment:n,option:e,from:"home_more_menu"}),W.d4({item:{label:(0,V.jsx)(b.FormattedMessage,{defaultMessage:"Updated default landing page",id:"openOnStartMenu.snackbar.updatedDefaultLandingPage"})},undoFunc:()=>O.N({userAction:"userHomeActions.setPersonalHomeAsLandingPage.undo",environment:n,option:i,from:"home_toast_undo_button"})}),t("selectedOption")}),[d,n,t]),u=(0,r.yK)((e=>({selectedOptionCheck:{width:l?16:14},icon:{width:20,height:20}})),[l]);let p;p=l?{menuType:B.og.Modal,title:(0,V.jsx)(b.FormattedMessage,{id:"openOnStartMenuSetting.title",defaultMessage:"Open on start"}),right:(0,V.jsx)(b.FormattedMessage,{defaultMessage:"Done",id:"settingItem.buttonPopup.done.label"}),onClickRight:()=>t("clickedDone")}:{menuType:B.og.Popup,width:250,onClickOutside:()=>t("clickedOutside")};const h=[{key:"settings-item-section",render:e=>(0,V.jsx)(Z.Z,{...e}),items:a.map((e=>{let{key:t,label:n,renderIcon:i}=e;return{key:t,action:()=>c(t),render:e=>(0,V.jsx)(k.Z,{...e,title:n,icon:i(u.icon),shouldWrapCaption:!0,right:d===t?(0,V.jsx)("div",{style:u.selectedOptionCheck,children:(0,U.e)()}):void 0})}}))}];return(0,V.jsx)(C.Z,{...p,children:(0,V.jsx)(T.Z,{type:T.i.Vertical,sections:h,initialFocus:void 0})})}const Y=i.memo(X);function Q(e){window.__c={n:"HomeTopbarActionButtons"};const t=(0,o.O7)(),{device:n}=t,a=(0,o.MO)(),l=(0,s.VK)((()=>(0,F.QI)("beta_only")),[]),c=(0,i.useCallback)((()=>(0,L.lj)({environment:t})),[t]),u=(0,r.yK)((e=>({actionButtonsWrapStyle:{flexGrow:0,flexShrink:0,display:"flex",alignItems:"center",paddingRight:a?4:0,paddingLeft:a?4:12,width:void 0,justifyContent:"space-between",zIndex:v.A_,height:m.R6(t.device.isElectronMac),transition:`\n\t\t\t\t\topacity ${I.nk}ms,\n\t\t\t\t\tcolor ${I.nk}ms\n\t\t\t\t`},rightButtonsContainer:{display:"flex",gap:6},dotsIcon:{width:18,height:18,fill:e.regularIconColor},moreIconPhone:{width:26},pencilIcon:{width:20,height:20,padding:2},button:a?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",paddingLeft:8,paddingRight:8,marginRight:2}:{...(0,P.X)({noDrag:n.isElectronMac}),display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4},moreButtonStyle:a?{}:{width:250,maxHeight:"80vh"}})),[n.isElectronMac,t.device.isElectronMac,a]);return e.isInvalidPage?null:(0,V.jsx)("div",{style:u.actionButtonsWrapStyle,children:(0,V.jsxs)("div",{style:u.rightButtonsContainer,children:[l&&(0,V.jsx)(y.Z,{}),(0,V.jsx)(w.ZP,{popupType:a?w.Z4.SlideUp:w.Z4.Popup,renderOrigin:e=>(0,V.jsx)(M.Z,{style:u.button,mobileFeedback:a,...(0,_.Z)(e,{onClick:c}),children:a?(0,p.I)(u.moreIconPhone):(0,d.o)(u.dotsIcon)}),render:e=>(0,V.jsx)($,{mainMenuParent:e}),originGap:8,trapFocus:!0,forceInitialInbound:!0,style:u.moreButtonStyle})]})})}function $(e){let{mainMenuParent:t}=e;window.__c={n:"HomeMoreMenu"};const{isPhone:n}=(0,o.Fy)(),i=(0,o.O7)(),d=(0,b.useIntl)(),p=(0,s.VK)((()=>R.default.state.mainEditorCurrentBlockStore),[]),m=(0,s.VK)((()=>(0,F.QI)("beta_wave_3_only")),[]),v=(0,s.VK)((()=>(0,F.QI)("dev_only")),[]),y=(0,s.VK)((()=>Boolean(null==p?void 0:p.getCover())),[p]),M=(0,r.yK)((e=>({coverPhotoIcon:{width:18,height:18,padding:2,marginLeft:1,marginRight:1},pageIcon:{width:20,height:20,padding:2},messageIcon:{width:20,height:20,padding:2},chevronRightIcon:{width:14,height:14,fill:e.lightIconColor},eyeIcon:{width:20,height:20}})),[]),I=[{key:"all",render:e=>(0,V.jsx)(Z.Z,{...e}),items:g.oA([v?{key:"manageCoverPhoto",render:e=>(0,V.jsx)(k.Z,{...e,icon:(0,a.P)(M.coverPhotoIcon),right:(0,l.o)(M.chevronRightIcon),onClick:e=>{if(!p)return;const t=e.currentTarget.getBoundingClientRect();S.j({environment:i,intl:d,store:p,rect:t})},title:y?(0,V.jsx)(b.FormattedMessage,{id:"HomeTopbarActionButtons.changeBackground",defaultMessage:"Change background"}):(0,V.jsx)(b.FormattedMessage,{id:"HomeTopbarActionButtons.addBackground",defaultMessage:"Add background"})}),action:()=>{}}:void 0,{key:"changeDefaultPage",render:e=>(0,V.jsx)(j.Z,{...e,stopClickPropagation:!0,popupType:n?w.Z4.SlideUp:w.Z4.Popup,render:e=>(0,V.jsx)(Y,{onClose:n=>(e=>{let{immediateParent:n,closeMainParent:i}=e;n.close(),i&&t.close()})({immediateParent:e,closeMainParent:"selectedOption"===n})}),placementToOrigin:E.u.Left,renderOrigin:t=>(0,V.jsx)(k.Z,{...(0,_.Z)(e,t),icon:(0,h.S)(M.pageIcon),right:(0,l.o)(M.chevronRightIcon),title:(0,V.jsx)(b.FormattedMessage,{id:"HomeTopbarActionButtons.changeStartPage",defaultMessage:"Change default start page"})})}),action:()=>{}},{key:"showHideTiles",render:e=>(0,V.jsx)(j.Z,{...e,stopClickPropagation:!0,popupType:n?w.Z4.SlideUp:w.Z4.Popup,render:e=>(0,V.jsx)(G,{parent:e}),placementToOrigin:E.u.Left,renderOrigin:t=>(0,V.jsx)(k.Z,{...(0,_.Z)(e,t),icon:(0,c.N)(M.eyeIcon),right:(0,l.o)(M.chevronRightIcon),title:(0,V.jsx)(b.FormattedMessage,{id:"HomeTopbarActionButtons.showHideTiles",defaultMessage:"Show/hide tiles"})})}),action:()=>{}},m?{key:"provide-feedback",render:e=>(0,V.jsx)(k.Z,{...e,icon:(0,u.k)(M.messageIcon),title:(0,V.jsx)(b.FormattedMessage,{id:"HomeTopbarActionButtons.provideFeedback",defaultMessage:"Provide feedback"})}),action:()=>{f.Vaw(i,{item:"help_feedback",from:"home_more_menu"}),x.j({environment:i,from:"help_button"})}}:void 0])}];return(0,V.jsx)(C.Z,{menuType:n?B.og.ActionSheet:B.og.Popup,children:(0,V.jsx)(T.Z,{type:T.i.Vertical,sections:I,initialFocus:void 0})})}},73742:(e,t,n)=>{n.d(t,{Z:()=>h});n(67294);var i=n(480),o=n(24405),s=n(84169),r=n(68939),a=n(75018),l=n(73063),d=n(26388),c=n(34700),u=n(94841),p=n(85893);const h=function(){window.__c={n:"TopbarTasksLearnMoreButton"};const e=(0,r.useIntl)(),t=(0,i.O7)(),n=(0,r.defineMessages)({helpTitle:{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}}),h=(0,o.yK)((e=>({iconStyle:{width:20,height:20,fill:e.regularIconColor},iconContainer:{width:33,height:28}})),[]);return(0,p.jsx)(d.Z,{placement:d.Z.Placement.Bottom,renderTooltip:t=>e.formatMessage(n.helpTitle),render:i=>(0,p.jsx)(l.Z,{icon:()=>(0,s.m)(h.iconStyle),ariaLabel:e.formatMessage(n.helpTitle),style:{...(0,c.X)({noDrag:t.device.isElectronMac}),...h.iconContainer},onClick:e=>{e.preventDefault(),a.navigateToExternalURL({environment:t,url:u.h5,targetSelf:!1})},...i})})}},34980:(e,t,n)=>{n.d(t,{o:()=>d});n(57658),n(67294);var i=n(89968),o=n(54851),s=n(56996),r=n(68939),a=n(95697),l=n(85893);function d(){const e=[];return(0,a.QI)("dev_or_beta")&&e.push({key:"personal_home",label:(0,l.jsx)(r.FormattedMessage,{id:"pageOnAppStoreSetting.home.label",defaultMessage:"Home"}),renderIcon:e=>(0,s.z)({width:20,height:20,...e})}),e.push({key:"last_visited_page",label:(0,l.jsx)(r.FormattedMessage,{id:"pageOnAppStoreSetting.lastVisitedPage.label",defaultMessage:"Last visited page"}),renderIcon:e=>(0,i.Y)({width:20,height:20,...e})},{key:"first_page",label:(0,l.jsx)(r.FormattedMessage,{id:"pageOnAppStoreSetting.firstPage.label",defaultMessage:"Top page in sidebar"}),renderIcon:e=>(0,o.S)({width:20,height:20,padding:2,...e})}),e}},57345:(e,t,n)=>{n.d(t,{Cv:()=>j,a6:()=>w,lG:()=>k,qg:()=>Z,zd:()=>T});n(67294);var i=n(33728),o=n(68626),s=n(91155),r=n(72141),a=n(4615),l=n(68939),d=n(50906),c=n(47307),u=n(76464),p=n(64964),h=n(19306),g=n(26907),m=n(67669),v=n(18245),b=n(88923),f=n(99332),S=n(29677),x=n(66708),y=n(28578),M=n(85893);function k(e){b.default.state.open?f.Z.setState({...f.Z.state,open:!0}):x.Z.setState({...x.Z.state,open:!0}),d.DB2(e,{share_menu_session_id:y.ZP.state.sessionId})}function w(e){b.default.state.open?f.Z.setState({...f.Z.state,open:!1}):x.Z.setState({...x.Z.state,open:!1}),d.Rb9(e,{share_menu_session_id:y.ZP.state.sessionId}),y.ZP.reset()}function j(e){const{success:t,inviteTargets:n,requestedUserEmails:i}=e;if(0!==n.length){if(!t||0!==(null==i?void 0:i.length))return t&&i.length>0?i.length===n.length?void p.oV({label:(0,M.jsx)(l.FormattedMessage,{id:"shareMenu.inviteSuccess.snackbarMessage.requestedUsersOnly",defaultMessage:"Sent request to invite {users} to this page",values:{users:C(n)}})}):void p.oV({label:(0,M.jsx)(l.FormattedMessage,{id:"shareMenu.inviteSuccess.snackbarMessage.requestedAndInvitedUsers",defaultMessage:"Invited {users} and requested inviting {numberOfRequestedUsers, plural, one {{numberOfRequestedUsers} guest} other {{numberOfRequestedUsers} guests}}",values:{users:C(n.filter((e=>!(0,S.fZ)(e)&&!(0,S.cl)(e)||!i.includes(e.value.email)))),numberOfRequestedUsers:i.length}})}):void p.oV({label:(0,M.jsx)(l.FormattedMessage,{id:"shareMenu.inviteFailure.snackbarMessage",defaultMessage:"Failed to invite {users}",values:{users:C(n)}})});p.oV({label:(0,M.jsx)(l.FormattedMessage,{id:"shareMenu.inviteSuccess.snackbarMessage",defaultMessage:"Successfully invited {users}",values:{users:C(n)}})})}}function C(e){return(0,h.W)(e.map((e=>"group"===e.type?e.value.name??"group":"invalidUser"===e.type?e.value.text:e.value.email)))}async function T(e){const{inviteTargetsStore:t}=e,n=(0,M.jsx)(l.FormattedMessage,{id:"shareMenu.closeInviteDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Discard changes?"}),i=(0,M.jsx)(l.FormattedMessage,{id:"shareMenu.closeInviteDialog.confirmationButton.label",defaultMessage:"Yes"}),o=(0,M.jsx)(l.FormattedMessage,{id:"shareMenu.closeInviteDialog.cancelButton.label",defaultMessage:"Cancel"});if(t.state.inviteTargets.length>0){return(await c.confirmUserActionV2({message:n,acceptLabel:i,cancelLabel:o})).accept}return!1}async function Z(e){const t=v.default.mark("share_menu.invite_user_lag"),{environment:n,blockStore:l,inviteTargetsStore:d,sudoModeStore:c,onInviteClick:p,onInviteComplete:h,inviteOrigin:b,role:f,emailMessage:S,flowId:x}=e;let y={success:!1,requestedUserEmails:[]};try{y=await async function(e){const{environment:t,blockStore:n,sudoModeStore:o,inviteTargetsStore:s,role:l,inviteOrigin:d,emailMessage:c,onInviteStart:p}=e,h=e.flowId||(0,a.ZP)();if(!(0,r.iC)(l))return{success:!1,requestedUserEmails:[]};const{tokenQuery:v,inviteTargets:b}=s.state;if((0,i.oH)(v.trim())&&0===b.length){const e={type:"newUser",value:{email:v.trim()},source:"email"};g.H({target:e,inviteTargetsStore:s})||s.setState({inviteTargets:[...s.state.inviteTargets,e],tokenQuery:""})}const f=m.mU(n,g.B({inviteTargetsStore:s}));null==p||p();const S=await u.n_({environment:t,store:n,sudoModeStore:o,inviteTargets:f,inviteRole:l,isOnboarding:!1,invite:{inviteFlowId:h,inviteMessage:c,inviteOrigin:d}});return{success:S.success,requestedUserEmails:S.success?Object.keys(S.requestedUsers):[]}}({environment:n,blockStore:l,sudoModeStore:c,inviteTargetsStore:d,role:f,emailMessage:S,inviteOrigin:b,onInviteStart:p,flowId:x})}catch(M){o.log({level:"error",from:"shareMenuActions",type:"handleInviteClick",error:(0,s.Ui)(M)})}finally{null==h||h(y.success,y.requestedUserEmails)}v.default.measure(t,{environment:n})}},61436:(e,t,n)=>{n.d(t,{Z:()=>r});var i=n(49085),o=n(47839);class s extends i.default{getInitialState(){return{isFullScreen:!1}}constructor(){super(),this.updateFromElectronState=()=>{const e=o.fullscreen.get();void 0!==e&&this.setState({isFullScreen:e})},o.fullscreen.addListener(this.updateFromElectronState),this.updateFromElectronState()}}const r=new s},85834:(e,t,n)=>{n.d(t,{TG:()=>r,ZP:()=>l,uq:()=>s});var i=n(49085),o=n(4615);let s=function(e){return e.workspace_member="workspace_member",e.request_workspace_member="request_workspace_member",e.page_guest="page_guest",e.closed="closed",e}({}),r=function(e){return e[e.closed=0]="closed",e[e.share_page=1]="share_page",e[e.share_workspace=2]="share_workspace",e[e.request_workspace=3]="request_workspace",e}({});class a extends i.default{getInitialState(){return{inviteStage:r.closed,selection:s.workspace_member,order:[s.workspace_member,s.page_guest],invitedUsers:[],inviteTargets:[],invitedEmailToUserIdMap:{},flowId:(0,o.ZP)()}}startWorkspaceInvite(){this.setState({...this.state,inviteStage:r.share_workspace,order:[s.workspace_member,s.page_guest],selection:s.workspace_member})}startRequestMembership(){this.setState({...this.state,inviteStage:r.request_workspace,order:[s.request_workspace_member,s.page_guest],selection:s.request_workspace_member})}hasGuests(){return this.state.invitedUsers.some((e=>e.isGuest))}getGuestEmails(){return this.state.invitedUsers.filter((e=>e.isGuest)).map((e=>e.email))}}const l=a},55899:(e,t,n)=>{n.d(t,{KU:()=>s,ZP:()=>a,fZ:()=>o});var i=n(49085);function o(e){return"existingUser"===e.type}function s(e){return"newUser"===e.type&&"email"!==e.source}class r extends i.default{getInitialState(){return{tokenQuery:"",inviteTargets:[]}}}const a=r},92547:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(49085);class o extends i.default{getInitialState(){return{justUnlocked:!1}}}const s=o},1903:(e,t,n)=>{n.d(t,{Z:()=>r});var i=n(49085),o=n(21202);class s extends i.default{getInitialState(){return{modalOpen:!1,tokenQuery:"",inviteTargets:[],inviteRole:"editor",isInviteTargetsEmpty:!0,table:o.iU,flowId:void 0,inputFocus:"invitee",emailMessage:""}}}const r=s},8675:(e,t,n)=>{n.d(t,{Z:()=>l});var i=n(49085),o=n(80444),s=n(77080),r=n(51757);class a extends i.default{getInitialState(){return{changePermissionsEnabled:!1,privatePageStore:void 0,loading:!1,error:void 0}}shouldSaveTransactionWithSudoMode(e){const t=e===this.state.privatePageStore,n=s.default.checkGate("enable_get_private_page_info_endpoint"),i=this.doesUserAlreadyHaveEditorAccessOnBlock(e.id);return t&&n&&this.state.changePermissionsEnabled&&!i}shouldUserHaveAccessToPrivatePageBlock(){var e,t;const n=null===(e=o.default.state.currentSpaceStore)||void 0===e?void 0:e.canAdmin(),i="enterprise"===(null===(t=o.default.state.currentSpaceStore)||void 0===t?void 0:t.getSubscriptionTier());return this.state.privatePageStore&&n&&i}doesUserAlreadyHaveEditorAccessOnBlock(e){const t=o.default.state.currentSpaceStore;if(!t)return!1;return r.G.createChildStore(t,{table:"block",id:e}).canAdmin()}}const l=a},52878:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(49085),o=n(85834),s=n(1903);class r extends i.default{getInitialState(){return{permissionsInviteStore:new s.Z,contextualInviteStore:new o.ZP}}get stage(){return this.state.contextualInviteStore.state.inviteStage}}const a=r},21884:(e,t,n)=>{n.d(t,{E:()=>i});const i=n(49085).default.createValue({showConvertTooltip:!1,forceShow:!1})},96071:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(49085);class o extends i.default{getInitialState(){return{open:!1}}}const s=o},80503:(e,t,n)=>{n.d(t,{Aj:()=>o,R6:()=>r,TT:()=>i,br:()=>s,u3:()=>a});const i=52,o=45,s=37;function r(e){return e?s:o}function a(e){return 2*r(e)}}}]);