"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[2531],{5581:(e,i,t)=>{t.d(i,{Y:()=>o,h:()=>n});var s=t(24215);function n(e){s.j(e,"view_public_site_click")}function o(e,i){s.j(e,"share_menu_tab_click",i)}},3096:(e,i,t)=>{t.d(i,{J_:()=>d,a2:()=>l,oM:()=>a});var s=t(77907),n=t(88632),o=t(29026),r=t(29974);async function a(e){const{environment:i,spaceStore:t,domainName:s}=e;return await r._u({environment:i,spaceStore:t,domain:s}).then((e=>"success"!==e.type?"loading":e.data.domainState))}const l=async(e,i)=>{if(!n.Z.state.online)return[];const t=await s.deps.searchActions.loader(),r=await t.searchPublicPages({environment:i,query:e,source:"public_home_page_menu",limit:o.Xv});return""===e?r.splice(0,5):r};async function d(e){const{environment:i,spaceStore:t,domain:s,shouldUpdateDomain:n,publicHomePageId:o,shouldUpdatePublicHomePageId:a,onSubmit:l}=e;let d=!1,m=!0;n&&s&&(m=Boolean(await r.Y5({environment:i,spaceId:t.id,domain:s})),m&&(await r.u3({environment:i,spaceStore:t,domain:s}),d=!0)),m&&a&&o&&(await r.BR({environment:i,spaceStore:t,publicHomePage:o}),d=!0),d&&l()}},18878:(e,i,t)=>{t.d(i,{mX:()=>h,mo:()=>g,nH:()=>f});t(67294);var s=t(86628),n=t(24405),o=t(72141),r=t(97880),a=t(82990),l=t(68939),d=t(34859),m=t(80444),c=t(53336),p=t(63381),u=t(85893);function g(e){window.__c={n:"RestorePermissionEdits"};const{openState:i}=e,{mainEditorCurrentBlockStore:t,currentSpaceStore:o}=(0,s.VK)((()=>m.default.state),[]),r=(0,n.yK)((e=>({scroller:{display:"flex",flexDirection:"column",maxHeight:290},editContainer:{marginTop:2,marginBottom:2,color:e.regularTextColor}})),[]);if(!t||!o)return null;const a=Date.now();return(0,u.jsx)(c.Z,{type:d.Z.Y,style:r.scroller,children:i.permissionChanges.map(((e,i)=>{let[s,n]=e;const l={timestamp:a,space_id:o.id,type:"permission-changed",permission_data:{before:s,after:n}};return(0,u.jsx)("div",{style:r.editContainer,children:(0,u.jsx)(p.Z,{rootStore:t,edit:l})},`${s.type}-${i}`)}))})}function f(e){return["remove","restrict"].includes(e.type)?(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restrictAccess",defaultMessage:"Restrict access"}):"restoreTeamPermissions"===e.type?(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreTeamPermissions",defaultMessage:"Reset Permissions"}):(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreAccess",defaultMessage:"Restore access"})}function h(e){switch(e.type){case"remove":return(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restrict.description",defaultMessage:"Are you sure you want to remove this {permissionGroup} and restrict access? This page will no longer inherit share settings from the parent page.",values:{permissionGroup:x(e)}});case"restrict":return(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.remove.description",defaultMessage:"Are you sure you want to change this role and restrict access? This page will no longer inherit share settings from the parent page."});case"restore":return e.permissionChanges.length>0?(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restore.description",defaultMessage:"Are you sure you want to restore access? This will inherit the following permissions from the parent page:"}):(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreNoChanges.description",defaultMessage:"Are you sure you want to restore access?"});case"restoreTeamPermissions":return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:{fontWeight:a.Z.fontWeight.semibold,marginBottom:4},children:(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.mainDescription",defaultMessage:"Are you sure you want to reset permissions to match the teamspace defaults?"})}),(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.warningMessage",defaultMessage:"Everyone else who is not part of the teamspace will lose access, including guests."})]});default:throw r.t1(e)}}function x(e){return(0,o.jg)(e.permissionItem)?(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.user",defaultMessage:"user"}):(0,o.hV)(e.permissionItem)?(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.group",defaultMessage:"group"}):(0,o.ix)(e.permissionItem)?(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.space",defaultMessage:"workspace"}):(0,u.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.generic",defaultMessage:"permission"})}},31075:(e,i,t)=>{t.d(i,{i:()=>u});t(21703),t(67294);var s=t(86517),n=t(68939),o=t(50906),r=t(47307),a=t(76464),l=t(39699),d=t(64369),m=t(18878),c=t(18245),p=t(85893);async function u(e){const{oldPermissionItem:i,newPermissionItem:t,wasInherited:u,environment:g,store:f,sudoModeStore:h,restrictingVisibility:x,fromPermissionWrapper:b}=e;if(!(0,s.Kf)(i,t))throw new Error("Permission type mismatch.");const P=!!h&&h.shouldSaveTransactionWithSudoMode(f),y=(0,s.nl)(i.role,t.role);if(u&&y!==t.role||x)return void(await async function(e){const{environment:i,useSudoMode:t,store:s,permissionItem:o,fromPermissionWrapper:c}=e,u="none"===o.role?{type:"remove",permissionItem:o}:{type:"restrict"},g="user_permission"===o.type&&o.user_id===i.currentUser.id;(g||await r.confirmUserAction({message:(0,m.mX)(u),acceptLabel:(0,m.nH)(u),cancelLabel:(0,p.jsx)(n.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,p.jsx)(d.Z,{isSmall:!0,isMultiline:!0,children:(0,p.jsx)(n.FormattedMessage,{id:"restrictedPermissionConfirmationModal.footer.whisperText",defaultMessage:"Admins will still be able to restore permissions from restricted pages."})})}))&&l.createAndCommit({userAction:"PermissionItem.onAccept",environment:i,useSudoMode:t,perform:e=>{a.Pk({environment:i,store:s,permissionItem:o,shouldInherit:!0,transaction:e,fromPermissionWrapper:c})}})}({environment:g,useSudoMode:P,store:f,permissionItem:t,fromPermissionWrapper:b}));!f.isTopLevel()&&i.role!==t.role&&y!==i.role&&o.SMF(g),l.createAndCommit({userAction:"PermissionItem.handlePermissionItemChange",environment:g,useSudoMode:P,perform:i=>{const s=c.default.mark("share_menu.update_page_permission_lag");a.ep({environment:g,store:f,permissionItems:[t],transaction:i,pagePermissionChangeLocation:e.location,metric:s,fromPermissionWrapper:b})}})}},83771:(e,i,t)=>{t.d(i,{Z:()=>de});var s=t(67294),n=t(480),o=t(86628),r=t(24405),a=t(15145),l=t(41892),d=t(39226),m=t(72141),c=t(21202),p=t(82990),u=t(68939),g=t(50906),f=t(5581),h=t(14871),x=t(75018),b=t(42922),P=t(64921),y=t(74194),M=t(63296),w=t(24006),S=t(26388),v=t(64369),I=t(42402),j=t(60442),C=t(84210),_=t(33929),k=t(18514),T=t(31075),Z=t(5162),F=t(80444),L=t(77080),A=t(81236),D=t(54669),B=t(88893),R=t(8848),U=t(91376),W=t(85893);function K(e){window.__c={n:"LearnAboutAutogeneratedDomainsCTA"};const i=(0,n.O7)(),{WindowSizeStore:t}=i,{safePaddingLeftCSS:s,safePaddingRightCSS:a}=(0,o.VK)((()=>({safePaddingLeftCSS:t.getSafePaddingLeftCSS(8),safePaddingRightCSS:t.getSafePaddingRightCSS(8)})),[t]),{isMobile:l}=(0,n.Fy)(),{spaceStore:d,canChangeSettings:m,publicSpaceData:c}=(0,o.VK)((()=>{const e=F.default.state.currentSpaceStore;return e?{spaceStore:e,canChangeSettings:e.canAdmin(),publicSpaceData:A.Z.getPublicSpaceData(i,e.id)}:{}}),[i]),p=(0,r.yK)((i=>({container:{boxShadow:`0 -1px 0 ${i.regularDividerColor}`,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",padding:"8px 8px",paddingLeft:s,paddingRight:a,color:i.mediumTextColor,backgroundColor:i.inputBackground,...e.style}})),[e.style,s,a]);if(!d)return null;if(l)return null;if(!c)return null;return c.domainIsAutogenerated&&m?(0,W.jsx)("span",{style:p.container,children:(0,W.jsxs)("div",{style:{display:"flex"},children:[(0,W.jsx)(v.Z,{isSmall:!0,isMobile:!1,isSecondaryColor:!0,style:{paddingRight:"4px"},...e.labelStyle,children:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"Set a domain for your public links in",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.setDomainForPublicLinks"})}),(0,W.jsx)("span",{style:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",color:R.ZP.inherit},onClick:()=>{U.r$({currentTab:"settings"})},children:(0,W.jsx)(v.Z,{isSmall:!0,isMobile:!1,isSecondaryColor:!1,style:{textDecoration:"underline"},...e.labelStyle,children:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"Settings",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.openSettingsCTA"})})})]})}):null}var V=t(13991),O=t(7057),E=t(42853),G=t(72126),H=t(63143),N=t(52275),Y=t(31945),z=t(78140),$=t(32163),J=t(89728),q=t(72495),X=t(93289),Q=t(42782),ee=t(28020),ie=t(43250),te=t(87279),se=t(61766),ne=t(31194);function oe(e){window.__c={n:"PublicPermissionItemLinkExpirationMenu"};const i=(0,n.Fy)(),[,,t]=(0,o.AF)(void 0,se.Z),s=(0,r.Fg)(),a=(0,n.O7)(),l=(0,o.VK)((()=>(0,B.y$)(a)),[a]),{buttonMenuItemStyle:d}=(0,r.yK)((()=>({buttonMenuItemStyle:{opacity:e.disabled?.6:1,cursor:e.disabled?"not-allowed":""}})),[e.disabled]);return(0,W.jsx)(Y.ZP,{...e.upsellEvents,disablePopup:!l,disabled:e.disabled,popupType:i.isMobile?Y.Z4.SlideUp:Y.Z4.Popup,buttonPopupStore:t,renderOrigin:i=>(0,W.jsx)(N.Z,{...i,focused:!1,disabled:e.disabled,style:d,title:(0,W.jsxs)(v.Z,{children:[(0,W.jsx)(u.FormattedMessage,{id:"publicPermissionItem.expirationTime.label",defaultMessage:"Link expires"})," ",e.upgradeLabel]}),right:(0,W.jsxs)(J.Z,{...i,disabled:e.disabled,ignoreLocalHoverState:!0,style:{paddingLeft:0,paddingRight:0},children:[(0,W.jsx)(re,{permissionItem:e.permissionItem}),(0,E.i)({width:10,marginLeft:4,fill:s.lightIconColor})]})}),alignmentToOrigin:ne.lU.End,placementToOrigin:ne.Iw.Bottom,render:t=>{const s=[{key:"options",render:e=>(0,W.jsx)(q.Z,{...e}),items:le().map((i=>({key:i.type,action:()=>{ae(e,a,i.time),t.close()},render:e=>(0,W.jsx)(N.Z,{...e,focused:e.focused,disabled:!1,title:i.title,caption:i.caption})})))},{key:"custom",render:e=>(0,W.jsx)(q.Z,{...e,topBorder:!0}),items:[{key:"custom",action:()=>{t.close()},render:(i,s)=>(0,W.jsx)(Q.Z,{...i,renderOrigin:e=>(0,W.jsx)(N.Z,{...e,disabled:!1,title:(0,W.jsx)(u.FormattedMessage,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"})}),onFocus:s.onFocus,disableDefaultClick:!0,renderExtension:(i,s)=>(0,W.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,W.jsx)(X.Z,{...i,firstDayOfWeek:ee.AK.state,value:e.permissionItem.expiration_timestamp||(new Date).getTime(),onChange:i=>{ae(e,a,i),s.close(),t.close()},disabledDays:{before:new Date}})})})}]}];let n;return n=i.isMobile?{menuType:te.og.Modal,title:(0,W.jsx)(u.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.title",defaultMessage:"Expiration time"}),right:(0,W.jsx)(u.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.label",defaultMessage:"Done"}),onClickRight:t.close}:{menuType:te.og.Popup,width:264},(0,W.jsx)(z.Z,{className:ie.IpQ,...n,children:(0,W.jsx)($.Z,{type:$.i.Vertical,initialFocus:void 0,sections:s})})}})}function re(e){const{permissionItem:i}=e;return!i.expiration_timestamp||(0,m.o7)(i)?(0,W.jsx)(u.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"}):(0,W.jsx)(v.Z,{children:e.permissionItem.expiration_timestamp&&(0,O.tv)(e.permissionItem.expiration_timestamp,V.SP)})}function ae(e,i,t){const{permissionItem:s,onChange:n}=e;if("public_permission"!==s.type)return;if(void 0!==t&&t<=(new Date).getTime())return;const o=s,r=G.d9(o),a=t;r.expiration_timestamp=a,n(r),g.n4j(i,{expiration_time:a})}function le(){const e=(new Date).getTime()+H.U6,i=(new Date).getTime()+H.A0,t=(new Date).getTime()+7*H.A0;return[{type:"never",time:void 0,title:(0,W.jsx)(u.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"})},{type:"hour",time:e,title:(0,W.jsx)(u.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.hour",defaultMessage:"In an hour"}),caption:new Intl.DateTimeFormat(V.SP,{hour:"numeric",minute:"numeric"}).format(e)},{type:"day",time:i,title:(0,W.jsx)(u.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.day",defaultMessage:"In a day"}),caption:new Intl.DateTimeFormat(V.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(i)},{type:"week",time:t,title:(0,W.jsx)(u.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.week",defaultMessage:"In a week"}),caption:new Intl.DateTimeFormat(V.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(t)}]}function de(e){window.__c={n:"PublishToWebSettings"};const{store:i,mostPermissivePublicItem:t,permissionItemArgs:l,onUnpublish:m}=e,{permissionItem:g,from:h}=t,{sudoModeStore:P,location:y,onUpgradeButtonClick:w}=l,v=(0,n.O7)(),{isMobile:j}=v.device,_=(0,r.yK)((e=>({title:{color:e.blueColor,fontWeight:p.Z.fontWeight.medium,fontSize:14,display:"flex",alignItems:"center",margin:"0px 16px 10px",paddingTop:j?4:0},icon:{height:16,width:16,marginRight:6},linkSharingOptions:{margin:"10px 2px"},learnAboutDomainsCTA:{fontSize:14,margin:"8px 8px",padding:0,backgroundColor:void 0,boxShadow:void 0,textAlign:"left",alignItems:"flex-start"},buttonGroup:{margin:"10px 14px 16px",display:"flex",gap:10},button:{flexGrow:1,height:34},disabledButton:{opacity:.7,cursor:"not-allowed"}})),[j]),Z=(0,o.VK)((()=>!i.canAdmin()),[i]),F=h.table===c.iU?h.blockId:h.teamId,L=(0,s.useCallback)((e=>{(0,T.i)({oldPermissionItem:g,newPermissionItem:{...g,...e},wasInherited:F!==i.id,environment:v,store:i,sudoModeStore:P,location:y})}),[g,F,i,v,P,y]),D=(0,s.useCallback)((()=>{L({role:"none"}),m&&m()}),[L,m]),B=(0,o.VK)((()=>(0,C.ZP)({store:i,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=A.Z.getPublicSpaceData(v,i.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:a.tY.LinkInPage})),[i,v]),R=(0,s.useCallback)((()=>{f.h(v),x.navigate({url:B,environment:v,openInNew:"tab"})}),[v,B]);return(0,W.jsxs)("div",{children:[(0,W.jsxs)("div",{style:_.title,children:[(0,d.v)(_.icon),(0,W.jsx)("span",{children:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"This page is live on the web. <inlinelink>Learn more</inlinelink>.",id:"publishTab.settings.liveOnWeb.title",values:{inlinelink:e=>(0,W.jsx)(I.Z,{external:!0,href:(0,k.UY)("guides.autogeneratedDomains"),children:e})}})})]}),(0,W.jsx)(me,{currentBlockStore:i}),(0,W.jsx)(K,{style:_.learnAboutDomainsCTA,labelStyle:{isSmall:!1}}),(0,W.jsx)("div",{style:_.linkSharingOptions,children:(0,W.jsx)(pe,{currentBlockStore:i,permissionItem:g,onChange:L,onUpgradeButtonClick:w})}),(0,W.jsxs)("div",{style:_.buttonGroup,children:[(0,W.jsx)(S.Z,{disableTooltip:!Z,renderTooltip:()=>(0,W.jsx)(u.FormattedMessage,{defaultMessage:"You must have full access to this page to unpublish it",id:"publishTab.settings.liveOnWeb.unpublishTooltip"}),render:e=>(0,W.jsx)(M.Z,{onClick:D,disabled:Z,style:Z?{..._.button,..._.disabledButton}:_.button,...e,children:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"Unpublish",id:"publishTab.settings.liveOnWeb.unpublish"})})}),(0,W.jsx)(b.Z,{onClick:R,style:_.button,children:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"View site",id:"publishTab.settings.liveOnWeb.viewSite"})})]})]})}function me(e){window.__c={n:"PageLinkButton"};const[i,t]=s.useState(!1),[l,d]=s.useState(void 0),{currentBlockStore:m}=e,c=(0,n.O7)(),p=(0,o.VK)((()=>ce(c)),[c]),f=(0,r.yK)((()=>({container:{...p,height:"auto"},flex:{flex:1},wrapper:{display:"flex",padding:"1px 0"},input:{flex:1,borderTopRightRadius:0,borderBottomRightRadius:0,paddingRight:0},button:{height:28,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"none"}})),[p]),x=(0,o.VK)((()=>(0,C.ZP)({store:m,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=A.Z.getPublicSpaceData(c,m.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:a.tY.CopyLink})),[m,c]),b=(0,s.useCallback)((()=>{c.mobileNative&&(0,Z.Y)("supportsNativeCopy")?c.mobileNative.copyText(x,_.default.formatMessage(h.tq.copiedLinkToClipboard)):h.RD({environment:c,stringValue:x,copiedMessage:h.tq.copiedLinkToClipboard}),clearTimeout(l),t(!0),d(window.setTimeout((()=>{t(!1)}),1e3)),g.c7L(c)}),[c,x,l]);return(0,W.jsx)("div",{style:f.container,children:(0,W.jsx)("div",{style:f.flex,children:(0,W.jsxs)("div",{style:f.wrapper,children:[(0,W.jsx)(y.Z,{value:x,disabled:!0,style:f.input}),(0,W.jsx)(M.Z,{onClick:b,style:f.button,children:i?(0,W.jsx)(u.FormattedMessage,{id:"pageShareMenu.copiedLinkButton.label",defaultMessage:"✓ Copied"}):(0,W.jsx)(u.FormattedMessage,{id:"pageShareMenu.copyMaybePublicLinkButton.label.web",defaultMessage:"Copy web link"})})]})})})}function ce(e){const i=e.WindowSizeStore;return{display:"flex",alignItems:"center",width:"100%",height:e.device.isMobile?36:30,paddingTop:5,paddingBottom:5,paddingLeft:i.getSafePaddingLeftCSS(14),paddingRight:i.getSafePaddingRightCSS(14)}}function pe(e){window.__c={n:"PageLinkOptions"};const{permissionItem:i,onUpgradeButtonClick:t,onChange:a,currentBlockStore:l}=e,d=(0,n.O7)(),c=(0,o.VK)((()=>!l.canAdmin()),[l]),p=(0,o.VK)((()=>{var e;return Boolean(null===(e=F.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace())}),[]),f=m.RF(i.role),h=!1!==i.allow_duplicate,x=m.J5(i.role),b=Boolean(i.allow_search_engine_indexing),y=(0,s.useCallback)((()=>{a({role:x?"comment_only":"read_and_write"})}),[x,a]),M=(0,s.useCallback)((()=>{a({role:f?"reader":"comment_only"})}),[f,a]),I=(0,s.useCallback)((()=>{const e=!b;a({allow_search_engine_indexing:e}),g.g0v(d,{allow_search_engine_indexing:e})}),[d,a,b]),j=(0,s.useCallback)((()=>{const e=!h;a({allow_duplicate:e}),g.l7z(d,{allow_duplicate:e})}),[h,d,a]),C=(0,o.VK)((()=>L.default.checkGate("expiring_public_links")),[]),_=(0,o.VK)((()=>!(0,B.y$)(d)&&(0,B.M9)(d)),[d]),k=(0,o.VK)((()=>!(0,B.f3)(d)&&(0,B.M9)(d)),[d]),T=(0,o.VK)((()=>ce(d)),[d]),Z=(0,o.VK)((()=>c||p&&!h),[c,h,p]),A=(0,r.yK)((()=>({optionLabel:{marginRight:"auto",opacity:c?.6:1},optionButton:c?{...T,cursor:"not-allowed"}:T})),[c,T]);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(W.Fragment,{children:[C&&(0,W.jsx)(D.Z,{alwaysAllowClick:Boolean(i.expiration_timestamp),onClick:()=>{},analyticsName:"public_permission_item_expiration",requireUpgradeToTier:_,tooltipPlacement:S.Z.Placement.Left,renderTooltip:fe,renderUpgradeTooltip:he,onUpgradeClick:t,render:(e,t)=>(0,W.jsx)(oe,{upsellEvents:e,upgradeLabel:t,permissionItem:i,onChange:a,disabled:c})}),(0,W.jsx)(S.Z,{placement:S.Z.Placement.Left,renderTooltip:ue,render:e=>(0,W.jsxs)(P.Z,{onClick:y,style:A.optionButton,disabled:c,...e,children:[(0,W.jsx)(v.Z,{style:A.optionLabel,children:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"Allow editing",id:"pagePermissionItem.allowEdits.setting"})}),(0,W.jsx)(w.Z,{on:x,onClick:y,disabled:c})]})}),(0,W.jsx)(S.Z,{placement:S.Z.Placement.Left,renderTooltip:ge,render:e=>(0,W.jsxs)(P.Z,{onClick:M,style:A.optionButton,disabled:c,...e,children:[(0,W.jsx)(v.Z,{style:A.optionLabel,children:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"Allow comments",id:"pagePermissionItem.allowComments.setting"})}),(0,W.jsx)(w.Z,{on:f,onClick:M,disabled:c})]})})]}),(0,W.jsx)(S.Z,{placement:S.Z.Placement.Left,renderTooltip:p&&!h?be:xe,render:e=>(0,W.jsxs)(P.Z,{onClick:j,disabled:Z,style:A.optionButton,...e,children:[(0,W.jsx)(v.Z,{style:A.optionLabel,children:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"Allow duplicate as template",id:"pagePermissionItem.allowDuplicateTemplate.setting"})}),(0,W.jsx)(w.Z,{on:h,onClick:j,disabled:Z})]})}),(0,W.jsx)(D.Z,{requireUpgradeToTier:k,alwaysAllowClick:i.allow_search_engine_indexing,analyticsName:"allow_search_engine_indexing",onClick:I,onUpgradeClick:t,tooltipPlacement:S.Z.Placement.Left,renderTooltip:fe,renderUpgradeTooltip:he,render:(e,i)=>(0,W.jsxs)(P.Z,{style:A.optionButton,disabled:c,...e,children:[(0,W.jsxs)(v.Z,{style:A.optionLabel,children:[(0,W.jsx)(u.FormattedMessage,{defaultMessage:"Search engine indexing",id:"pagePermissionItem.allowSearchEngines.setting"})," ",i]}),(0,W.jsx)(w.Z,{on:b,onClick:I,disabled:c||Boolean(i)})]})})]})}function ue(){return(0,W.jsx)(j.Z,{caption:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"Any logged in Notion user can edit this page. Share the secret link with people you trust.",id:"pagePermissionItem.allowEdits.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowEditingPng})}function ge(){return(0,W.jsx)(j.Z,{caption:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"Any logged in Notion user can comment on this page.",id:"pagePermissionItem.allowComments.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowCommentsPng})}function fe(){return(0,W.jsx)(j.Z,{caption:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"If allowed, your public page may appear in search engines such as Google, but only if you or someone else links to it elsewhere on the web.",id:"pagePermissionItem.allowSearchEngine.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowSearchEnginesPng})}function he(){return(0,W.jsx)(j.Z,{imageURL:l.Z.images.tooltips.upsells.searchEngineIndexingPng,imageWidth:240,imageHeight:100,title:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"Upgrade for search engine indexing",id:"pagePermissionItem.searchEngineUpgradeTooltip.title"}),caption:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"Have your page appear in search engine results.",id:"pagePermissionItem.searchEngineUpgradeTooltip.caption"})})}function xe(){return(0,W.jsx)(j.Z,{caption:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"If allowed, this will allow other people to duplicate your public page to their workspace.",id:"pagePermissionItem.allowDuplicateTemplate.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowDuplicatePng})}function be(){return(0,W.jsx)(j.Z,{caption:(0,W.jsx)(u.FormattedMessage,{defaultMessage:"This workspace does not allow page duplication to other workspaces.",id:"pagePermissionItem.duplicateTemplateDisabled.tooltip"}),imageWidth:240})}},90335:(e,i,t)=>{t.d(i,{HB:()=>h,Np:()=>f,bQ:()=>g,gi:()=>x,mk:()=>y,pR:()=>b,up:()=>u});var s=t(72126),n=t(86517),o=t(72141),r=t(21202),a=t(15047),l=t(29369),d=t(98165),m=t(67669),c=t(80444),p=t(26136);function u(e){const{store:i,showRestrictedPermissionBanner:t}=e,{canAccessParent:s}=h({store:i});return s&&(t||f({store:i}))}function g(e){const{store:i}=e;if(i.getParentTable()===a.bx)return;const t=(0,d.Om)(i);if(!t)return;const s=(0,n.Wo)((0,d.fJ)(t));for(const n of s)if((0,o.ix)(n))return n}function f(e){const{store:i}=e;if(i.getParentTable()===a.bx)return!1;const t=(0,d.Om)(i),s=t?(0,n.Wo)((0,d.fJ)(t)):[],r=i.getPermissionItems(),l={};for(const o of s)l[(0,n.OC)(o)]=o;for(const a of r){const e=a.role,i=l[(0,n.OC)(a)];if(i){if((0,o.iC)(e)&&(0,o.iC)(i.role)&&(0,n.xO)(e,i.role))return!0;if(o.KF(i)&&!o.KF(a))return!0}else if((0,o.ix)(a)||(0,o.ZQ)(a)||(0,o.RI)(a))return!0}return!1}function h(e){const{store:i}=e,t=(0,d.uJ)(i)[1];return{parentStore:t,canAccessParent:t&&t.canRead()}}function x(e){const{store:i}=e,t=(0,d.uJ)(i),s=t.find((e=>e instanceof p.G&&e.isRestricted())),n=t[t.length-1];return s||n.getParentTable()===a.bx&&n.canRead()}function b(e){const{store:i}=e,t=(0,d.VP)(i),s=c.default.state.currentSpaceStore;return Boolean((null==s?void 0:s.getDisableGuests())||(null==t?void 0:t.getDisableGuests()))}function P(e){const{mostPermissivePermissions:i,store:t,ancestorTeamId:s,type:n}=e;if(!s)return;const a=i.find((e=>{let{permissionItem:i}=e;return i.type===n&&i.team_id===s}));if(a)return a;const l=i.find((e=>{let{permissionItem:i}=e;return o.Le(i)}));return"explicit_team_guest_permission"!==n||l?{permissionItem:{type:n,role:"none",team_id:s},from:(null==l?void 0:l.from)??{table:r.iU,blockId:t.id}}:void 0}function y(e){const{spaceStore:i,store:t}=e,n=(0,m.YO)(t);let a=[];i&&(a=i.getPermissionGroups());const c=d.VP(t),p=function(e){let{mostPermissivePermissions:i,store:t}=e;return i.find((e=>{let{permissionItem:i}=e;return o.$D(i)}))||{permissionItem:{type:"public_permission",role:"none"},from:{table:r.iU,blockId:t.id}}}({mostPermissivePermissions:n,store:t}),u=function(e){let{mostPermissivePermissions:i,store:t,teamStore:s}=e;const n=i.find((e=>{let{permissionItem:i}=e;return o.ix(i)}));if(n)return n;const a=i.find((e=>o.Le(e.permissionItem)));return{permissionItem:{type:"space_permission",role:"none"},from:null!=a&&a.from||!s||"none"!==s.getSpacePermissionRole()?(null==a?void 0:a.from)??{table:r.iU,blockId:t.id}:{table:l.e0,teamId:s.id}}}({mostPermissivePermissions:n,store:t,teamStore:c}),g=P({mostPermissivePermissions:n,store:t,ancestorTeamId:null==c?void 0:c.id,type:"explicit_team_guest_permission"}),f=P({mostPermissivePermissions:n,store:t,ancestorTeamId:null==c?void 0:c.id,type:"explicit_team_permission"}),h=P({mostPermissivePermissions:n,store:t,ancestorTeamId:null==c?void 0:c.id,type:"explicit_team_owner_permission"});let x=n.filter((e=>{let{permissionItem:i}=e;return o.hV(i)}));x=s.MR(x,(e=>{if(i){return i.getPermissionGroups().findIndex((i=>i.id===e.permissionItem.group_id))}return e.permissionItem.group_id}));let b=n.filter((e=>{let{permissionItem:i}=e;return(o.zU(i)||o.LW(i))&&i.team_id!==(null==c?void 0:c.id)}));const y=new Map;b.forEach(((e,i)=>{let{permissionItem:t}=e;y.has(t.team_id)||y.set(t.team_id,i)})),b=s.MR(b,[e=>{let{permissionItem:i}=e;return y.get(i.team_id)||0},e=>{let{permissionItem:i}=e;return"explicit_team_owner_permission"===i.type?0:1}]);const M=n.filter((e=>{let{permissionItem:i}=e;return o.jg(i)})),w=Boolean(null==c?void 0:c.isDefined()),S="none"!==u.permissionItem.role,v=S||w||M.length>1||M.length&&!o.zz(M[0].permissionItem.role)||x.length||o.YX(u.permissionItem.role);return{showRestrictedPermissionBanner:n.some((e=>o.Le(e.permissionItem)&&e.from.table===r.iU&&e.from.blockId===t.id)),showTeamPermission:w,showSpacePermission:S,mostPermissivePublicItem:p,mostPermissiveAncestorTeamOwnerItem:h,mostPermissiveAncestorTeamMemberItem:f,mostPermissiveAncestorTeamGuestItem:g,mostPermissiveSpaceItem:u,pagePermissionUIModel:{showUserPermissions:v,mostPermissiveGroupPermissions:x,mostPermissiveTeamPermissions:b,mostPermissiveUserPermissions:M,spacePermissionGroups:a},permissionItemsCount:(v?M.length:0)+b.length+x.length+(S?1:0)+(w?1:0)}}}}]);