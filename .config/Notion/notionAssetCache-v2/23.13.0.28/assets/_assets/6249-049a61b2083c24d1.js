"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[6249],{33338:(e,t,n)=>{n.d(t,{Z:()=>a});n(67294);var o=n(480),i=n(24405),s=n(42853),r=n(64921),l=n(85893);function a(e){window.__c={n:"CollectionViewFilterPill"};const{icon:t,title:n,on:a,hasDiff:c,wrapStyle:u,innerStyle:p,hideChevron:h}=e,m=(0,i.Fg)(),g=(0,o.O7)();return(0,l.jsxs)("div",{style:{borderRadius:14,marginRight:6,display:"inline-flex",...c&&{position:"relative"},...u},children:[(0,l.jsxs)(r.Z,{disabled:e.disabled,style:d(Boolean(a),m,p,g.device.isMobile),hoveredStyle:a?{background:m.outlineBlueButtonHoveredBackground}:void 0,pressedStyle:a?{background:m.outlineBlueButtonPressedBackground}:void 0,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,onDoubleClick:e.onDoubleClick,children:[t,n,!h&&(0,s.i)({width:10,marginLeft:4,marginTop:1,fill:a?m.blueColor:m.lightIconColor})]}),c&&(0,l.jsx)("div",{style:{position:"absolute",top:-2,right:-2,background:"dark"===m.mode?m.accentColors.orange[500]:m.accentColors.orange[300],border:`1px solid ${m.contentBackground}`,width:9,height:9,borderRadius:9}})]})}function d(e,t,n,o){return{fontSize:14,display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderRadius:32,height:o?28:24,lineHeight:o?"28px":"24px",padding:"0 8px",border:`1px solid ${t.outlineButtonBorder}`,color:t.mediumTextColor,...e&&{color:t.blueColor,border:`1px solid ${t.filterPillBorder}`,background:t.filterPillBackground},...n}}},255:(e,t,n)=>{n.d(t,{Z:()=>l});n(67294);var o=n(480),i=n(53465),s=n(73063),r=n(85893);const l=function(e){window.__c={n:"MenuItemRemoveButton"};const t=(0,o.O7)(),n={removeFilterButton:{height:void 0,width:void 0},removeFilterButtonMobile:{marginRight:-12,marginTop:-12,marginBottom:-12,paddingRight:12,paddingTop:12,paddingBottom:12}},{onClick:l,disabled:a}=e,{device:d}=t,c=d.isMobile?{...n.removeFilterButton,...n.removeFilterButtonMobile}:n.removeFilterButton;return(0,r.jsx)(s.Z,{icon:i.X,onClick:l,disabled:a,disableBackground:!0,style:c})}},97680:(e,t,n)=>{n.d(t,{Z:()=>h});n(67294);var o=n(480),i=n(66897),s=n(97880),r=n(68939),l=n(98742),a=n(52275),d=n(26388),c=n(70301),u=n(45653),p=n(85893);const h=function(e){window.__c={n:"UserMenuItem"};const{actor:t,userTitle:n,useEmailAsTooltip:h,tooltip:m,tooltipPlacement:g}=e,f=(0,o.O7)(),y=(0,r.useIntl)(),M=t.asActor&&t.isUser()?t.email:void 0,b=h&&M?M:m,S=f.device.isMobile?24:20;let v;return(0,i.YU)(t)?v=(0,p.jsx)(c.Z,{botValue:null==t?void 0:t.asActor,size:S}):(0,i.$S)(t)?v=(0,p.jsx)(u.Z,{userValue:null==t?void 0:t.asActor,size:S}):(0,i.Iq)(t)?v=(0,p.jsx)(u.Z,{userValue:void 0,size:S}):(0,s.t1)(t),(0,p.jsx)(d.Z,{placement:g??d.Z.Placement.Bottom,alignment:d.Z.Alignment.Start,textWrap:!0,render:o=>(0,p.jsx)(a.Z,{...(0,l.Z)(o,e),icon:v,title:n??(0,i.$4)(y,t),className:"notranslate"}),disableTooltip:!b,renderTooltip:()=>b})}},22715:(e,t,n)=>{n.d(t,{Z:()=>r});n(67294);var o=n(480),i=n(24405),s=(n(58047),n(85893));function r(){window.__c={n:"WebComponentNotSupportedInMobileNativeWarning"};(0,o.O7)(),(0,i.yK)((e=>({container:{margin:"8px 16px",background:e.accentColors.yellow[100],borderRadius:8,height:"fit-content"}})),[]);return(0,s.jsx)(s.Fragment,{})}},83890:(e,t,n)=>{n.d(t,{Z:()=>S});n(67294);var o=n(83355),i=n(480),s=n(86628),r=n(66897),l=n(22686),a=n(19889),d=n(7928),c=n(68939),u=n(77907),p=n(26136),h=n(92864),m=n(93044),g=n(255),f=n(97680),y=n(8319),M=n(85893);class b extends o.Z{constructor(){super(...arguments),this.renderFilterListItem=(e,t)=>{let{disabled:n,onRemove:o,onClick:i}=t;const s=this.styles,l=v(e,this.props.parentStore),a=(0,M.jsx)(g.Z,{disabled:n,onClick:o});return(0,M.jsx)(f.Z,{disabled:n,focused:!1,actor:(0,r.m3)(l),right:a,style:s.menuItem,desktopTitleStyle:s.menuItemTitle,onClick:i},e)},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:2,fill:"currentColor"}}}renderComponent(){const{mode:e,title:t,userIds:n,onChange:o,disabled:i,focused:s,onMenuDismiss:r,onMenuOpen:a,intl:d}=this.props;return(0,M.jsx)(y.Z,{mode:e,title:t,icon:l.f,iconStyles:this.styles.recordIcon,items:n,onChange:o,disabled:i,focused:s,renderFilter:this.renderFilterListItem,renderToken:(e,t)=>(0,M.jsx)(k,{item:e,handlers:t,userIds:this.props.userIds,parentStore:this.props.parentStore}),renderItemForSummary:e=>(0,M.jsx)(x,{item:e,parentStore:this.props.parentStore}),addItemLabel:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Add a person",id:"search.filterMenu.addAPersonButton.label"}),labelText:{title:t,tokenInputPlaceholder:d.formatMessage({defaultMessage:"Search people",id:"search.filterMenu.searchPeople.placeholder"}),componentDebugName:"SearchPersonFilter"},performRequest:e=>async function(e,t){let{query:n,current:o}=e;const i=new Set(o),s=await u.deps.searchActions.loader();return(await s.searchVisibleSpaceUsers({environment:t,query:n,membersOnly:!1})).filter((e=>!i.has(e.id))).slice(0,20).map((e=>e.id))}(e,this.environment),renderResultMenuItem:(e,t)=>(0,M.jsx)(C,{item:e,props:t,parentStore:this.props.parentStore}),onMenuDismiss:r,onMenuOpen:a,hasItemsSelected:(null==n?void 0:n.length)>0})}}b.displayName="SearchPersonFilter";const S=(0,c.injectIntl)(b);function v(e,t){return function(e,t){return p.U6.createChildStore(t,{table:a.KJ,id:e})}(e,t).getValue()}function x(e){let{item:t,parentStore:n}=e;window.__c={n:"ItemForSummaryComponent"};const o=(0,c.useIntl)(),i=(0,s.VK)((()=>v(t,n)),[t,n]);return(0,M.jsx)(M.Fragment,{children:(0,d.Nz)(o,i)})}function k(e){let{item:t,handlers:n,userIds:o,parentStore:l}=e;window.__c={n:"TokenComponent"};const a=(0,i.O7)(),d=1===o.length,c=(0,s.VK)((()=>v(t,l)),[t,l]);return c?(0,M.jsx)(h.ZP,{format:a.device.isMobile?m.lP.Large:m.lP.Small,showRemoveButton:!0,isSingle:d,onClickRemove:n.onRemove,actor:(0,r.m3)(c),shouldShrink:!0,style:{background:"transparent"}},t):null}function C(e){let{item:t,props:n,parentStore:o}=e;window.__c={n:"ResultMenuItemComponent"};const i=(0,s.VK)((()=>v(t,o)),[t,o]);return(0,M.jsx)(f.Z,{...n,actor:(0,r.m3)(i)})}},8319:(e,t,n)=>{n.d(t,{z:()=>D,Z:()=>q});var o=n(67294),i=n(83355),s=n(47453),r=n(72126),l=n(97880),a=n(68939),d=n(75024),c=n(49085);class u extends c.default{getInitialState(){return{isMenuOpen:!1,inputTemporaryValue:"",indexToReplace:void 0,popupOriginRect:void 0}}}const p=u;var h=n(33338),m=n(42922),g=n(52275),f=n(89728),y=n(53437),M=n(72495),b=n(75689),S=n(91642),v=n(68626),x=n(91155),k=n(23586),C=n(87279),I=n(29798),j=n(72087),T=n(78140),w=n(32163),F=n(43765),R=n(40721),Z=n(47082),B=n(85893);const O={input:{marginTop:8,marginLeft:8,marginRight:8,boxSizing:"border-box",width:"auto"},menu:{width:250,maxHeight:"40vh"},inputMenu:{maxHeight:"20vh"}};class P extends i.Z{constructor(){super(...arguments),this.storeTypes={requestStore:j.Z,menuListStore:I.Z},this.renderRequest=(e,t,n)=>{const{labelText:o,value:i}=this.props,{menuListStore:s}=this.stores,r=e=>(0,B.jsx)(M.Z,{...e,title:o.resultSectionTitle,loading:!n});if(e)return v.log({level:"error",from:o.componentDebugName,type:"requestFailed",error:(0,x.Ui)(e),data:{miscDataToConvertToString:{query:i}}}),(0,B.jsx)(r,{children:(0,B.jsx)(F.Z,{title:(0,B.jsx)(a.FormattedMessage,{defaultMessage:"Something went wrong.",id:"search.inputMenu.errorMessage"})})});if(!t)return(0,B.jsx)(r,{children:(0,B.jsx)(F.Z,{title:(0,B.jsx)(a.FormattedMessage,{defaultMessage:"Loadingâ€¦",id:"search.inputMenu.loading.message"})})});if(t&&0===t.length)return(0,B.jsx)(r,{children:(0,B.jsx)(F.Z,{title:(0,B.jsx)(a.FormattedMessage,{defaultMessage:"No results found.",id:"search.inputMenu.noResults.message"})})});const l={key:"results",items:t.map((e=>{return t=e,n=this.props.renderResultMenuItem,o=this.props.onConfirm,{key:t,action:()=>o(t),render:e=>n(t,e)};var t,n,o})),render:r};return(0,B.jsx)(w.Z,{type:w.i.Vertical,store:s,initialFocus:0,sections:[l]})},this.handleMenuInputRemoveLast=()=>{const{items:e,onRemove:t}=this.props,n=r.Z$(e);n&&t(n)}}renderComponent(){const{value:e,items:t,performRequest:n}=this.props,{requestStore:o}=this.stores,i={query:e,current:t};return(0,B.jsx)(T.Z,{...this.getMenuProps(),children:(0,B.jsx)(k.Z,{debounce:100,requestStore:o,request:i,performRequest:n,render:this.renderRequest})})}renderTokenInput(){const{labelText:e,value:t,items:n,disabled:o,onChange:i,renderToken:s,onRemove:r,onClear:l}=this.props,a=n.map((e=>s(e,{onRemove:()=>r(e)})));return(0,B.jsx)(Z.Z,{focus:!A(this.environment)||void 0,focusAfterAnimation:!0,format:Z.Z.Format.FilterValue,tokens:a,placeholder:e.tokenInputPlaceholder,onRemoveLastToken:this.handleMenuInputRemoveLast,onClearButtonClick:l,value:t,onChange:i,showClearButton:!0,disabled:Boolean(o),style:O.inputMenu})}getMenuProps(){const{onDismiss:e,labelText:t}=this.props;if(A(this.environment)){return{menuType:C.og.Modal,title:t.title,right:(0,B.jsx)(R.DoneMenuText,{}),onClickRight:e,header:this.renderTokenInput()}}return{menuType:C.og.Popup,onClickOutside:e,header:this.renderTokenInput(),...O.menu}}}P.displayName="SearchTokenInputMenu";const L=P;function A(e){const{device:t}=e;return t.isMobile}let D=function(e){return e.Button="Button",e.Section="Section",e.Pill="Pill",e}({});class W extends i.Z{constructor(){super(...arguments),this.animationFrame=void 0,this.origin=o.createRef(),this.storeTypes={componentStore:p},this.renderMobileFilterSummary=e=>{const{title:t,items:n,renderItemForSummary:i}=this.props,{disableFilters:s}=e,r=this.styles,l={...d.mK,...r.summary},a=n.length-1,c=(0,B.jsx)("ul",{style:l,children:n.map(((e,t)=>(0,B.jsx)("li",{style:r.summaryItem,children:(0,B.jsxs)(o.Fragment,{children:[i(e),t!==a&&","," "]})},e)))});return(0,B.jsx)(b.Z,{disabled:s,onClick:this.handleMenuOpenMobile,onClickClear:()=>_(this.props.onChange),label:t,title:c})},this.renderMenu=()=>{const{renderToken:e,renderFooter:t,allowApplyBatchSelection:n}=this.props,{componentStore:{state:o}}=this.stores;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(L,{...this.props,value:o.inputTemporaryValue,onChange:this.handleMenuInputChange,onDismiss:this.handleMenuClose,onConfirm:this.handleItemConfirm,onClear:()=>{this.handleClearTemporary(),_(this.props.onChange)},onRemove:this.handleFilterRemove,renderToken:e}),t&&(0,B.jsxs)(M.Z,{topBorder:!0,style:{padding:6,justifyContent:"space-between",display:"flex"},children:[(0,B.jsx)(f.Z,{onClick:()=>{_(this.props.onChange)},children:(0,B.jsx)(a.FormattedMessage,{id:"searchTokenFilter.clearButton",defaultMessage:"Clear"})}),n&&(0,B.jsx)(m.Z,{onClick:()=>{this.handleMenuClose("applyButton")},children:(0,B.jsx)(a.FormattedMessage,{id:"searchTokenFilter.applyButton",defaultMessage:"Apply"})})]})]})},this.handleMenuOpen=e=>{const{onMenuOpen:t}=this.props;t&&t(),this.scheduleMeasurement(void 0,(t=>({...t,isMenuOpen:!0,indexToReplace:e})))},this.handleMenuOpenMobile=()=>{const{componentStore:e}=this.stores;e.setState({...e.state,isMenuOpen:!0})},this.handleMenuClose=e=>{const{onMenuDismiss:t}=this.props,{componentStore:n}=this.stores;this.clearInput(),n.setState({...n.state,isMenuOpen:!1,indexToReplace:void 0}),t&&t(e)},this.handleClearTemporary=()=>{const{componentStore:e}=this.stores;e.setState({...e.state,inputTemporaryValue:""})},this.handleItemConfirm=e=>{const{items:t}=this.props,{componentStore:n}=this.stores,{indexToReplace:o}=n.state;"number"==typeof o&&o<t.length?function(e,t,n,o){const i=n.slice(0,e).concat(t,n.slice(e+1));o(i)}(o,e,this.props.items,this.props.onChange):t.includes(e)&&W.Mode.Pill?U(e,this.props.items,this.props.onChange):function(e,t,n){const o=t.concat(e);n(r.jj(o))}(e,this.props.items,this.props.onChange),this.props.keepInputOnItemConfirm||this.clearInput()},this.handleFilterRemove=e=>{U(e,this.props.items,this.props.onChange)},this.handleMenuInputChange=e=>{const{componentStore:t}=this.stores,{target:n}=e;t.setState({...t.state,inputTemporaryValue:String(n.value)})},this.scheduleMeasurement=(e,t)=>{this.animationFrame=requestAnimationFrame(this.measureOriginRect(t))},this.measureOriginRect=e=>t=>{const{componentStore:n}=this.stores;if(!this.origin)return;if(!this.origin.current)return;const o=e?e(n.state):n.state;n.setState({...o,popupOriginRect:this.origin.current.getBoundingClientRect()})},this.isMenuOpen=()=>{const{componentStore:{state:e}}=this.stores;return e.isMenuOpen},this.clearInput=()=>{const{componentStore:e}=this.stores;e.setState({...e.state,inputTemporaryValue:"",indexToReplace:void 0})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemWrapper:{display:"flex"},sectionMenuItem:{display:"flex"},appendListItemButton:{minHeight:void 0,paddingTop:4,paddingBottom:4,fontSize:d.yv(this.environment,"UIRegular")},icon:{height:16,width:16,marginRight:"Pill"===this.props.mode?6:-2,fill:"currentColor"},iconSmall:{height:12,width:12},summary:{display:"inline"},summaryItem:{display:"inline"}}}didMount(){window.addEventListener("resize",this.scheduleMeasurement)}willUnmount(){window.removeEventListener("resize",this.scheduleMeasurement),this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0)}didUpdate(e){(e.items.length!==this.props.items.length||e.mode!==this.props.mode)&&this.scheduleMeasurement()}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t,disabled:n}=this.props,{componentStore:{state:o}}=this.stores,i=n||o.isMenuOpen;let s;const r=(()=>e===W.Mode.Section?(s=t,this.renderSectionOrigin()):e===W.Mode.Button?this.renderButtonOrigin():e===W.Mode.Pill?this.renderPillOrigin():void(0,l.t1)(e))();return(0,B.jsxs)(S.Z,{title:s,marginAfter:e===W.Mode.Section,style:this.styles.sectionMenuItem,children:[e!==W.Mode.Pill&&this.renderFilters({disableFilters:i,showLabel:!1}),r,(0,B.jsx)(y.ZP,{popupType:y.ZP.PopupType.Popup,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.Start,open:this.isMenuOpen(),originRect:o.popupOriginRect,render:()=>this.renderMenu(),onDismiss:this.handleMenuClose,keepFocus:!0,preventScaleTransition:!0})]})}renderButtonOrigin(){const{icon:e,title:t,disabled:n,focused:o}=this.props,i=this.styles,s=V(this.theme),r={...i.menuItem,...s.buttonMenuItem};return(0,B.jsx)("div",{ref:this.origin,style:i.menuItemWrapper,children:(0,B.jsx)(g.Z,{disabled:n||this.isMenuOpen(),icon:e(i.icon),title:t,focused:o,onClick:e=>this.handleMenuOpen(),style:r})})}renderPillOrigin(){const{icon:e,title:t,disabled:n,iconStyles:o}=this.props,i=this.styles,s=this.props.mode===D.Pill&&this.props.hasItemsSelected;return(0,B.jsx)("div",{ref:this.origin,style:i.menuItemWrapper,children:(0,B.jsx)(h.Z,{on:s,icon:e({...i.icon,...o}),title:(0,B.jsx)("span",{children:t}),onClick:e=>this.handleMenuOpen(),wrapStyle:{opacity:n?.4:1}})})}renderSectionOrigin(){const{addItemLabel:e,disabled:t}=this.props,n=this.styles,i=V(this.theme);return(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)("div",{ref:this.origin,style:n.menuItemWrapper}),(0,B.jsx)(g.Z,{disabled:t||this.isMenuOpen(),icon:(0,s.R)(n.iconSmall),title:e,focused:!1,onClick:e=>this.handleMenuOpen(),style:{...n.appendListItemButton,...i.appendListItemButton}})]})}renderMobile(e){const{disabled:t}=this.props,n=t||this.isMenuOpen(),o=e===W.Mode.Section?this.renderMobileFilterSummary({disableFilters:n}):this.renderMobileButtonOrigin({disableFilters:n});return(0,B.jsx)(y.ZP,{popupType:y.ZP.PopupType.SlideUp,open:this.isMenuOpen(),origin:o,render:this.renderMenu,onDismiss:this.handleMenuClose,keepFocus:!0})}renderMobileButtonOrigin(e){const{icon:t,title:n}=this.props,o=this.styles;return(0,B.jsx)(g.Z,{disabled:e.disableFilters,focused:!1,icon:t({...o.icon}),title:n,onClick:e=>this.handleMenuOpenMobile()})}renderFilters(e){const{items:t,renderFilter:n}=this.props,{device:o}=this.environment,i=t.map(((t,i)=>(0,B.jsx)("li",{children:n(t,{disabled:e.disableFilters,onRemove:()=>this.handleFilterRemove(t),onClick:()=>o.isMobile?this.handleMenuOpenMobile():this.handleMenuOpen(i)})},`${t}_${i}`)));return(0,B.jsx)("ul",{style:d.mK,children:i})}}W.displayName="SearchTokenFilter",W.Mode=D;const q=W;function U(e,t,n){n(t.filter((t=>t!==e)))}function _(e){e([])}function V(e){return{buttonMenuItem:{color:e.mediumTextColor},appendListItemButton:{color:e.lightTextColor}}}},75689:(e,t,n)=>{n.d(t,{Z:()=>c});n(67294);var o=n(83355),i=n(82990),s=n(52275),r=n(24006),l=n(255),a=n(85893);class d extends o.Z{constructor(){super(...arguments),this.styles={menuItem:{background:void 0,minHeight:void 0,fontSize:this.environment.device.isMobile?i.Z.fontSize.UISmall.mobile:i.Z.fontSize.UIRegular.desktop,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginTop:0},rightWrapper:{display:"flex",alignItems:"center",marginTop:"-50%",marginBottom:"-50%",height:44}}}renderComponent(){const{disabled:e,label:t,title:n,onClick:o,isToggle:i,...r}=this.props,l={menuItemLabel:{color:this.theme.lightTextColor}};const d=this.styles,c=(0,a.jsx)("span",{style:l.menuItemLabel,children:t});return(0,a.jsx)(s.Z,{focused:!1,...r,inline:i,disabled:e,icon:c,title:n,right:this.renderRight(),onClick:o,dontShrinkIcon:!0,dontShrinkRight:!0,shouldWrapTitle:!0,style:d.menuItem,desktopIconStyle:d.menuItemLabel})}renderRight(){const{disabled:e}=this.props,t=this.styles.rightWrapper;return this.props.isToggle?(0,a.jsx)("div",{style:t,children:(0,a.jsx)(r.Z,{on:this.props.isToggleActive,onClick:this.props.onClick})}):(0,a.jsx)(l.Z,{disabled:e,onClick:this.props.onClickClear})}}d.displayName="SearchFilterSummaryMenuItem";const c=d},91642:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(72495),i=n(85893);const s=function(e){const t={desktopTitleStyle:{marginBottom:4},marginAfter:{marginBottom:16}},{title:n,marginAfter:s,desktopStyle:r,desktopTitleStyle:l,...a}=e,d=(s||r)&&{...s&&t.marginAfter,...r},c=l?{...t.desktopTitleStyle,...l}:t.desktopTitleStyle;return(0,i.jsx)(o.Z,{isTitleUppercase:!0,disableDesktopPadding:!0,enableActionSheetTitle:!0,desktopStyle:d,desktopTitleStyle:c,shouldShowBottomDivider:!1,title:n,...a})}},86706:(e,t,n)=>{n.d(t,{K9:()=>b,Uy:()=>M,nx:()=>p});n(57658);var o=n(67294),i=n(480),s=n(24405),r=n(72126),l=n(68939),a=n(74194),d=n(85893);const c=["control+t","control+shift+n","control+shift+t","control+w","control+shift+w","control+r","control+shift+r","control+shift+i","control+\\","control+=","control+-","control+0","control+[","control+]","control+shift+tab","control+tab","control+1","control+2","control+3","control+4","control+5","control+6","control+7","control+8","control+9"],u=["command+,","command+t","command+shift+n","command+shift+t","command+w","command+shift+w","command+r","command+shift+r","alt+command+i","command+\\","command+=","command+-","command+0","command+[","command+]","control+shift+tab","control+tab","command+option+left","command+option+right","command+shift+[","command+shift+]","command+1","command+2","command+3","command+4","command+5","command+6","command+7","command+8","command+9"];function p(e){function t(){return e.shortcut?M(e.shortcut):void 0}window.__c={n:"KeyboardGlobalShortcutSettingInput"};const{isMac:n,isWindows:p}=(0,i.Fy)(),{KeyboardShortcutStackStore:S}=(0,i.O7)(),[v,x]=(0,o.useState)(t()),[k,C]=(0,o.useState)(new Set([])),[I,j]=(0,o.useState)(),[T,w]=(0,o.useState)(!1),F=(0,o.useRef)(!1),R=(0,o.useRef)(!1),Z=(0,o.useRef)(!1),B=(0,s.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:10,alignItems:"flex-end"},takenShortcutError:{color:e.accentColors.red[500],fontSize:12}})),[]);function O(){if(v&&Z.current)if(v.key)if(n?v.control||v.option||v.command:v.control||v.option)if(function(e,t,n){for(const i of Object.values(e.shortcutMap))for(const e of i)if(r.Xy(M(e),t))return!0;const o=n?u:c;for(const i of o)if(r.Xy(M(i),t))return!0;return!1}(S,v,n)){x(t());const e=b(v,n);j((0,d.jsx)(l.FormattedMessage,{id:"desktopQuickSearch.error.shortcutAlreadyUsed",defaultMessage:"{reservedShortcut} is already used",values:{reservedShortcut:e}}))}else{const t=function(e,t){const n=[];e.shift&&n.push("shift");e.control&&(t?n.push("control"):n.push("ctrl"));e.option&&(t?n.push("option"):n.push("alt"));e.command&&(t?n.push("command"):n.push("meta"));e.key&&n.push(e.key.toLowerCase());return n.join("+")}(v,n);e.onChange(t)}else x(t()),j(n?(0,d.jsx)(l.FormattedMessage,{id:"desktopQuickSearch.error.macModifierRequired",defaultMessage:"Use one of Option, Control, or Command for global keyboard shortcuts"}):(0,d.jsx)(l.FormattedMessage,{id:"desktopQuickSearch.error.windowsModifierRequired",defaultMessage:"Use one of Control or Alt for global keyboard shortcuts"}));else x(void 0);else Z.current||x(t());F.current=!0,w(!1),Z.current=!1}function P(e){if(p&&e.startsWith("Meta"))return;const t=new Set([...k,e]),n=function(e){const t={};for(const n of e)n.startsWith(m)?t.command=!0:n.startsWith(f)?t.option=!0:n.startsWith(g)?t.shift=!0:n.startsWith(y)?t.control=!0:n.startsWith("Key")?t.key=n.substring(3).toLowerCase():n.startsWith("Digit")?t.key=n.substring(5):h[n]&&(t.key=h[n]);return 0===Object.values(t).filter((e=>!r.o8(e))).length?void 0:t}(t);C(t),x(n),j(void 0),Z.current=!0}return(0,d.jsxs)("div",{style:B.container,children:[(0,d.jsx)(a.Z,{onKeyDown:function(e){R.current=!0,"Escape"===e.key?e.currentTarget.blur():"Tab"!==e.key&&(e.preventDefault(),e.stopPropagation(),P(e.code))},onKeyUp:function(e){R.current&&function(e){const t=new Set([...k]);if(t.delete(e),e.startsWith("Meta"))for(const n of t)n.startsWith(g)||n.startsWith(f)||n.startsWith(y)||t.delete(n);C(t),0===t.size&&O()}(e.code)},onFocus:function(e){x(void 0),w(!0)},onBlur:function(e){F.current||O(),F.current=!1,R.current=!1,C(new Set),w(!1)},focus:T,readOnly:!0,inputStyle:{textAlign:"center",caretColor:"transparent"},value:v&&b(v,n)}),I&&(0,d.jsx)("div",{style:B.takenShortcutError,children:I})]})}const h={ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",Backquote:"`",Backslash:"\\",Backspace:"backspace",BracketLeft:"[",BracketRight:"]",Comma:",",Delete:"delete",Enter:"return",Equal:"=",Minus:"-",Period:".",Quote:"'",Semicolon:";",Slash:"/",Space:"space"},m="Meta",g="Shift",f="Alt",y="Control";function M(e){const t={};for(let n of e.split("+"))n=n.toLowerCase(),"command"===n||"meta"===n?t.command=!0:"option"===n||"alt"===n?t.option=!0:"shift"===n?t.shift=!0:"control"===n||"ctrl"===n?t.control=!0:t.key=n;return t}function b(e,t){const n=[];if(e.shift&&(t?n.push("shift"):n.push("Shift")),e.control&&(t?n.push("control"):n.push("Ctrl")),e.option&&(t?n.push("option"):n.push("Alt")),e.command&&(t?n.push("âŒ˜"):n.push("Win")),e.key){const t=1===e.key.length?e.key.toUpperCase():e.key;n.push(t)}return n.join("+")}}}]);