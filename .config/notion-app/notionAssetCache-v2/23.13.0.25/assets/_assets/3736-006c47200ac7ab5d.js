"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[3736],{45800:(e,t,s)=>{s.d(t,{u:()=>o});s(67294);var a=s(24405),n=s(89024),i=s(68785),r=s(85893);function l(e){window.__c={n:"FullScreenLoader"};const{isVisible:t}=e,s=(0,a.yK)((()=>({hidden:{opacity:0,transition:"opacity 0.3s ease-in-out"},spinner:{width:24,height:24},visible:{opacity:1,transition:"opacity 0.3s ease-in-out"}})),[]);return(0,r.jsx)(n.jX,{width:"fill",height:"fill",padding:48,align:"center",style:t?s.visible:s.hidden,children:(0,r.jsx)(i.Z,{style:s.spinner})})}function o(e){return(0,r.jsx)(l,{isVisible:e})}},93349:(e,t,s)=>{s.d(t,{Z:()=>i});var a=s(49085);class n extends a.default{getInitialState(){return{billingEventsLimit:20,billingEvents:[]}}}const i=n},64251:(e,t,s)=>{s.d(t,{Z:()=>i});var a=s(49085);class n extends a.default{getInitialState(){return{churnSurveyModalOpen:!1,page:"default"}}}const i=n},33083:(e,t,s)=>{s.r(t),s.d(t,{BillingModalContent:()=>m,BillingSidebarButton:()=>F,canShowBilling:()=>D,showAddressModal:()=>Z,showBilling:()=>k,showEmailModal:()=>z,showPaymentMethodModal:()=>W,showVatIdModal:()=>G});var a=s(67294),n=s(480),i=s(78780),r=s(33218),l=s(86628),o=s(3791),d=s(80444),c=s(85703),u=s(38524);function p(){var e;const t=(0,l.VK)((()=>d.default.state.currentSpaceStore),[]),s=(0,l.VK)((()=>c.Z.state.data),[]),a=(0,u.f)();if(!a||!t)return;const n="unsubscribed_admin"===a.type&&a.customerData&&(0,o.E3)(a.customerData.stripe.addOns),i="subscribed_admin"===a.type||n,r=i?null===(e=a.customerData)||void 0===e?void 0:e.stripe:void 0;return r&&i?{spaceStore:t,upcomingInvoiceData:s,subscriptionData:a,customerData:r}:void 0}var g=s(85893);function m(){window.__c={n:"BillingModalContent"},(0,r.h)();const{isMobile:e}=(0,n.Fy)(),t=p();return t?(0,g.jsx)("div",{style:{padding:e?16:48},children:(0,g.jsx)(i.Z,{spaceStore:t.spaceStore,subscriptionData:t.subscriptionData,upcomingInvoiceData:t.upcomingInvoiceData,customerData:t.customerData})}):null}var h=s(24405),f=s(15967),b=s(68939),v=s(64921),y=s(14694),x=s(50906),M=s(69098),S=s(7184),C=s(45800),j=s(1853),w=s(77907);const B=(0,w.lazyComponent)(w.deps.payments,(e=>e.BillingModalContent));function _(e){const{isOpen:t,onClosed:s,onDismiss:a}=e;return(0,g.jsx)(S.c,{isOpen:t,onClosed:s,onDismiss:a,areaConstraint:{height:{scroll:!0},width:{min:1e3}},children:(0,g.jsx)(j.a5,{title:(0,g.jsx)(b.FormattedMessage,{defaultMessage:"Billing",id:"subscription.billing.title"}),children:(0,g.jsx)(B,{renderLoading:C.u})})})}let P=!1;async function k(e){const{environment:t,from:s}=e;if(!P){P=!0;try{x.R3t(t,{from:s}),await M.o.showAsyncModalComponent(_),x.lq2(t)}finally{P=!1}}}var A=s(88893);function D(e){var t;const{subscriptionData:s,spaceStore:a}=e;return!(!s||!a.canAdmin())&&(!A.wY(s)&&("subscribed_admin"===s.type||(!("unsubscribed_admin"!==s.type||!o.E3(null===(t=s.customerData)||void 0===t?void 0:t.stripe.addOns))||!!A.MM(s))))}function F(){window.__c={n:"BillingSidebarButton"};const e=(0,h.yK)((e=>({icon:{fill:e.mediumIconColor,width:16}})),[]),t=(0,n.O7)(),s=function(){const e=(0,l.VK)((()=>d.default.state.currentSpaceStore),[]),t=(0,u.f)();return(0,l.VK)((()=>void 0!==e&&void 0!==t&&D({spaceStore:e,subscriptionData:t})),[e,t])}(),i=(0,a.useCallback)((()=>{k({environment:t,from:"mobile_sidebar"})}),[t]);return p()&&s?(0,g.jsx)(v.Z,{mobileFeedback:!0,onClick:i,children:(0,g.jsx)(y.Z,{left:(0,f.J)(e.icon),disableMobileBorder:!0,children:(0,g.jsx)(b.FormattedMessage,{id:"billingSidebarButton.title",defaultMessage:"Billing"})})}):null}var V=s(86664),T=s(19234),I=s(89024),L=s(44342),E=s(7124),O=s(95014);function R(e){window.__c={n:"AddressElementWrapper"};const{defaultValue:t,onChange:s}=e,n=(0,a.useCallback)((e=>{const{name:t,address:a}=e.value;s({name:t,businessName:"",addressLine1:a.line1??"",addressLine2:a.line2??"",city:a.city??"",state:a.state??"",zipCode:a.postal_code??"",country:a.country??""})}),[s]);return(0,g.jsx)(V.AddressElement,{options:{mode:"billing",defaultValues:{name:null==t?void 0:t.name,address:{line1:null==t?void 0:t.addressLine1,line2:null==t?void 0:t.addressLine2,city:null==t?void 0:t.city,state:null==t?void 0:t.state,postal_code:null==t?void 0:t.zipCode,country:null==t?void 0:t.country}}},onChange:n})}function N(e){window.__c={n:"AddressModalContent"};const{defaultValue:t,onAccept:s}=e,[n,i]=(0,a.useState)(!1),[r,l]=(0,a.useState)(t??{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""}),o=(0,O.useElementsOptions)({type:"address"}),d=(0,a.useCallback)((()=>{r&&(0,T.A)(r)?s(r):i(!0)}),[s,r]);return(0,g.jsx)(L.sR,{showDismissButton:!1,header:(0,g.jsx)(E.q,{styleName:"Heading-17px/Medium",colorName:"primary",children:(0,g.jsx)(b.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeYourAddressModal.title",defaultMessage:"Change your address"})}),footer:(0,g.jsx)(L.a6,{layout:"horizontal-right",primaryButton:{buttonType:"primary",label:(0,g.jsx)(b.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingAddressModal.updateButton.label",defaultMessage:"Update"}),onClick:d},secondaryButton:{buttonType:"dismiss"}}),children:(0,g.jsx)(V.Elements,{stripe:(0,O.getStripe)(),options:o,children:(0,g.jsxs)(I.jX,{gap:20,children:[(0,g.jsx)(R,{defaultValue:r,onChange:l}),n?(0,g.jsx)(E.q,{styleName:"Body-12px/Regular",colorName:"red",children:(0,g.jsx)(b.FormattedMessage,{id:"spaceSubscriptionBillingV2.address.invalidError",defaultMessage:"Your address is invalid. Please update your address so we can process your payment."})}):null]})})})}async function Z(e){const{defaultValue:t}=e;return await M.o.showAsyncModal((e=>(0,g.jsx)(S.c,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,animateSizeTransition:!1,areaConstraint:{width:{min:500,max:500},height:{scroll:!0}},children:(0,g.jsx)(N,{defaultValue:t,onAccept:e.resolve})})))}var K=s(74194);function U(e){window.__c={n:"EmailModalContent"};const{defaultValue:t,onAccept:s}=e,[n,i]=(0,a.useState)(t??""),r=(0,a.useCallback)((()=>s(n)),[s,n]);return(0,g.jsx)(L.sR,{showDismissButton:!1,header:(0,g.jsx)(E.q,{styleName:"Heading-17px/Medium",colorName:"primary",children:(0,g.jsx)(b.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingEmailModal.title",defaultMessage:"Change billing email"})}),footer:(0,g.jsx)(L.a6,{layout:"horizontal-right",primaryButton:{buttonType:"primary",label:(0,g.jsx)(b.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingEmailModal.updateButton.label",defaultMessage:"Update"}),onClick:r},secondaryButton:{buttonType:"dismiss"}}),children:(0,g.jsx)(K.Z,{focus:!0,selectAll:!0,value:n,onChange:e=>i(e.target.value),onSubmit:r})})}async function z(e){const{defaultValue:t}=e;return await M.o.showAsyncModal((e=>(0,g.jsx)(S.c,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{min:500,max:500}},children:(0,g.jsx)(U,{defaultValue:t,onAccept:e.resolve})})))}var H=s(47307),X=s(23412),q=s(33493);function Y(e){window.__c={n:"PaymentMethodModalContent"};const{onAccept:t}=e,s=(0,n.O7)(),a=(0,b.useIntl)(),i=(0,l.VK)((()=>q.Z.selectedCurrencyCode),[]),r=O.useElementsOptions({type:"setup",currency:i});return(0,g.jsx)(V.Elements,{stripe:O.getStripe(),options:r,children:(0,g.jsx)(V.ElementsConsumer,{children:e=>{let{elements:n,stripe:i}=e;return(0,g.jsx)(L.sR,{showDismissButton:!1,header:(0,g.jsx)(E.q,{styleName:"Heading-17px/Medium",colorName:"primary",children:(0,g.jsx)(b.FormattedMessage,{id:"paymentMethodModalContent.title",defaultMessage:"Change your payment method"})}),footer:(0,g.jsx)(L.a6,{layout:"horizontal-right",primaryButton:{buttonType:"primary",label:(0,g.jsx)(b.FormattedMessage,{id:"paymentMethodModalContent.update",defaultMessage:"Update"}),onClick:async()=>{if(!n||!i)return;const{error:e}=await n.submit();if(e)return;const{error:r,paymentMethod:l}=await i.createPaymentMethod({elements:n});r?H.deprecatedShowErrorMessage(O.translateStripeError(s,a,r)):l&&t(l)}},secondaryButton:{buttonType:"dismiss"}}),children:(0,g.jsx)(X.n,{})})}})})}async function W(){return await M.o.showAsyncModal((e=>(0,g.jsx)(S.c,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,animateSizeTransition:!1,areaConstraint:{width:{min:500,max:500},height:{scroll:!0}},children:(0,g.jsx)(Y,{onAccept:e.resolve})})))}function J(e){window.__c={n:"VatIdModalContent"};const{defaultValue:t,onAccept:s}=e,[n,i]=(0,a.useState)(t??""),r=(0,a.useCallback)((()=>s(n)),[s,n]);return(0,g.jsx)(L.sR,{showDismissButton:!1,header:(0,g.jsx)(E.q,{styleName:"Heading-17px/Medium",colorName:"primary",children:(0,g.jsx)(b.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeVATIDModal.title",defaultMessage:"Change VAT/GST number"})}),footer:(0,g.jsx)(L.a6,{layout:"horizontal-right",primaryButton:{buttonType:"primary",label:(0,g.jsx)(b.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeVATIDModal.updateButton.label",defaultMessage:"Update"}),onClick:r},secondaryButton:{buttonType:"dismiss"}}),children:(0,g.jsxs)(I.jX,{width:"fill",gap:6,children:[(0,g.jsx)(K.Z,{focus:!0,selectAll:!0,value:n,onChange:e=>i(e.target.value),onSubmit:r}),(0,g.jsx)(E.q,{styleName:"Body-12px/Regular",colorName:"secondary",children:(0,g.jsx)(b.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeVATIDModal.subtitle",defaultMessage:"Please include your country code"})})]})})}async function G(e){const{defaultValue:t}=e;return await M.o.showAsyncModal((e=>(0,g.jsx)(S.c,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{min:500,max:500}},children:(0,g.jsx)(J,{defaultValue:t,onAccept:e.resolve})})))}},23412:(e,t,s)=>{s.d(t,{n:()=>g});var a=s(86664),n=(s(67294),s(480)),i=s(86628),r=s(68939),l=s(50906),o=s(89024),d=s(80444),c=s(27242),u=s(37014),p=s(85893);function g(){window.__c={n:"PaymentFields"};const e=(0,i.VK)((()=>{const e=c.Z.state;if(e.open)return e.sessionId}),[]),t=(0,n.O7)(),s={defaultValues:{billingDetails:(0,i.VK)((()=>{const e=d.default.state.currentUserStore;return{email:null==e?void 0:e.getEmail(),name:null==e?void 0:e.getName()}}),[])}};return(0,p.jsx)(o.jX,{gap:24,children:(0,p.jsx)(u.x,{label:(0,p.jsx)(r.FormattedMessage,{id:"checkoutPaymentField.paymentDetails.title",defaultMessage:"Payment details"}),children:(0,p.jsx)(a.PaymentElement,{options:s,onChange:s=>{l.DcE(t,{event:s,modal_id:e}),c.Z.update((e=>{if(!e.open)return e;const{paymentData:t,...s}=e;return s}))}})})})}},31796:(e,t,s)=>{s.d(t,{V:()=>u});s(67294);var a=s(13991),n=s(24405),i=s(7057),r=s(68939),l=s(23189),o=s(71552),d=s(27533),c=s(85893);function u(e){window.__c={n:"BillingHistory"};const{spaceStore:t,events:s,upcomingInvoiceData:u}=e,p=(0,n.yK)((e=>({emptyList:{color:e.mediumTextColor,fontSize:14},header:{marginBottom:4}})),[]),g=t.id,m=u?`/invoice/upcoming?spaceId=${g}`:void 0,h=0===s.length&&!m;return(0,c.jsxs)("div",{style:{marginTop:40},children:[(0,c.jsx)(l.Z,{large:!0,divider:"full",style:p.header,children:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBillingV2.invoices",defaultMessage:"Invoices"})}),h?(0,c.jsx)("div",{style:p.emptyList,children:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.noInvoicesMessage",defaultMessage:"This workspace has no payments yet."})}):null,m?(0,c.jsx)(o.J,{mainLabel:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBillingV2.upcomingInvoice",defaultMessage:"Upcoming invoice"}),button:{label:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBillingV2.viewInvoice",defaultMessage:"View invoice"}),onClick:()=>{window.open(m,"_blank")}}}):null,s.map((e=>{const t=(0,i.Yx)(e.timestamp,"long",a.SP);let s;s="paid"===e.status?e.total<0?(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.credited",defaultMessage:"Credited"}):(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.paid",defaultMessage:"Paid"}):e.attempted?(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.failed",defaultMessage:"Failed"}):(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.due",defaultMessage:"Due"});const n=(0,c.jsx)(d.W,{cost:{amount:e.total,currencyCode:e.currencyCode},trailingZeroDisplay:"stripIfInteger"});return(0,c.jsx)(o.J,{mainLabel:t,valueLabel:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBillingV2.invoiceSummary",defaultMessage:"{invoiceStatus} · {formattedAmount}",values:{invoiceStatus:s,formattedAmount:n}}),button:{label:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBillingV2.viewInvoice",defaultMessage:"View invoice"}),onClick:()=>{const t=`/invoice/${e.id}`;window.open(t,"_blank")}}},e.id)}))]})}},71552:(e,t,s)=>{s.d(t,{J:()=>l});s(67294);var a=s(480),n=s(24405),i=s(63296),r=s(85893);function l(e){window.__c={n:"BillingRow"};const{mainLabel:t,valueLabel:s,metadataLabel:l,button:o}=e,{isMobile:d}=(0,a.Fy)(),c=(0,n.yK)((e=>({row:{display:"flex",alignItems:"center",gap:40,padding:"11px 0",borderBottom:`1px solid ${e.regularDividerColor}`},labelArea:{flex:1,display:"flex",flexDirection:"column",gap:6},mainLabel:{fontWeight:400,fontSize:14,lineHeight:"17px",letterSpacing:"-0.154px"},valueLabel:{fontWeight:400,fontSize:12,lineHeight:"14px",color:e.mediumTextColor},metadataLabel:{fontSize:12,lineHeight:"14px",textAlign:"right",color:e.mediumTextColor},buttonArea:{},button:{minWidth:144}})),[]);return(0,r.jsxs)("div",{style:c.row,children:[(0,r.jsxs)("div",{style:c.labelArea,children:[(0,r.jsx)("div",{style:c.mainLabel,children:t}),(0,r.jsx)("div",{style:c.valueLabel,children:d?l:s})]}),l&&!d?(0,r.jsx)("div",{style:c.metadataLabel,children:l}):null,o?(0,r.jsx)("div",{style:c.buttonArea,children:(0,r.jsx)(i.Z,{isLarge:!0,onClick:o.onClick,style:c.button,children:o.label})}):null]})}},78780:(e,t,s)=>{s.d(t,{Z:()=>Q,s:()=>G});var a=s(67294),n=s(83355),i=s(13991),r=s(480),l=s(86628),o=s(6906),d=s(7057),c=s(62965),u=s(3791),p=s(97880);var g=s(68939),m=s(47307),h=s(89024),f=s(64369),b=s(27386),v=s(23189),y=s(88632),x=s(72087),M=s(92083),S=s(93349),C=s(78291),j=s(39343),w=s(80671),B=s(71487),_=s(34583),P=s(64891),k=s(33083),A=s(40670),D=s(88893),F=s(35057),V=s(16323),T=s(31796),I=s(71552),L=s(24405),E=s(36700),O=s(82990),R=s(63296),N=s(85893);function Z(){return(0,L.yK)((e=>({button:{width:"100%",height:40,marginTop:24},cancellationButton:{marginRight:12,border:void 0},section:{display:"flex",alignItems:"center",fontSize:14,paddingTop:16,paddingBottom:16,background:"dark"===e.mode?e.surface.elevated:e.surface.wash,borderRadius:4,margin:"12px 0",borderWidth:.5,borderStyle:"solid",borderColor:e.stroke.regular},textSection:{marginRight:"auto",paddingRight:32},allChanges:{color:e.mediumTextColor,fontSize:12,paddingLeft:8,paddingRight:8}})),[])}function K(){return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.scheduledChanges.cancel.label",defaultMessage:"<bold>Cancel changes</bold>",values:{bold:e=>(0,N.jsx)("b",{children:e})}})}function U(e){window.__c={n:"AllChangesText"};const t=Z(),s=(0,g.useIntl)().formatList(e.scheduledChanges.filter(Boolean),{type:"conjunction",style:"narrow"});return(0,N.jsx)("div",{style:t.allChanges,children:s})}function z(e){window.__c={n:"PendingChangesText"};const{periodEndDate:t,scheduledChanges:s}=e,a=(0,d.Yx)(t,"medium",i.SP),n=(0,L.yK)((e=>({leftSection:{display:"flex",paddingLeft:12},title:{fontWeight:O.Z.fontWeight.medium,paddingLeft:8,paddingRight:8},icon:{width:14,height:14,marginTop:4}})),[]);return(0,N.jsxs)("div",{style:n.leftSection,children:[(0,E.m)(n.icon),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{style:n.title,children:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.scheduledChanges.pendingChanges.title",defaultMessage:"Pending changes scheduled for {date}",values:{date:a}})}),(0,N.jsx)(U,{scheduledChanges:s})]})]})}function H(e){window.__c={n:"CancelPendingCancellationChanges"};const{customerData:t}=e,s=Z(),a=(0,r.O7)();return(0,N.jsx)(R.Z,{isLarge:!0,onClick:()=>P.LZ({environment:a,customerData:t}),style:s.cancellationButton,children:(0,N.jsx)(K,{})})}function X(e){window.__c={n:"CancelPendingChanges"};const{customerData:t}=e,s=Z(),a=(0,r.O7)();return(0,N.jsx)(R.Z,{isLarge:!0,onClick:()=>P.y5({environment:a,customerData:t}),style:s.cancellationButton,children:(0,N.jsx)(K,{})})}function q(e){window.__c={n:"ScheduledChangesBillingSection"};const{stripeCustomerData:t}=e,s=Z(),{scheduledChanges:a,periodEndDate:n}=(0,l.VK)((()=>(0,A.Tg)(t)),[t]),{cancelledChanges:i}=(0,l.VK)((()=>(0,A.n8)(t)),[t]);if(t.isSubscribed&&t.willCancelAt)return(0,N.jsxs)("div",{style:s.section,children:[(0,N.jsx)("div",{style:s.textSection,children:(0,N.jsx)(z,{scheduledChanges:i,periodEndDate:t.willCancelAt})}),(0,N.jsx)(H,{customerData:e.stripeCustomerData})]});const r=(0,A.dY)(t);return(0,A.dA)(t)||r&&(0,A.bM)(t)?(0,N.jsxs)("div",{style:s.section,children:[(0,N.jsx)("div",{style:s.textSection,children:(0,N.jsx)(z,{scheduledChanges:a,periodEndDate:n})}),(0,N.jsx)(X,{customerData:e.stripeCustomerData})]}):null}var Y=s(27533),W=s(72983);const J={marginBottom:4},G={offline:(0,N.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage billing.",id:"spaceSubscriptionBillingV2.offline.message"})};class $ extends n.Z{constructor(){super(...arguments),this.storeTypes={store:S.Z,billingHistoryRequestStore:x.Z},this.renderBilling=()=>{const{billingEvents:e}=this.stores.store.state,{isMobile:t}=this.environment.device;return(0,N.jsxs)(h.jX,{height:t?void 0:"fill",padding:t?void 0:"36px 60px",style:{overflowY:t?void 0:"auto"},children:[t?null:(0,N.jsx)(v.Z,{large:!0,divider:"full",style:J,children:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.billing",defaultMessage:"Billing"})}),(0,N.jsx)(q,{stripeCustomerData:this.props.customerData}),this.renderPlanRow(),(0,N.jsx)(re,{customerData:this.props.customerData}),this.renderBillingPeriodRow(),(0,N.jsx)("div",{style:{height:40,flexShrink:0}}),(0,N.jsx)(v.Z,{large:!0,divider:"full",style:J,children:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentDetails",defaultMessage:"Payment details"})}),this.renderPaymentMethodRow(),this.renderAddressRow(),this.renderBillingEmailRow(),this.renderVATRow(),(0,N.jsx)(T.V,{spaceStore:this.props.spaceStore,events:e,upcomingInvoiceData:this.props.upcomingInvoiceData})]})},this.handleChangePlanClick=()=>{this.environment.device.isMobile?(0,V.showPlans)({environment:this.environment,from:"billing"}):M.Z.setState({open:!0,openedFrom:"upsell",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0})},this.handlePaymentMethodChangeClick=async()=>{const{spaceStore:e}=this.props,t=await(0,k.showPaymentMethodModal)();t&&await _.TV({environment:this.environment,spaceStore:e,paymentMethodId:t.id})},this.handleBillingIntervalChangeClick=()=>{const{customerData:e}=this.props,t="interval"in e?e.interval:"year",s="year"===t?"month":"year";P.af({environment:this.environment,from:"billing_page",view:"billing_interval",temporaryBillingInterval:s,billingInterval:t,onSuccess:()=>{_.zb(this.environment,this.stores.store)}})},this.handleAddressChangeClick=async()=>{const{spaceStore:e,customerData:t}=this.props,s=await(0,k.showAddressModal)({defaultValue:t.address});s&&((0,c.Z)(s,t.address)||await _.y3({environment:this.environment,spaceStore:e,address:s}))},this.handleVatIdChangeClick=async()=>{var e;const{spaceStore:t,customerData:s}=this.props,a=null===(e=s.address)||void 0===e?void 0:e.country;if(!a)return void m.showErrorMessage((0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatId.missingCountry",defaultMessage:"To update your VAT/GST number, please update your billing address."}));if(!{AE:"ae_trn",AT:"eu_vat",AU:"au_abn",BE:"eu_vat",BG:"eu_vat",CA:"ca_bn",CH:"ch_vat",CY:"eu_vat",CZ:"eu_vat",DE:"eu_vat",DK:"eu_vat",EE:"eu_vat",ES:"eu_vat",FI:"eu_vat",FR:"eu_vat",GB:"gb_vat",GR:"eu_vat",HR:"eu_vat",HU:"eu_vat",IE:"eu_vat",IN:"in_gst",IT:"eu_vat",KR:"kr_brn",LT:"eu_vat",LU:"eu_vat",LV:"eu_vat",MT:"eu_vat",NL:"eu_vat",NZ:"nz_gst",PL:"eu_vat",PT:"eu_vat",RO:"eu_vat",RU:"ru_inn",SE:"eu_vat",SG:"sg_gst",SI:"eu_vat",SK:"eu_vat"}[a])return void m.showErrorMessage((0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatId.vatNotRequired",defaultMessage:"A VAT/GST number is not required for your tax jurisdiction."}));const n=await(0,k.showVatIdModal)({defaultValue:s.vatId});n&&n!==s.vatId&&await _.Mg({environment:this.environment,from:"space_settings-billing_tab",spaceStore:t,vatId:n})},this.handleBillingEmailChangeClick=async()=>{const{spaceStore:e,customerData:t}=this.props,s=await(0,k.showEmailModal)({defaultValue:t.billingEmail});s&&s!==t.billingEmail&&await _.Mg({environment:this.environment,spaceStore:e,billingEmail:s,from:"space_settings-billing_tab"})}}UNSAFE_willMount(){_.bi(this.environment),_.px(this.environment),_.zb(this.environment,this.stores.store)}renderComponent(){return y.Z.state.online?this.renderBilling():$.renderOfflineMessage()}static renderOfflineMessage(){return(0,N.jsx)(b.Z,{children:(0,N.jsx)(f.Z,{isSmall:!0,style:{textAlign:"center"},children:G.offline})})}renderPlanRow(){const{subscriptionData:e,customerData:t}=this.props;let s,a;const n=D.XX(e);n&&(s=(0,N.jsx)(Y.W,{cost:{amount:n.planAmount*n.quantity,currencyCode:n.currencyCode},trailingZeroDisplay:"stripIfInteger"}),a=(0,d.Yx)(n.periodEnd,"medium",i.SP));const r=(0,j.Fk)(n),l=t.willCancelAt?(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.cancels",defaultMessage:"Cancels"}):r?(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.startsOn",defaultMessage:"Starts on"}):(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.renews",defaultMessage:"Renews"});let o;if(n)switch(n.interval){case"month":o=(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.month",defaultMessage:"{planCharge} per month · {renewalOrCancellationMessage} {renewalDate}",values:{planCharge:s,renewalDate:a,renewalOrCancellationMessage:l}});break;case"year":o=(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.year",defaultMessage:"{planCharge} per year · {renewalOrCancellationMessage} {renewalDate}",values:{planCharge:s,renewalDate:a,renewalOrCancellationMessage:l}});break;default:(0,p.t1)(n.interval)}return(0,N.jsx)(I.J,{mainLabel:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.plan",defaultMessage:"Plan"}),metadataLabel:o,valueLabel:n?(0,N.jsx)(ne,{productNameType:D.NW(n.productId)}):"Free",button:{label:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.changePlan",defaultMessage:"Change plan"}),onClick:this.handleChangePlanClick}})}renderBillingPeriodRow(){return(0,F.iJ)()||!this.props.customerData.isSubscribed&&(0,u.E3)(this.props.customerData.addOns)?null:(0,N.jsx)(I.J,{mainLabel:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.billingPeriod",defaultMessage:"Billing period"}),valueLabel:(0,N.jsx)(ae,{customerData:this.props.customerData}),button:{label:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.editPeriod",defaultMessage:"Edit period"}),onClick:this.handleBillingIntervalChangeClick}})}renderBillingEmailRow(){const{customerData:e}=this.props;return(0,N.jsx)(I.J,{mainLabel:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.billingEmail",defaultMessage:"Billing email"}),valueLabel:e.billingEmail??"",button:{label:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.editEmail",defaultMessage:"Edit email"}),onClick:this.handleBillingEmailChangeClick}})}renderPaymentMethodRow(){return(0,N.jsx)(I.J,{mainLabel:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethod",defaultMessage:"Payment method"}),valueLabel:(0,N.jsx)(te,{customerData:this.props.customerData}),metadataLabel:(0,N.jsx)(se,{customerData:this.props.customerData}),button:{label:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.editMethod",defaultMessage:"Edit method"}),onClick:this.handlePaymentMethodChangeClick}})}renderAddressRow(){const{customerData:e}=this.props;return(0,N.jsx)(I.J,{mainLabel:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.billedTo",defaultMessage:"Billed to"}),valueLabel:(0,N.jsx)(W.l,{layout:"condensed",address:e.address}),button:{label:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.editInformation",defaultMessage:"Edit information"}),onClick:this.handleAddressChangeClick}})}renderVATRow(){const{customerData:e}=this.props;return(0,N.jsx)(I.J,{mainLabel:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatGst",defaultMessage:"VAT/GST number"}),valueLabel:(0,N.jsx)("div",{children:e.vatId||"-"}),button:{label:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.editNumber",defaultMessage:"Edit number"}),onClick:this.handleVatIdChangeClick}})}}$.displayName="SpaceSubscriptionBillingV2";const Q=(0,g.injectIntl)($);function ee(e){let{addOn:t,cancellationDate:s,customerData:a}=e;const n=a.isSubscribed?a.interval:"month",r=(0,N.jsx)(Y.W,{cost:{amount:t.cost,currencyCode:a.currencyCode??"USD"},trailingZeroDisplay:"stripIfInteger"}),l=a.periodEnd;return s?(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.cancels",defaultMessage:"{planCharge} per {interval} · Cancels {date}",values:{planCharge:r,interval:n,date:(0,d.Yx)(s,"medium",i.SP)}}):l?(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.renews",defaultMessage:"{planCharge} per {interval} · Renews {date}",values:{planCharge:r,interval:n,date:(0,d.Yx)(l,"medium",i.SP)}}):(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.priceOnly",defaultMessage:"{planCharge} per {interval}",values:{planCharge:r,interval:n}})}function te(e){let{customerData:t}=e;const s=t.isSubscribed?t.billing:"charge_automatically";if("send_invoice"===s)return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.achOrWireTransfer",defaultMessage:"ACH or Wire Transfer"});if("charge_automatically"!==s)return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.none",defaultMessage:"None"});switch(t.paymentMethodType){case"card":return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethodType.creditCard",defaultMessage:"Credit card"});case"link":return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethodType.link",defaultMessage:"Stripe Link"});default:return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethodType.other",defaultMessage:"Other"})}}function se(e){let{customerData:t}=e;const s=t.isSubscribed?t.billing:"charge_automatically";if("send_invoice"===s)return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.achOrWireTransfer",defaultMessage:"ACH or Wire Transfer"});if("charge_automatically"!==s)return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.none",defaultMessage:"None"});switch(t.paymentMethodType){case"card":return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethod.creditCard",defaultMessage:"{creditCardBrand} ending in {lastFourDigits}",values:{creditCardBrand:(0,o.Z)(t.brand),lastFourDigits:t.last4}});default:return null}}function ae(e){let{customerData:t}=e;return t.isSubscribed?"month"===t.interval?(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.monthly",defaultMessage:"Monthly"}):(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.yearly",defaultMessage:"Yearly"}):(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.monthly",defaultMessage:"Monthly"})}function ne(e){let{productNameType:t}=e;switch(t){case"personal":return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.personal",defaultMessage:"Personal"});case"plus":return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.plus",defaultMessage:"Plus"});case"business":return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.business",defaultMessage:"Business"});case"enterprise":return(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.enterprise",defaultMessage:"Enterprise"});default:return null}return null}function ie(e){let{addOn:t,customerData:s}=e;window.__c={n:"AdditionalFeaturesRowComponent"};const a=(0,r.O7)(),n=(0,l.VK)((()=>A.A0(s)),[s]),i=(0,l.VK)((()=>{var e;return n?(0,u.ls)(null===(e=C.default.state.data)||void 0===e?void 0:e.addOns)??s.periodEnd:void 0}),[n,s]),o={label:n?(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.resubscribe",defaultMessage:"Resubscribe"}):(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.removeFromPlan",defaultMessage:"Remove from plan"}),onClick:async()=>{if(i){if(s.willCancelAt){const e=s.customerId?await B.yY(a,{offerType:"add_on_upgrade_flow",customerId:s.customerId}):void 0;return w.k2(),w.Cl(e),null}return await P.y5({environment:a,customerData:s}),null}return w.Kj(),null}};return(0,N.jsx)(I.J,{mainLabel:(0,N.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBillingV2.additionalFeatures",defaultMessage:"Additional features"}),metadataLabel:(0,N.jsx)(ee,{customerData:s,addOn:t,cancellationDate:i}),valueLabel:"Notion AI",button:o})}function re(e){let{customerData:t}=e;return(0,N.jsx)(N.Fragment,{children:t.addOns.map((e=>(0,N.jsx)(a.Fragment,{children:(0,N.jsx)(ie,{customerData:t,addOn:e})},e.feature)))})}},95014:(e,t,s)=>{s.r(t),s.d(t,{getStripe:()=>b,injectStripe:()=>f,paymentIntentRequiresPaymentMethod:()=>M,translateStripeError:()=>x,useElementsOptions:()=>y});var a=s(86664),n=s(97894),i=s(67294),r=s(86628),l=s(24405),o=s(24211),d=s(97880),c=s(82990),u=s(50906),p=s(95477),g=s(80444),m=s(85893);let h=null;function f(e){return t=>{const[s]=i.useState(b);return(0,m.jsx)(a.Elements,{stripe:s,children:(0,m.jsx)(a.ElementsConsumer,{children:s=>{let{stripe:a,elements:n}=s;const i={...t,stripe:a,elements:n};return(0,m.jsx)(e,{...i})}})})}}async function b(){return h||(n.loadStripe.setLoadParameters({advancedFraudSignals:!1}),h=(0,n.loadStripe)(p.default.stripe.key)),h}function v(e){switch(e){case"en-US":return"en";case"ko-KR":return"ko";case"ja-JP":return"ja";case"fr-FR":return"fr-FR";case"de-DE":return"de";case"es-ES":return"es-ES";case"es-LA":return"es-419";case"pt-BR":return"pt-BR";case"zh-CN":return"zh";case"zh-TW":return"zh-TW";case"da-DK":return"da";case"nl-NL":return"nl";case"fi-FI":return"fi";case"nb-NO":return"nb";case"sv-SE":return"sv";default:return"auto"}}function y(e){const t=(0,l.Fg)(),{type:s}=e,a="setup"===s||"subscription"===s?e.currency:void 0,n="subscription"===s?e.amount:void 0,u=(0,r.VK)((()=>{var e;return(null===(e=g.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)||o.al}),[]);return(0,i.useMemo)((()=>{const e="dark"===t.mode,i={appearance:{labels:"floating",variables:{spacingGridRow:"8px",colorPrimary:t.blueColor,colorText:t.regularTextColor,colorTextPlaceholder:e?"#5A5A5A":"#ACABA9",fontFamily:c.Z.baseFontFamily.sans,borderRadius:"4px"},rules:{".Input":{display:"flex",alignItems:"center",width:"100%",fontSize:"14px",lineHeight:"20px",letterSpacing:"-0.154px",padding:"3px 6px",height:"40px",boxShadow:"none",backgroundColor:e?"#262626":"#F9F9F8",borderWidth:"1px",borderStyle:"solid",borderColor:e?"#1C1C1C":"rgba(227,226,224,0.5)",cursor:"text",color:e?"#E1E1E1":"#1D1B16"},".Label":{fontSize:"14px",color:e?"#5A5A5A":"#ACABA9"},".Label--resting":{fontSize:"14px",lineHeight:"140%",letterSpacing:"-0.154px",color:e?"#5A5A5A":"#ACABA9"},".Label--floating":{fontSize:"10px",fontWeight:"600",lineHeight:"13px",letterSpacing:"0.12px",marginTop:"4px",transition:"all 200ms ease"}}},locale:v(u)};switch(s){case"address":return i;case"setup":return{...i,currency:null==a?void 0:a.toLowerCase(),mode:"setup",paymentMethodCreation:"manual"};case"subscription":return{...i,amount:n,currency:null==a?void 0:a.toLowerCase(),mode:"subscription",paymentMethodCreation:"manual",setupFutureUsage:"off_session"};default:(0,d.t1)(s)}}),[t,s,n,a,u])}function x(e,t,s){if(!s.code)return s.message||"";switch(u._qN(e,{error:s.code,stripe_decline_code:s.decline_code}),s.code){case"invalid_expiry_year_past":return t.formatMessage({id:"stripeHelpers.invalidExpiryYear.error.message",defaultMessage:"Your card's expiration year is in the past."});case"invalid_cvc":return t.formatMessage({id:"stripeHelpers.invalidCVC.error.message",defaultMessage:"Your card's security code is invalid."});case"invalid_number":return t.formatMessage({id:"stripeHelpers.invalidNumber.error.message",defaultMessage:"Your card number is not a valid credit card number."});case"card_declined":return function(e,t){switch(t){case"expired_card":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.expiredCard",defaultMessage:"Your card was declined because it is an expired card."});case"incorrect_number":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.incorrectNumber",defaultMessage:"Your card was declined because you input an incorrect number."});case"insufficient_funds":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.declinedFunds",defaultMessage:"Your card was declined because of insufficient funds."});case"invalid_cvc":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidCvc",defaultMessage:"Your card was declined because you input an invalid CVC number"});case"invalid_amount":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidAmount",defaultMessage:"Your card was declined because payment amount exceeds the amount that's allowed."});default:return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message",defaultMessage:"Your card was declined."})}}(t,s.decline_code);default:return s.message||""}}function M(e){let{status:t}=e;return["requires_payment_method","requires_source"].includes(t)}},33218:(e,t,s)=>{s.d(t,{h:()=>o});var a=s(67294),n=s(480),i=s(86628),r=s(80444),l=s(22616);function o(){const e=(0,n.O7)(),t=(0,i.VK)((()=>{var e;return null===(e=r.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);(0,a.useEffect)((()=>{t&&(0,l.Zz)({environment:e,spaceId:t})}),[e,t])}},38524:(e,t,s)=>{s.d(t,{f:()=>i});var a=s(86628),n=s(78291);function i(){return(0,a.VK)((()=>n.default.state.data),[])}},16323:(e,t,s)=>{function a(e){const{spaceStore:t}=e;return t.canRead()}s.r(t),s.d(t,{PlansModalContent:()=>te,PlansSidebarButton:()=>be,canShowPlans:()=>a,showPlans:()=>fe});var n=s(67294),i=s(480),r=s(86628),l=s(3791),o=s(18174),d=s(47425),c=s(80444),u=s(64251),p=s(34583),g=s(50365),m=s(70060),h=s(35057),f=s(88893),b=s(38524);var v=s(33218),y=s(28956),x=s(33493);var M=s(24405),S=s(82990),C=s(68939),j=s(89024),w=s(64921);const B=(0,C.defineMessages)({activePlan:{id:"ProductLimit.activePlan",defaultMessage:"Active plan"},addToPlan:{id:"ProductLimit.addToPlan",defaultMessage:"Add to plan"},aiAddOnLabel:{id:"ProductLimit.aiAddOnLabel",defaultMessage:"Notion AI"},aiAddOnUsage:{id:"ProductLimit.aiAddOnUsage",defaultMessage:"{usedCount}/{totalCount} AI responses used"},aiAddedToPlan:{id:"ProductLimit.aiAddedToPlan",defaultMessage:"Added to plan"},otherPlans:{id:"ProductLimit.otherPlans",defaultMessage:"Other plans to consider"},teamBlocksLabel:{id:"ProductLimit.teamBlocksLabel",defaultMessage:"Team blocks"},teamBlocksUsage:{id:"ProductLimit.teamBlocksUsage",defaultMessage:"{usedCount}/{totalCount} team blocks used"},upgrade:{id:"ProductLimit.upgrade",defaultMessage:"Upgrade"},downgrade:{id:"ProductLimit.downgrade",defaultMessage:"Downgrade"},ctaPrice:{id:"SpaceSubscriptionPlans.productCta",defaultMessage:"From {money}/member per month"},ctaButtonLabel:{id:"SpaceSubscriptionPlans.productCtaButtonLabel",defaultMessage:"Upgrade"},unlimitedBlocksForIndividuals:{id:"SpaceSubscriptionPlans.includes.unlimitedBlocksForIndividuals",defaultMessage:"Unlimited blocks for individuals"},unlimitedBlocksForTeams:{id:"SpaceSubscriptionPlans.includes.unlimitedBlocksForTeams",defaultMessage:"Unlimited blocks for teams"},unlimitedFileUploads:{id:"SpaceSubscriptionPlans.includes.unlimitedFileUploads",defaultMessage:"Unlimited file uploads"},collaborativeWorkspace:{id:"SpaceSubscriptionPlans.includes.collaborativeWorkspaces",defaultMessage:"Collaborative workspace"},integrations:{id:"SpaceSubscriptionPlans.includes.integrations",defaultMessage:"Slack, GitHub, and more integrations"},pageHistory7Days:{id:"SpaceSubscriptionPlans.includes.pageHistory.7",defaultMessage:"7 day page history"},pageHistory30Days:{id:"SpaceSubscriptionPlans.includes.pageHistory.30",defaultMessage:"30 day page history"},pageHistory90Days:{id:"SpaceSubscriptionPlans.includes.pageHistory.90",defaultMessage:"90 day page history"},pageHistoryUnlimited:{id:"SpaceSubscriptionPlans.includes.pageHistory.unlimited",defaultMessage:"Unlimited page history"},guests10:{id:"SpaceSubscriptionPlans.includes.guests.10",defaultMessage:"Invite up to 10 guests"},guests100:{id:"SpaceSubscriptionPlans.includes.guests.100",defaultMessage:"Invite up to 100 guests"},guests250:{id:"SpaceSubscriptionPlans.includes.guests.250",defaultMessage:"Invite up to 250 guests"},guestsCustom:{id:"SpaceSubscriptionPlans.includes.guests.custom",defaultMessage:"Custom guest limits"},aiCredits:{id:"SpaceSubscriptionPlans.includes.aiCredits",defaultMessage:"10 free AI credits"},samlSSO:{id:"SpaceSubscriptionPlans.includes.saml.sso",defaultMessage:"SAML SSO"},userProvisioning:{id:"SpaceSubscriptionPlans.includes.scim",defaultMessage:"User provisioning (SCIM)"},advancedSecurityControls:{id:"SpaceSubscriptionPlans.includes.advancedSecurityControls",defaultMessage:"Advanced security controls"},auditLog:{id:"SpaceSubscriptionPlans.includes.auditLog",defaultMessage:"Audit log"},privateTeamspaces:{id:"SpaceSubscriptionPlans.includes.privateTeamspaces",defaultMessage:"Private Teamspaces"},bulkPdfExport:{id:"SpaceSubscriptionPlans.includes.bulkPdfExport",defaultMessage:"Bulk PDF export"},customerSuccessManager:{id:"SpaceSubscriptionPlans.includes.customerSuccessManager",defaultMessage:"Customer success manager"},includesFree:{id:"SpaceSubscriptionPlans.includes.free",defaultMessage:"Includes"},includesPlus:{id:"SpaceSubscriptionPlans.includes.plus",defaultMessage:"Everything in Free, and"},includesBusiness:{id:"SpaceSubscriptionPlans.includes.business",defaultMessage:"Everything in Plus, and"},includesEnterprise:{id:"SpaceSubscriptionPlans.includes.enterprise",defaultMessage:"Everything in Business, and"},seeAllPlans:{id:"SpaceSubscriptionPlans.seeAllPlans",defaultMessage:"See all plans"}}),_=(0,C.defineMessages)({free:{id:"ProductOverview.free.caption",defaultMessage:"Organize every corner of your work and life"},plus:{id:"ProductOverview.plus.caption",defaultMessage:"For small groups to plan and get organized"},business:{id:"ProductOverview.business.caption",defaultMessage:"For small groups to plan and get organized"},enterprise:{id:"ProductOverview.enterprise.caption",defaultMessage:"For companies connecting several teams and tools"}}),P={free:B.includesFree,plus:B.includesPlus,business:B.includesBusiness,enterprise:B.includesEnterprise};var k=s(94919),A=s(97880),D=s(42922),F=s(7124),V=s(63296),T=s(85893);function I(e){window.__c={n:"ProductCta"};const{ctaType:t,asyncPrice:s,priceStore:a,onClick:n}=e,i=(0,C.useIntl)(),l=(0,r.VK)((()=>a.selectedCurrencyCode),[a]);if(!s.isLoaded)return null;const o=s.result?s.result.getMonthlyUnitCost().toMoneyValue():{amount:0,currencyCode:l};return(0,T.jsxs)(j.jX,{direction:"row",gap:"auto",align:"center",children:[(0,T.jsx)(F.q,{styleName:"iOS/Caption-12px/Regular",colorName:"primary",children:i.formatMessage(B.ctaPrice,{money:(0,T.jsx)(k.W,{cost:o,trailingZeroDisplay:"stripIfInteger",intl:i})})}),n?(0,T.jsx)(L,{ctaType:t,onClick:n}):null]})}function L(e){window.__c={n:"ProductCtaButton"};const{ctaType:t,onClick:s}=e,a=(0,C.useIntl)();switch(t){case"upgrade":return(0,T.jsx)(D.Z,{onClick:s,children:a.formatMessage(B.upgrade)});case"downgrade":return(0,T.jsx)(V.Z,{onClick:s,children:a.formatMessage(B.downgrade)});case"equal":case void 0:return null;default:(0,A.t1)(t)}}var E=s(18485);function O(e){const{product:t}=e,s=function(e){switch(e){case"free":case"student":case"personal":return E.LU.free.originalImage;case"plus":return E.LU.plus.originalImage;case"business":return E.LU.business.originalImage;case"enterprise":return E.LU.enterprise.originalImage;case"ai":return E.LU.ai.originalImage;default:return(0,A.t1)(e)}}(t);return(0,T.jsx)("img",{role:"presentation",src:s.path,style:{width:.25*s.width}})}var R=s(33941);function N(e){const{caption:t,productImage:s,planName:a}=e;return(0,T.jsxs)(j.jX,{gap:10,children:[s,(0,T.jsxs)(j.jX,{gap:2,children:[(0,T.jsx)(F.q,{styleName:"iOS/Title-3/Bold",children:a}),t?(0,T.jsx)(F.q,{styleName:"iOS/Callout-16px/Regular",colorName:"secondary",children:t}):null]})]})}var Z=s(98519);function K(e){window.__c={n:"ProductHighlight"};const{label:t}=e,s=(0,M.yK)((e=>({icon:{height:18,width:18,fill:e.icon.tertiary}})),[]);return(0,T.jsxs)(j.jX,{direction:"row",align:"center-left",gap:6,children:[(0,Z.k)(s.icon),(0,T.jsx)(F.q,{styleName:"iOS/Callout-16px/Regular",colorName:"primary",children:t})]})}function U(e){window.__c={n:"ProductHighlights"};const{product:t}=e,s=(0,C.useIntl)(),a=P[t],n=E.LU[t].highlights;return a&&n?(0,T.jsxs)(j.jX,{gap:8,children:[(0,T.jsx)(F.q,{styleName:"iOS/Subhead-15px/Medium-Compact",colorName:"secondary",children:s.formatMessage(a)}),(0,T.jsx)(j.jX,{gap:4,children:n.map((e=>(0,T.jsx)(K,{label:s.formatMessage(e)},e.id)))})]}):null}function z(e){window.__c={n:"ProductOverview"};const{product:t}=e,s=(0,C.useIntl)(),a=_[t];return(0,T.jsxs)(j.jX,{gap:20,children:[(0,T.jsx)(N,{planName:s.formatMessage(R.a[t]),caption:a?s.formatMessage(a):void 0,productImage:(0,T.jsx)(O,{product:t})}),(0,T.jsx)(U,{product:t})]})}function H(e){window.__c={n:"AvailableTier"};const{ctaType:t,asyncPrice:s,subscriptionTier:a,priceStore:n,onClick:i}=e,r=(0,M.yK)((e=>({card:{borderRadius:16,border:`1px solid ${e.stroke.deemphasized}`,background:e.cardContentBackground},footer:{borderTop:`0.5px solid ${e.stroke.deemphasized}`}})),[]),l=(0,o.KE)(a);return(0,T.jsxs)(j.jX,{gap:2,style:r.card,children:[(0,T.jsx)(j.jX,{gap:20,padding:16,children:(0,T.jsx)(z,{product:l})}),s?(0,T.jsx)(j.jX,{direction:"row",gap:8,padding:16,style:r.footer,children:(0,T.jsx)(I,{asyncPrice:s,ctaType:t,onClick:i,priceStore:n})}):null]})}var X=s(91315);function q(){window.__c={n:"AIAddedToPlan"};const e=(0,C.useIntl)(),t=(0,M.yK)((e=>({icon:{width:16,color:e.icon.purple}})),[]);return(0,T.jsxs)(j.jX,{gap:13,children:[(0,T.jsx)(F.q,{styleName:"iOS/Subhead-15px/Medium-Compact",colorName:"secondary",children:e.formatMessage(B.aiAddOnLabel)}),(0,T.jsxs)(j.jX,{direction:"row",gap:6,children:[(0,X.r)(t.icon),(0,T.jsx)(F.q,{styleName:"iOS/Callout-16px/Regular",children:e.formatMessage(B.aiAddedToPlan)})]})]})}var Y=s(85248);function W(e){const{buttonLabel:t,label:s,onClick:a,progressBarColors:n,usageLabel:i,usage:r}=e,l=r.usedCount/r.totalCount*100;return(0,T.jsxs)(j.jX,{gap:13,children:[(0,T.jsx)(F.q,{styleName:"iOS/Subhead-15px/Medium-Compact",colorName:"secondary",children:s}),(0,T.jsxs)(j.jX,{gap:12,children:[(0,T.jsxs)(j.jX,{gap:8,children:[(0,T.jsx)(Y.k,{percentage:l,height:8,filledColor:n.filled,unfilledColor:n.unfilled}),(0,T.jsx)(F.q,{styleName:"iOS/Callout-16px/Regular",children:i})]}),a?(0,T.jsx)(V.Z,{onClick:a,children:t}):null]})]})}function J(e){window.__c={n:"AIAddOnLimit"};const{usage:t,onClick:s}=e,a=(0,C.useIntl)(),n=function(){const e=(0,M.Fg)(),t="dark"===e.mode?e.accentColors.gray[200]:e.accentColors.gray[50];return{filled:e.icon.purple,unfilled:t}}();return(0,T.jsx)(W,{buttonLabel:a.formatMessage(B.addToPlan),label:a.formatMessage(B.aiAddOnLabel),onClick:s,progressBarColors:n,usage:t,usageLabel:a.formatMessage(B.aiAddOnUsage,{usedCount:t.usedCount,totalCount:t.totalCount})})}function G(e){window.__c={n:"TeamBlocksLimit"};const{onClick:t,usage:s}=e,a=(0,C.useIntl)(),n=function(){const e=(0,M.Fg)(),t="dark"===e.mode?e.accentColors.gray[200]:e.accentColors.gray[50];return{filled:e.accentColors.gray[900],unfilled:t}}();return(0,T.jsx)(W,{buttonLabel:a.formatMessage(B.upgrade),label:a.formatMessage(B.teamBlocksLabel),onClick:t,progressBarColors:n,usage:s,usageLabel:a.formatMessage(B.teamBlocksUsage,{usedCount:s.usedCount,totalCount:s.totalCount})})}function $(e){window.__c={n:"CurrentPlan"};const{subscriptionTier:t,aiAvailability:s,teamBlocksAvailability:a}=e,n=(0,M.yK)((e=>({card:{borderRadius:16,border:`1px solid ${e.stroke.deemphasized}`,background:e.cardContentBackground}})),[]),i=(0,o.KE)(t);return(0,T.jsx)(j.jX,{gap:2,style:n.card,children:(0,T.jsxs)(j.jX,{gap:31,padding:16,children:[(0,T.jsx)(z,{product:i}),a?(0,T.jsx)(G,{usage:a.usage,onClick:a.onClickUpgradePlan}):null,"limited"===(null==s?void 0:s.type)?(0,T.jsx)(J,{usage:s.usage,onClick:s.onClickAddAI}):null,"unlimited"===(null==s?void 0:s.type)?(0,T.jsx)(q,{}):null]})})}function Q(e){const{title:t,children:s}=e;return(0,T.jsxs)(j.jX,{gap:10,children:[(0,T.jsx)(F.q,{styleName:"iOS/Subhead-15px/Medium-Compact",colorName:"secondary",children:t}),(0,T.jsx)(j.jX,{gap:16,children:s})]})}function ee(e){window.__c={n:"PlansPageMobile"};const{currentPlan:t,availableTiers:s}=e,a=(0,C.useIntl)(),i=(0,M.yK)((e=>({wrapper:{background:e.surface.wash},allPlansLink:{display:"flex",color:"dark"===e.mode?e.accentColors.gray[900]:e.accentColors.gray[400],fontSize:14,fontWeight:S.Z.fontWeight.regular,marginBottom:16,padding:4,marginLeft:-4}})),[]),[r,l]=(0,n.useState)(!1),d=(0,n.useCallback)((()=>{l((e=>!e))}),[l]),c=(0,n.useMemo)((()=>s.filter((e=>"upgrade"===(0,o.NY)({oldTier:t.subscriptionTier,newTier:e.subscriptionTier})))),[s,t.subscriptionTier]),u=s.length>c.length,p=r?s:c;return(0,T.jsxs)(j.jX,{gap:33,padding:"32px 16px 16px 16px",style:i.wrapper,children:[(0,T.jsx)(Q,{title:a.formatMessage(B.activePlan),children:(0,T.jsx)($,{...t})}),(0,T.jsxs)(Q,{title:a.formatMessage(B.otherPlans),children:[u?(0,T.jsx)(w.Z,{style:i.allPlansLink,onClick:d,children:a.formatMessage(B.seeAllPlans)}):null,p.map(((e,t)=>(0,T.jsx)(H,{...e},t)))]})]})}function te(){window.__c={n:"PlansModalContent"},(0,v.h)();const{isMobile:e}=(0,i.Fy)();return e?(0,T.jsx)(ae,{}):(0,T.jsx)(se,{})}function se(){window.__c={n:"PlansModalContentDesktop"};const e=(0,r.VK)((()=>c.default.state.currentSpaceStore),[]),t=(0,n.useMemo)((()=>new u.Z),[]),s=(0,b.f)();return s&&e?(0,T.jsx)("div",{style:{padding:48},children:(0,T.jsx)(g.ZP,{spaceStore:e,spaceSubscriptionPlansStore:t,data:s})}):null}function ae(){window.__c={n:"PlansModalContentMobile"};const e=(0,i.O7)(),t=(0,b.f)(),s=(0,r.VK)((()=>(0,h.zt)()),[]),a=function(e){const t=(0,b.f)(),s=(0,f.XX)(t);return(null==s?void 0:s.interval)??e}("year"),n=o.$3.filter((e=>e!==s)),u=function(e){const{billingInterval:t,priceStore:s,products:a}=e,n=(0,i.O7)();return(0,r.VK)((()=>{const e={};for(const i of a)e[i]=s.getPrice(n,(e=>e.product===i&&e.billingInterval===t));return e}),[t,n,s,a])}({billingInterval:a,priceStore:x.Z,products:n}),v=(0,r.VK)((()=>c.default.state.currentSpaceStore),[]),M=function(){const e=(0,b.f)(),t=(0,r.VK)((()=>f.wY(e)),[e]);return(0,r.VK)((()=>{var e;return(null===(e=c.default.state.currentSpaceStore)||void 0===e?void 0:e.canAdmin())??!1}),[])&&!t}(),S=function(e){const{environment:t,canChangeSubscription:s,subscriptionData:a,billingInterval:n}=e,i=null==a?void 0:a.addOns,o=(0,r.VK)((()=>y.Z.state),[]),d=(0,r.VK)((()=>(0,l.de)(i)),[i]);if(!a||!o)return;if(d)return{type:"unlimited"};const c=s?()=>{(0,g._7)({environment:t,billingInterval:n,buttonText:"Purchase AI",data:a,pageSection:"mobile_plans",product:"ai"})}:void 0;return{type:"limited",usage:{usedCount:o.spaceUsage,totalCount:o.spaceLimit},onClickAddAI:c}}({environment:e,billingInterval:a,canChangeSubscription:M,subscriptionData:t}),C=function(e){const{environment:t,canAdmin:s,subscriptionData:a,spaceStore:n,currentTier:i}=e,l=(0,r.VK)((()=>{if(a)return(0,g.T2)(t,a,i)}),[t,a,i]),o=(0,r.VK)((()=>(0,m.fw)()),[]),c=(0,d.v5)(o);if(!(l&&n&&a&&l.showBlockUsage))return;const u=s?()=>{(0,p.sv)({environment:t,product:"plus",data:a,spaceStore:n,from:"mobile_plans"})}:void 0;return{usage:{usedCount:l.blockUsage,totalCount:c},onClickUpgradePlan:u}}({environment:e,canAdmin:M,currentTier:s,spaceStore:v,subscriptionData:t});return t&&v&&S?(0,T.jsx)(ee,{currentPlan:{subscriptionTier:s,aiAvailability:S,teamBlocksAvailability:C},availableTiers:n.map((a=>({subscriptionTier:a,priceStore:x.Z,ctaType:(0,o.NY)({oldTier:s,newTier:a}),asyncPrice:u[a],onClick:M?()=>{(0,p.sv)({environment:e,product:a,data:t,spaceStore:v,from:"mobile_plans"})}:void 0})))}):null}var ne=s(5517),ie=s(72263),re=s(14694);var le=s(50906),oe=s(69098),de=s(7184),ce=s(45800),ue=s(1853),pe=s(77907);const ge=(0,pe.lazyComponent)(pe.deps.payments,(e=>e.PlansModalContent));function me(e){const{isOpen:t,onClosed:s,onDismiss:a}=e;return(0,T.jsx)(de.c,{isOpen:t,onClosed:s,onDismiss:a,areaConstraint:{height:{scroll:!0},width:{min:1e3}},children:(0,T.jsx)(ue.a5,{title:(0,T.jsx)(C.FormattedMessage,{defaultMessage:"Plans",id:"subscription.plans.title"}),children:(0,T.jsx)(ge,{renderLoading:ce.u})})})}let he=!1;async function fe(e){const{environment:t,from:s}=e;if(!he){he=!0;try{le.QrT(t,{from:s}),await oe.o.showAsyncModalComponent(me),le.xoT(t)}finally{he=!1}}}function be(){window.__c={n:"PlansSidebarButton"};const e=(0,M.yK)((e=>({icon:{fill:e.mediumIconColor,width:16}})),[]),t=(0,i.O7)(),s=function(){const e=(0,b.f)();return void 0!==e&&(0,f.YK)(e)}(),l=function(){const e=(0,r.VK)((()=>c.default.state.currentSpaceStore),[]);return(0,r.VK)((()=>void 0!==e&&a({spaceStore:e})),[e])}(),o=s?(0,ne.q)(e.icon):(0,ie._)(e.icon),d=(0,n.useCallback)((()=>{fe({environment:t,from:"mobile_sidebar"})}),[t]);return l?(0,T.jsx)(w.Z,{mobileFeedback:!0,onClick:d,children:(0,T.jsx)(re.Z,{left:o,disableMobileBorder:!0,children:s?(0,T.jsx)(C.FormattedMessage,{id:"plansSidebarButton.plans.title",defaultMessage:"Plans"}):(0,T.jsx)(C.FormattedMessage,{id:"plansSidebarButton.upgrade.title",defaultMessage:"Upgrade"})})}):null}}}]);